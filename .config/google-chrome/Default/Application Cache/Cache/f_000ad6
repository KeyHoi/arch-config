define("MsPortalImpl/Extension/Extension.DefinitionValidator",["require","exports","f","u","a","ko"],(function(n,t,i,r,u,f){"use strict";function s(n,t){g(n,(function(n,i){i!==r&&t(n,i)}))}function nt(n){var i=new l,t=i.errors;return n?(s(n,(function(i,r){switch(i){case"name":e("Extension name",r,t);break;case"version":case"hash":case"schemaVersion":case"sdkVersion":case"buildDescription":e(i,r,t);break;case"isPreview":a(i,r,t);break;case"assetTypes":o(i,r,t);break;case"blades":tt(n,r,t);break;case"startBoardParts":et(r,t);break;case"partsCatalog":pt(r,t);break;case"commandsCatalog":yt(r,t);break;case"commandGroups":at(r,t);break;case"htmlTemplates":st(r,t);break;case"styleSheets":ht(r,t);break;case"galleryService":ct(r,t);break;case"dashboardProvider":lt(r,t);break;case"requireConfig":break;default:t.push("Unexpected attribute '{0}' on definition.".format(i))}})),i):(t.push("Definition is null or undefined."),i)}function e(n,t,i){typeof t!="string"&&i.push("{0} is not a valid string.".format(
n))}function a(n,t,i){typeof t!="boolean"&&i.push("{0} is not a valid boolean.".format(n))}function o(n,t,i){var r=u.isArray(t);return r||i.push("The '{0}' property is not a valid array.".format(n)),r}function tt(n,t,i){t&&o("blades",t,i)&&t.forEach((function(t,r){v(n,t,r,i)}))}function v(n,t,i,r){var u=t.name;t.inputs&&o("Blade: {0}. Property: blades[{1}].inputs".format(u,i),t.inputs,r);t.optionalInputs&&o("Blade: {0}. Property: blades[{1}].optionalInputs".format(u,i),t.optionalInputs,r);o("Blade: {0}. Property: blades[{1}].lenses".format(u,i),t.lenses,r)&&t.lenses.forEach((function(n,t){var f="Blade: {0}. Lens: {1}. Property: blades[{2}].lenses[{3}].".format(u,n.name,i,t);n.partInstances&&o(f,n.partInstances,r)&&n.partInstances.forEach((function(f,e){var o="Blade: {0}. Lens: {1}. Part: {2}. Property: blades[{3}].lenses[{4}].partInstances[{5}]".format(u,n.name,f.name,i,t,e);p(o,f,r)}))}));t.permissions&&o("Blade: {0}. Property: blades[{1}].permissions".format(u,i),t.permissions,r)&&t.permissions.
forEach((function(n,t){h("Blade: {0}. Property: blades[{1}].permissions[{2}]".format(u,i,t),n,t,r)}));it(t.toolbar,"Blade: {0}. Property: blades[{1}].toolbar".format(u,i),r);rt(t.actionBar,"Blade: {0}. Property: blades[{1}].actionBar".format(u,i),r)}function it(n,t,i){n&&(n.source?y(n.source,t+".source",i):i.push("Source not specified for toolbar. "+t))}function rt(n,t,i){n&&n.source&&y(n.source,t+".source",i)}function y(n,t,i){n.property&&e(t+".property",n.property,i);n.optional&&typeof n.optional!="boolean"&&i.push("The attribute 'optional' should be of type boolean. "+t);n.isIdentityInput&&typeof n.isIdentityInput!="boolean"&&i.push("The attribute 'isIdentityInput' should be of type boolean. "+t);o(t+".valuesFrom",n.valuesFrom,i)&&n.valuesFrom.forEach((function(n,r){ut(t+".valuesFrom[{0}]".format(r),n,i)}))}function ut(n,t,i){switch(t.referenceType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;default:i.push("Unknown reference type '{0}' found for {1}.referenceType.".format(
t.referenceType,n))}e(n+".property",t.property,i);t.part&&e(n+".part",t.part,i)}function ft(n,t,i){switch(t.sourceType){case 0:t.providerKey&&i.push("Asset ID source source type of FromInput with provider key (should be null) found for {0}.sourceType.".format(n));break;case 1:t.providerKey||i.push("Asset ID source source type of FromProvider with missing provider key found for {0}.sourceType.".format(n));e(n+".providerKey",t.providerKey,i);break;case 2:t.providerKey||i.push("Asset ID source source type of FromSourceProvider with missing provider key found for {0}.sourceType.".format(n));e(n+".providerKey",t.providerKey,i);break;default:i.push("Unknown asset ID source source type '{0}' found for {1}.sourceType.".format(t.sourceType,n))}e(n+".property",t.property,i)}function h(n,t,i,r){var u,f;switch(t.permissionType){case 0:u=t;u.extensionName&&e(n+".extensionName",u.extensionName,r);e(n+".assetType",u.assetType,r);u.assetId?ft(n+".assetId",u.assetId,r):r.push("Permission missing assetId found for {0}.assetId.".
format(n));e(n+".action",u.action,r);break;case 1:f=t;switch(f.requirement){case c.All:case c.Any:break;default:r.push("Unknown permission set requirement '{0}' found for {1}.requirement.".format(f.requirement,n))}o(n+".permissions",f.permissions,r)&&f.permissions.forEach((function(t,i){h("{0}.permissions[{1}]".format(n,i),t,i,r)}));break;default:r.push("Unknown permission type '{0}' found for {1}.permissionType.".format(t.permissionType,n))}}function et(n,t){o("startBoardParts",n,t)&&n.forEach((function(n,i){p("startBoardParts[{0}]".format(i),n,t)}))}function p(n,t,i){t.reference||t.inline?t.reference&&t.inline?i.push("'reference' and 'inline' properties cannot be set at the same time on PartInstanceDefinition. Property: {0}".format(n)):t.reference&&!t.reference.partTypeName?i.push("'partTypeName' property is required on part reference. Property: {0}".format(n)):t.inline&&w(n,t.inline,i):i.push("'reference' or 'inline' property required on PartInstanceDefinition. Property: {0}".format(n))}
function w(n,t,i){t&&(ot(n,t.partState,i),t.permissions&&o("{0}.permissions".format(n),t.permissions,i)&&t.permissions.forEach((function(t,r){h("{0}.permissions[{1}]".format(n,r),t,r,i)})))}function ot(n,t,i){if(t){var e=t.inputIdentityProperties||[],f=t.sharedProperties||[],o=e.concat(f.map((function(n){return n.property}))),s=f.map((function(n){return n.key})),r=b(o),u=b(s);r&&r.length>0&&i.push("Part view model properties cannot be used in multiple part settings. Duplicated properties: '{0}'. Path: '{1}'.".format(JSON.stringify(r),n));u&&u.length>0&&i.push("Shared key settings cannot be used in multiple part settings. Duplicated keys: '{0}'. Path: '{1}'.".format(JSON.stringify(u),n))}}function b(n){var t={},i=[];return(n||[]).forEach((function(n){!t[n]||i.push(n);t[n]=!0})),i}function st(n,t){s(n,(function(n,i){typeof i!="string"&&(e("htmlTemplates['{0}'].file".format(n),i.file,t),e("htmlTemplates['{0}'].content".format(n),i.content,t))}))}function ht(n,t){u.isArray(n)?n.forEach((function(n,i)
{e("StyleSheet at position {0}".format(i),n,t)})):t.push("Invalid type for 'styleSheets' property on definition.")}function ct(n,t){var i;s(n,(function(n,r){switch(n){case"serviceViewModel":i=r;break;default:t.push("Unexpected properties on 'galleryService' property of definition.")}}));e("galleryService.serviceViewModel",i,t)}function lt(n,t){var i=n.viewModel;i&&typeof i=="string"||t.push("The view model of dashboard provider must be non-empty string.")}function at(n,t){n&&o("commandGroups",n,t)&&n.mapMany((function(n){return n.commands})).forEach((function(n){n.reference&&vt(n,t)}))}function vt(n,t){if(n&&n.reference){var i=!1;s(n,(function(n){n!=="name"&&n!=="bindings"&&n!=="reference"&&(i=!0)}));i?t.push("Command reference can only define 'name' and 'bindings' properties. Definition: {0}".format(f.toJSON(n))):n.reference.commandType||t.push("Command reference must specify the 'commandType' property. Definition: {0}".format(f.toJSON(n)))}}function yt(n,t){n&&o("commandsCatalog",n,t)&&n.forEach(
(function(n){var i="Commands in 'commandsCatalog' ";n.name||t.push(i+"must have names.");!n.reference||t.push(i+"cannot specify a 'reference' property.")}))}function pt(n,t){n&&o("partsCatalog",n,t)&&n.forEach((function(n){k(n,t)}))}function wt(n,t){e("name",n.name,t);e("moduleId",n.moduleId,t)}function k(n,t){n.inputDefinitions&&o("PartType: {0}. Property: inputDefinitions".format(n.name),n.inputDefinitions,t);n.reference&&bt(n,t);w("PartType: {0}".format(n.name),n,t)}function bt(n,t){(n.reference.bindings||[]).forEach((function(i){(i.valuesFrom||[]).forEach((function(i){i.referenceType!==7&&i.referenceType!==9&&i.referenceType!==5&&t.push("Adapted Part: {0} can only have Adapter, AdapterInput and Constant bindings for its referenced part.".format(n.name))}))}))}var d=i.Extension,c=d.SetRequirement,g=i.forEachKey,l=(function(){function n(){this.errors=[]}return n.prototype.valid=function(){return!this.errors.length},n})();t.ValidationResult=l;t.validateDefinition=nt;t.validateIsString=e;t.validateIsBoolean=
a;t.validateIsArray=o;t.validateBlade=v;t.validateControl=wt;t.validatePartType=k}));define("MsPortalImpl/Extension/Extension.Manifest",["require","exports","f","./Extension.DefinitionValidator"],(function(n,t,i,r){"use strict";var u;return (function(n){function f(n){var t=new r.ValidationResult,i,f;return n?((typeof n.name!="string"||u(n.name)||n.name.indexOf("!")>=0)&&(f="The extension manifest should specify a valid name. This name is obtained from the <Extension> tag in PDL. This name should be a string and cannot be empty or whitespace. It also cannot contain the ! character. The recommended naming convention for an extension name is to follow the pattern {Company}_{BrandOrSuite}_{ProductOrComponent} (e.g. Microsoft_Azure_Insights).",t.errors.push(f)),n.assetTypes&&r.validateIsArray("manifest.assetTypes",n.assetTypes,t.errors)&&n.assetTypes.forEach((function(i){e(i,n.name,t.errors)})),t):(i="Manifest was not specified for the extension. Ensure that you passing a valid manifest to the FxExtension.register/FxExtension.registerAmd call that is used to register your extension with the portal.",
t.errors.push(i),t)}function t(n,t,i,r){n.push(t.format(i,r))}function e(n,r,f){var e=n.name;if(u(e)&&t(f,"The name for the asset type in manifest '{0}' was not specified.",r),n.browseType!==undefined&&typeof n.browseType!="number"&&t(f,"The browse type for the asset type '{0}' in manifest '{1}' was not a number.",e,r),n.browseServiceViewModel&&typeof n.browseServiceViewModel!="string"&&t(f,"The browse service view model for the asset type '{0}' in manifest '{1}' was not a string.",e,r),n.browseLinkUri&&typeof n.browseLinkUri!="string"&&t(f,"The browse link URI for the asset type '{0}' in manifest '{1}' was not a string.",e,r),n.privateBrowse!==undefined&&typeof n.privateBrowse!="boolean"&&t(f,"The private browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",e,r),n.browseRequiresRdfe!==undefined&&typeof n.browseRequiresRdfe!="boolean"&&t(f,"The requires RDFE browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",e,r),n.browseRequirements!==
undefined&&typeof n.browseRequirements!="number"&&t(f,"The browse requirements was present for the asset type '{0}' in manifest '{1}' was not a number.",e,r),n.browseType!==undefined){switch(n.browseType){case 0:n.browseServiceViewModel||t(f,"The browse for the asset type '{0}' in manifest '{1}' is set to use a service view model but there was no service view model.",e,r);break;case 1:n.browseServiceViewModel&&t(f,"The browse for the asset type '{0}' in manifest '{1}' is set to use the asset type's resource type but there was a service view model.",e,r);break;case 2:n.browseServiceViewModel&&t(f,"The browse for the asset type '{0}' in manifest '{1}' is set to use the asset type's blade but there was a service view model.",e,r);break;case 3:n.browseLinkUri||t(f,"The browse for the asset type '{0}' in manifest '{1}' is set to be a service link but there was no link URI.",e,r);break;case 4:n.browseLinkUri||t(f,"The browse for the asset type '{0}' in manifest '{1}' is set to be an instance link but there was no link URI.",
e,r)}n.privateBrowse!==undefined&&n.browseType===undefined&&t(f,"The private browse flag was present for the asset type '{0}' in manifest '{1}' but there was browse type.",e,r);n.browseType!==0&&n.browseServiceViewModel&&t(f,"The asset type '{0}' in manifest '{1}' has a browse service but doesn't have service view model browse type.",e,r);u(n.pluralDisplayName)&&u(n.text)&&t(f,"The pluralDisplayName for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",e,r);i.isNullOrUndefined(n.icon)&&t(f,"The icon for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",e,r)}else n.browseServiceViewModel!==undefined?n.browseType=0:n.privateBrowse!==undefined&&t(f,"The asset type '{0}' in manifest '{1}' has a private blade flag but no browse type.",e,r);n.gridColumnsServiceViewModel&&typeof n.gridColumnsServiceViewModel!="string"&&t(f,"The grid columns service view model for the asset type '{0}' in manifest '{1}' was not a string.",
e,r);n.dynamicBladeServiceViewModel&&typeof n.dynamicBladeServiceViewModel!="string"&&t(f,"The dynamic blade service view model for the asset type '{0}' in manifest '{1}' was not a string.",e,r);n.propertyProviderServiceViewModel&&typeof n.propertyProviderServiceViewModel!="string"&&t(f,"The property provider service view model for the asset type '{0}' in manifest '{1}' was not a string.",e,r)}var u=i.isNullOrWhiteSpace;n.validate=f})(u||(u={})),u}));define("MsPortalImpl/Extension/ViewModelManager",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function e(n,i,r){t[n]={name:n,modulePath:i,factory:r}}function o(n,t,i){r[n]={name:n,modulePath:t,factoryWithState:i}}function s(n,t,i){u[n]={name:name,modulePath:t,factoryWithPrefix:i}}function h(n,e,o){var s=null,h=null,c=i.Helpers.Deferred();return(e in t?(s=t[e].modulePath,h=t[e].factory):e in r&&(s=r[e].modulePath,h=function(n){return r[e].factoryWithState(n,o)}),f(u,(function(t,i){e.startsWith(t)&&(s=i.modulePath,
h=function(t){return i.factoryWithPrefix(t,o,e,n)})})),s)?(i.require(s).then((function(n){c.resolve(h(n))}),(function(n){c.reject(n.message)})),c.promise()):null}var t={},r={},u={},f=i.forEachKey;n.register=e;n.registerWithState=o;n.registerPrefix=s;n.resolve=h})(r||(r={})),r}));define("MsPortalImpl/Base/JQueryExtensions",["require","exports","f","$","./JQueryHelper","./Base.EventTypes"],(function(n,t,i,r,u,f){"use strict";var e;return (function(){function l(t,r,u){var f=i.find(t,(function(t){var i=n(t);return!i.hasClass(s)&&i.is(":tabbable")&&(!u||u(i))}),r?-1:0);return n(f||[])}function e(t){return function(i){var r=this;return[h,c].reduce((function(u,f){if(!(u&&u.length)){var e=n(f,r).toArray();return l(e,t,i)}return u}),null)}}var r=u.findByClassName,o=window,n=jQuery,s="msportalfx-skip-initial-focus",t=n.fn,h="select, button, [tabindex=0], input, textarea",c="a";t.setEvents=function(){for(var n,i,r=[],t=0;t<arguments.length;t++)r[+t]=arguments[t];return n=this,i=function(t){var i=function(){return n[
t].apply(n,arguments)};r.forEach((function(n){var u=n[0],t=n[1],r;typeof t=="function"?i(u,t):(r=n[2],r&&i(u,t,r))}))},i("on"),{dispose:function(){n&&(i("off"),n=null)}}};t.findByClassName=function(n){return r(this,n)};t.findFirstTabbable=e();t.findLastTabbable=e(!0);t.isInScrollView=function(n){var u,t=n?this.closest("."+n):u=this.scrollParent();if(!t[0].offsetParent||!t.is(u||this.scrollParent())&&!this.isInScrollView())return!1;var i=t.offset().top,f=i+t.height(),r=this.offset().top,e=r+this.height(),o=r>=i&&r<=f,s=e<=f&&e>=i;return o&&s};t.handleTransitionEndOnce=function(t,i,r){var s=this,u,h=!1,e;this.on(f.default.transitionend,u=function(n){for(var e,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];(e=n&&n.originalEvent,e&&e.propertyName!==t)||h||(h=!0,s.off(f.default.transitionend,u),r.apply(s,[n].concat(o)))});return e=function(){var i=n.Event("transitionend",{originalEvent:{propertyName:t}});u(i)},n.fx.off?e():o.setTimeout(e,i),this};n.enableAnimations=function(t){var i="fxs-transition-off-style-head-marker",
f=n("<style/>").addClass(i).append("* {transition: none !important;-webkit-animation-iteration-count: .5 !important;animation-iteration-count: .5 !important;-webkit-animation-duration: 0s !important;animation-duration: 0s !important;-webkit-animation-delay: 0s !important;animation-delay: 0s !important;}"),u=n("head");n.fx.off=!t;t?r(u,i).remove():r(u,i).length===0&&u.append(f)}})(e||(e={})),e}));define("MsPortalImpl/Extension/Extension",["require","exports","f","i","o","ko","../UI/Compositions/UI.Composition.CloudName","../Extension/DefinitionPreprocessor","./Extension.DefinitionValidator","../Extension/Extension.Definition.Locator","../Extension/Extension.Manifest","MsPortalFx/Globalization","MsPortalImpl/Resources/ImplScriptResources","../Base/Languages","../Parts/Parts","../UI/Compositions/UI.Composition.BladeOpenerBase","../UI/Hubs/UI.NotificationManager","../Extension/ViewModelManager","MsPortalImpl/Base/JQueryExtensions"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";function eu(
n){return i.map(n,(function(n,t){return{lower:t.toLowerCase(),key:t,val:n}})).sort((function(n,t){return n.lower.localeCompare(t.lower)}))}function ou(n,t){if(!ru)return!1;var i=t&&t.supportsWebWorkers&&t.supportsWebWorkers.toLowerCase()==="true";return n=n.toLowerCase(),uu==="true"?ki.indexOf(n)!==-1||i:!1}function gi(n){return n&&n.formatCulture===bt&&n.displayLanguage===wt}function nr(n){var i=gt.format(n),t;try{t=JSON.parse(MsPortalImpl.localStorage.getItem(i))}catch(r){nt.error(r,4,n)}return t}function su(n){var t=gt.format(n);try{MsPortalImpl.localStorage.removeItem(t)}catch(i){nt.warning(i,4,n)}}function tr(n){var t=new ot(ct.href);return t.setRelativePath(n),t.toString()}function hu(n,t){return{overwrite:{activeFlights:k.activeFlights,extensionTraceUri:yr,shellVersion:k.shellVersion,extensionTelemetryUri:pr,fxRequireConfig:k.fxRequireConfig,bootScripts:t},merge:{features:n}}}function cu(n){return n.replace(/\\/g,"\\\\").replace(/\'/g,"\\'")}function lu(n,t){var i=new ui;return new ii(
n,t,i)}function au(n){return ti[n]||(ti[n]={})}function vu(n){for(var r=yi["*"].slice()||[],u=0,t=n.obsoleteBundlesBitmask;t;t>>=1,u++)t%2&&i.pushUnique(r,yi[u]);return r}function ir(n,r){var u=au(n.name);return u[r]||(u[r]=i.union(r&1&&vu(n),r&2&&i.union(nu,t.patchUris)))}function rr(n){var t=$("<iframe/>").addClass("fxs-extension-frame").attr({tabindex:-1,"aria-hidden":!0});return n||t.attr({sandbox:"allow-same-origin allow-scripts"}),t.appendTo(lr),t}function ur(n,t){var v=n.name,ft=0,y=n.flights,h=u.keys(!n.isTestExtension&&y||{}).first((function(n){return gr<(ft+=y[n])}))||n.uri,c=new ot(h),p=c.query,l=n.cacheability||0,e=[],r={},f,a,g,s,nt,tt;c.fragment=k.sessionId;f=n.trustedHost||h;f!=="*"&&(f=f.indexOf("//")>=0?i.ensurePrefix(f,ct.protocol):ct.href,f=new ot(f).getSchemeAndAuthority());n.trustedHost=f;k.passThroughVariables&&(e=e.concat(k.passThroughVariables));r.cacheability=l;l===0?e.push("sessionId"):l===2&&(t=k.pageVersion);a=it.fx.bootEnvironment.region;a&&(r.region=a);k.extensionQueryParameters&&
(e=e.concat(k.extensionQueryParameters));e.forEach((function(n){var t=k[n];oi(t)||(r[n]=t)}));var et=v.toLowerCase(),w={},o=k.userTypeHint||"",b=!1,d=et+"_";return di.forEach((function(n){var u=n.lower,t,i;u.startsWith(d)&&(t=n.val,i=u.substr(d.length),i==="clean"&&t.toLowerCase()==="true"?b=!0:i==="clientoptimizations"?r[i]=t:i==="usertype"?o+="("+t+")":r[n.key]=t,w[i]=t)})),o&&(g=o.substr(1,o.length-2),r["feature.userType"]=g),hi&&(r.trace=hi),s="MinimizeInitBundles",(MsPortalImpl.localStorage.getItem(s)||"").toLowerCase()===s.toLowerCase()&&(r.bundlingKind=s),nt=i.extend2(k.features,w),r.pageVersion=t,p.getParameter("l")||r.l||(r.l=ar),tt=new ot(ct.href).getAuthority(),r.trustedAuthority=tt,r.extensionName=v,rt.multiCloudEnabled&&(r.cloudName=n.cloudName),ut.forceDisable?r[ut.disableParameter]=!0:ut.forceIndex&&(r[ut.indexParameter]=ut.forceIndex),p.setParameters(r),{uri:c.toString(),flightUri:h,clean:b,effectiveFeatureFlags:nt}}function yu(n,t,i){for(var r=[],u=Q(),f=function(){r.length<
t&&(u=u.then((function(){if(r.length<t)return i().then((function(n){r.push(n)})).catch((function(n){nt.error(n,6)}))})))},e=0;e<t;e++)f();return{getItem:function(){return Q.delay(dr).then(f),r.pop()},size:function(){return r.length}}}function pu(n,t,i){n.styleSheets&&y.injectStyles(t,{extensionWindowId:i,styleSheets:n.styleSheets.map((function(n){return{file:"",content:n}}))})}var rt=r.Extension,er=r.TelemetryContext,ht=i.Base,ot=ht.UriBuilder,st=ht.Constants,or=st.ExtensionNames.Hubs,yt=ht.Diagnostics,sr=yt.Telemetry,pt=r.Rpc,hr=i.Hubs.Notifications.NotificationStatus,ei=i.Helpers.Deferred,di,d,g,vt,ti,ii,et,ri,fr,ui,fi;t.patchUris=[];var it=window,ct=it.location,lt=it.fx.getTimestamp,oi=i.isNullOrUndefined,cr=$("head"),lr=$("body"),nt=yt.createLog(n),k=it.fx.environment,ut=k.cdn,si="FxCdnIndex"+ut.index,wt=l.displayLanguage,bt=l.formatCulture,ar=wt+v.localeDelimiter+bt,vr=!!k.trace.extensionmanager,hi=k.traceStr,wu=vr?function(n){nt.verbose(n)}:i.noop,ci=ht.getVersionFromString,kt=ci(k.sdkVersion),
li=i.getFeatureValue("extloadtimeout"),yr=tr(k.extensionTraceUri),pr=tr(k.extensionTelemetryUri),dt=li&&parseInt(li)||9e4,wr=k.relex,ai=a.Shell,br="data-extensionname",ft="ExtensionManager",gt="EXTENSIONMANIFEST_{0}",ni=3,at=(ni+1)*2,tt=sr,kr=er,vi=2e4,dr=4e3,gr=Math.random(),yi=k.extensionScripts,nu=k.postScripts,pi=0,wi=0,tu=lt(),iu=i.forEachKey,bi=i.startTimer,ru=[it.Worker,it.fetch,it.Promise,it.Blob].indexOf(undefined)===-1,ki=(k.features.webworker||"").toLowerCase().split(","),uu=ki.shift(),fu=i.isFeatureEnabled("maxconcurrentiframe");di=eu(k.extensionFlags);t.canUseManifest=gi;t.getCachedManifestFromLocalStorage=nr;t.escapeSingleQuote=cu;t.initialRetryDelay=dt,(function(n){n[n.NotLoaded=0]="NotLoaded";n[n.FirstResponseReceived=1]="FirstResponseReceived";n[n.ManifestReceived=2]="ManifestReceived";n[n.Initialized=3]="Initialized";n[n.Error=4]="Error"})(t.ExtensionReadyState||(t.ExtensionReadyState={}));d=t.ExtensionReadyState,(function(n){n[n.None=0]="None";n[n.FirstResponseNotReceived=
1]="FirstResponseNotReceived";n[n.ManifestNotReceived=2]="ManifestNotReceived";n[n.InvalidExtensionName=3]="InvalidExtensionName";n[n.InvalidManifest=4]="InvalidManifest";n[n.InvalidDefinition=5]="InvalidDefinition";n[n.FailedToInitialize=6]="FailedToInitialize";n[n.TooManyRefreshes=7]="TooManyRefreshes";n[n.TooManyBootGets=8]="TooManyBootGets";n[n.TimedOut=9]="TimedOut";n[n.MaxRetryAttemptsExceeded=10]="MaxRetryAttemptsExceeded";n[n.HomePageTimedOut=11]="HomePageTimedOut";n[n.Unexpected=12]="Unexpected"})(g||(g={})),(function(n){n[n.Default=0]="Default";n[n.Part=1]="Part"})(t.ViewModelType||(t.ViewModelType={}));vt=t.ViewModelType;t.create=lu;ti={};t.getScriptUris=ir;t.createUri=ur;ii=(function(){function n(t,r,u){var e=this;this.initializedExtension=f.observable();this._uriDeferred=Q.defer();this._readyState=d.NotLoaded;this._errorState=g.None;this._manifests=new i.Map;this._initializedDeferred=Q.defer();this._manifestLoaded=Q.defer();this._perfData={};this._initializeRequired=!1;this._bootGetCount=
0;this._scriptErrors=[];this._bladeRedirectMap={};this._memoizedRPCEndPoint=i.memoizeQ((function(){var n=e.getWindowId();return Q(rt.initializeEndPoint.invoke(e._rpcClient,n,undefined)).then((function(t){i.extend(e._perfData,t);var r=t&&t._msPortalFxDef;return r&&delete e._perfData._msPortalFxDef,r||rt.getDefinitionEndPoint.invoke(e._rpcClient,n,undefined)})).then((function(n){var c=e.getManifest("assetTypes"),r=s.validateDefinition(n),t;if(r.valid()){var u=o.preprocessDefinition(n,c,h.redirects()),l=e._perfData.totalTime=e._loadTimer(),f=new fr(e._rpcClient,e,u,l);pu(u,document,e.getWindowId());e._transitionStateTo(d.Initialized);e._clearExtensionReloadHandle();e._extensionInitializedTraceKey=tt.startTrace({source:ft,action:"ExtensionInitialized",name:e.name});e.initializedExtension(f);e._initializedDeferred.resolve(f)}else return t="The extension definition has validation errors. Errors: {0}".format(JSON.stringify(r.errors)),e._onError(g.InvalidDefinition,t),Q.reject(new i.Errors.Error(t))})
).catch((function(n){return e._reloadFrame("message: {0}, stack: {1}".format(n.message,n.stack),g.FailedToInitialize),Q.reject(n)}))}));this._memoizedAcquireWindow=i.memoizeQ((function(){return fu?n.maxConcurrentAcquireWindow(e):e._acquireWindow()}));this._rpcClient=t;this.metadata=r;this._hostingContext=u;this._useWebWorker=ou(r.name,r.features)}return u.defineProperty(n.prototype,"cloudName",{get:function(){return this.metadata.cloudName},enumerable:!0,configurable:!0}),n.prototype.getVersion=function(){return this._extVersion},u.defineProperty(n.prototype,"initializeRequired",{get:function(){return this._initializeRequired},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"unloaded",{get:function(){return!this._window},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"name",{get:function(){return this.metadata.name},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"isTestExtension",{get:function(){return!!this.metadata.isTestExtension},enumerable:!0,configurable:
!0}),u.defineProperty(n.prototype,"isTestStamp",{get:function(){return!!this.metadata.isTestStamp},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"readyState",{get:function(){return this._readyState},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),n.prototype.getBladeRedirect=function(n){return this._bladeRedirectMap[n&&n.toLowerCase()]},n.prototype.getManifest=function(n){return this._manifests.get(n)},n.prototype.setManifest=function(n,t){var r=this,i=t;return i.cloudName=this.cloudName,(i.redirects||[]).forEach((function(n){if(n.type===2||n.type===3){var t=n.fromBlade;t&&(r._bladeRedirectMap[t.toLowerCase()]=n)}})),this._manifests.set(n,i),i},n.prototype._getBootScript=function(n){var i=JSON.stringify(hu(this.effectiveFeatureFlags,n)),t=k.extensionEntryPointText+(";FxImpl.bootInitialize("+i+");");return this._useWebWorker&&(t=k.webWorkerPreambleText+"(window, "+JSON.stringify(t)+");"),t}
,n.prototype.ensureInitialize=function(){this._initializeRequired=!0},n.prototype.getManifestAsync=function(){return this._manifestLoaded.promise},n.prototype.whenInitialized=function(){return this._initializedDeferred.promise},n.prototype.onManifestReceived=function(n){var t=this._validateAndSetManifest(n,!1);t&&(this._addManifestToCache(),this._initializeRequired?this._initialize():this._rpcClient.gcWindow(this.getWindowId()),this._initializeRequired=!0)},n.prototype._initialize=function(){var n=this;return this._memoizedRPCEndPoint()},n.prototype.getOrLoadWindow=function(){var n=this;if(!this._window){this._bootGetCount=0;this._retryAttempt=0;this._initialResponseTraceKey=tt.startTrace({source:ft,action:"InitialExtensionResponse",name:this.name});this._loadTraceKey=tt.startTrace({source:ft,action:"LoadExtensions",name:this.name});var t=this.metadata,i=t.features,u=k.trace.nonsecure||i&&i.nonsecure==="true",r=0;this._window=this._hostingContext.createExtensionWindow({getWindowId:function(
){return rt.getWindowId(t)},trustedHost:t.trustedHost,frameUri:this._uri,createIframe:function(){return rr(u)},onLoad:function(){return n._readyState=d.NotLoaded,n._errorState=g.None,r++,r>at?(n._onError(g.TooManyRefreshes,"The iframe for extension '{0}' refreshed/reloaded more than '{1}' times and has been unloaded.".format(n.name,at)),!1):!0},onError:function(){n._reloadFrame("Extension Index page failed to load timed out in '{0}'ms.".format(vi),g.HomePageTimedOut)}});this._window.onDispose((function(){n._clearExtensionReloadHandle();n._initializedDeferred=Q.defer();n.initializedExtension(void 0);n._memoizedRPCEndPoint.clear();n._memoizedAcquireWindow.clear();tt.trace({source:ft,action:"ExtensionUnloaded",name:n.name,data:{currentState:n._readyState}});n._extensionInitializedTraceKey&&(tt.completeTrace(n._extensionInitializedTraceKey),n._extensionInitializedTraceKey=null);var t="style[{0}='{1}']".format(br,n.name);cr.remove(t);n._window=null}));this._loadTimer=bi();this._startTime=lt();
this._extensionReloadHandle=it.setTimeout((function(){n._reloadFrame()}),dt)}return this._window},n.prototype.noteScriptError=function(n){this._scriptErrors.push(n)},n.prototype._reloadFrame=function(n,t){var r=this,i;if(!this.unloaded&&this._readyState!==d.Initialized){if(!n&&!t){t=g.None;n="Failed to load extension after {1} attempts over {0} secs.";switch(this._readyState){case d.NotLoaded:t=g.FirstResponseNotReceived;n="First response was not received after a time of {0} secs.";break;case d.FirstResponseReceived:t=g.ManifestNotReceived;n="Manifest not received after {0} secs.";break;case d.ManifestReceived:t=g.TimedOut;n="Manifest was received, however failed to initialize the extension after {0} secs."}}this._retryAttempt>=ni&&(t=g.MaxRetryAttemptsExceeded);n=n.format(Math.round(this._loadTimer()/1e3),this._retryAttempt+1);this._clearExtensionReloadHandle();this._cleanupFrameForReload();this._retryAttempt<ni?(this._loadTimer=bi(),this._startTime=lt(),i=new ot(this._uri),this._retryAttempt++,
i.query.setParameter(k.retryAttemptName,this._retryAttempt),this._window.refresh(i.toString()),this._onExtensionLoadingRetry&&this._onExtensionLoadingRetry(),this._extensionReloadHandle=it.setTimeout((function(){r._reloadFrame()}),dt),nt.warning("Reloading extension '{0}' from '{1}'. Retry attempt: {4}. ErrorState: {2}. Error: {3}.".format(this.name,this.uri,g[t],n,this._retryAttempt))):this._onError(t,n)}},n.prototype._cleanupFrameForReload=function(){this._transitionStateTo(d.NotLoaded);this._useWebWorker=!1;this._window.reloadChannel()},n.prototype.getWindow=function(){return this._window},n.prototype.getTrustedHost=function(){var n=this._window;return n&&n.getTrustedHost()},n.prototype.getWindowId=function(){return rt.getWindowId(this)},n.prototype._acquireWindow=function(){return pt.internalClient.acquireWindow(this.getWindowId(),0),this._manifestLoaded.promise.isPending()||(this._manifestLoaded=Q.defer()),this._manifestLoaded.promise},n.prototype.uriPromise=function(){return this._uriDeferred.
promise},n.prototype.loadAsync=function(n,t){var f=this,r,i,u;return this.unloaded?((!n||this._clean)&&(n={}),r=n.manifest,i=ur(this.metadata,t||r&&r.pageVersion),this._uri=i.uri,this._flightUri=i.flightUri,this._clean=i.clean,this.effectiveFeatureFlags=i.effectiveFeatureFlags,this._uriDeferred.resolve(i.uri),r&&this._validateAndSetManifest(r,!0)?this.ensureInitialize():u=this._memoizedAcquireWindow(),this._initializedDeferred.promise):this.whenInitialized()},n.prototype.dispose=function(){this._window&&(this._window.dispose(),this._window=null)},n.prototype.processBootMessage=function(n){var r=!1,t=n.sdkVersion,f=n.extVersion,e,i,o,s,u;if(t&&f){e=n.bootVersion||1;i=void 0;try{i=ci(t);k.features.checksdkversion&&i>kt&&(o="The '{0}' extension at '{1}' was compiled with a newer version of the SDK ('{2}') than the shell ('{3}'). You may see unexpected results.",nt.warning(o.format(this.name,this.uri,i,kt)))}catch(h){nt.error("Invalid version information '{0}' specified by '{1}'.".format(t,
this.name),0,h)}this._readyState!==d.NotLoaded&&(nt.warning("Unexpected bootget from '{0}' specified by '{1}', unexpected reload.".format(this.name,t)),this._cleanupFrameForReload());this._transitionStateTo(d.FirstResponseReceived);this._initialResponseTraceKey&&(this._perfData.initialExtensionResponse=tt.completeTrace(this._initialResponseTraceKey),this._initialResponseTraceKey=null);this._manifestLoadTraceKey=tt.startTrace({source:ft,action:"ManifestLoad",name:this.name,data:{fxcdn:si}});this._bootGetCount++;this._bootGetCount>at&&this._onError(g.TooManyBootGets,"The iframe '{0}' sent more than '{1}' handshake messages over '{2}' attempts without making progress. it has been unloaded.".format(this.name,at,this._retryAttempt));s=ir(this.metadata,3);u=this._getBootScript(s);e===2?this._window.postMessage({data:u,kind:1},[this._window.getExternalPort()]):this._window.postMessage({signature:k.bootMessageSignature,kind:1,data:{scripts:[{data:u,kind:1}],stopListening:!0}});this._tryLoadCachedManifest(
f);r=!0}else n.kind===5&&(this._window.postMessage({},[this._window.getExternalPort()]),r=!0);return r},n.prototype._tryLoadCachedManifest=function(n){var i=!1,r,t;return this._extVersion=n,this.isTestExtension||this.initializeRequired||!n||(r=this.getWindowId(),t=nr(r),gi(t)&&n===t.extVersion&&(i=this._validateAndSetManifest(t.manifest,!0),this._window.dispose(),this.ensureInitialize()),i||su(r)),i},n.prototype._addManifestToCache=function(){var n=this.getManifest("assetTypes"),t=this._extVersion,i,r,u;if(n)if(t)if(n.sdkVersion){if(!this.isTestExtension)try{r=gt.format(this.getWindowId());u={manifest:n,formatCulture:bt,displayLanguage:wt,extVersion:t,sdkVersion:kt};MsPortalImpl.localStorage.setItem(r,JSON.stringify(u))}catch(f){nt.warning(f,4,this.getWindowId())}}else i="Unable to add manifest for '{0}' to cache since it has not specified the SDK version on which it was compiled. Specified version was '{1}'.",nt.warning(i.format(this.name,n.sdkVersion),102);else nt.warning("Unable to add manifest for '{0}' to cache since it has not specified a valid version. Specified version was '{1}'.".
format(this.name,t),101);else nt.warning("Unable to add manifest for '{0}' to cache since it is unavailable.".format(this.name))},n.prototype._validateAndSetManifest=function(n,t){var l=this,r=!1,e=c.validate(n),o,s,u,h,f;if(e.valid())if(this.name.toLowerCase()!==n.name.toLowerCase())o="The extension name defined in the manifest '{0}' (obtained from the <Extension> tag in PDL) does not match the name '{1}' used to identify the extension with the portal. Ensure that the name you specify in the <Extension> tag in PDL matches the one used in the extensions.json file to identify the extension with the portal.",this._onError(g.InvalidExtensionName,o.format(n.name,this.name));else{(this._readyState===d.Error||this._readyState===d.Initialized)&&(s="Extension manifest for '"+this.name+"' received at an incorrect point in time. "+("Current extension state: ExtensionReadyState."+d[this._readyState]+". ")+"This method should be called when the extension state is NotLoaded or FirstResponseReceived or ManifestReceived. "+
("Callstack: "+i.getCurrentCallStack()),nt.error(s,5));try{oi(n.isPreview)&&(u=this.metadata.features,n.isPreview=(u&&u.preview||"").toLowerCase()==="true");t||iu(wr.cachedManifestTypes,(function(t){l.setManifest(t,n)}));h=this.setManifest("assetTypes",n);this._transitionStateTo(d.ManifestReceived);this._manifestLoaded.resolve(h);r=!0}catch(a){f="_validateAndSetManifest throws";nt.error(new i.Errors.Error({message:f,data:n,innerErrors:a}));this._onError(g.Unexpected,f)}}else e.errors.forEach(nt.error,nt),this._onError(g.InvalidManifest,"The extension manifest has validation errors.");return(r||!t)&&this._manifestLoadTraceKey&&(this._perfData.manifestLoad=tt.completeTrace(this._manifestLoadTraceKey),this._manifestLoadTraceKey=null),r},n.prototype._onError=function(n,t){var e=this,f="Failed to initialize extension '{0}' at '{1}'. ErrorState: {2}. Error: {3}.".format(this.name,this.uri,g[n],t),i=r.createError(f,{data:{previousState:this._readyState,hasLoadTraceKey:this._loadTraceKey?1:0,hasInitializeTraceKey:
this._initializeTraceKey?1:0,successfulExtensionLoads:wi,failedExtensionLoads:pi,timeThisFileLoaded:tu,scriptErrors:this._scriptErrors,flightUri:this._flightUri,extVersion:this._extVersion,timeThisExtensionStartedLoading:this._startTime,timeThisExtensionFailed:lt(),timeToFail:this._loadTimer()}}),u;nt.error(i,1);yt.Upload.flush();this._memoizedRPCEndPoint.clear();this._memoizedAcquireWindow.clear();this._manifestLoaded.reject(i);this._initializedDeferred.reject(i);this._readyState!==d.Error&&(this._transitionStateTo(d.Error,n),u=w.getNotificationManager(),u&&u.addClientNotification({title:ai.extensionError,description:ai.loadingError.format(this.name),status:hr.Error,timestamp:new Date,cloudName:st.DefaultCloudName}));this.dispose()},n.prototype._transitionStateTo=function(n,t){var i=this;this._readyState=n;n===d.ManifestReceived?(this._loadTraceKey&&(tt.completeTrace(this._loadTraceKey),this._loadTraceKey=null),this._initializeRequired&&(this._initializeTraceKey=tt.startTrace({source:
ft,action:"InitializeExtensions",name:this.name,data:{fxcdn:si}}))):n===d.Initialized?this._initializeTraceKey&&(this._perfData.flightUri=this._flightUri,this._perfData.extVersion=this._extVersion,tt.completeTrace(this._initializeTraceKey,this._perfData),this._initializeTraceKey=null,wi++):n===d.Error&&(pi++,this._loadTraceKey&&(tt.cancelTrace(this._loadTraceKey),this._loadTraceKey=null),this._initializeTraceKey&&(tt.cancelTrace(this._initializeTraceKey,{errorState:t}),this._initializeTraceKey=null),this._initialResponseTraceKey&&(tt.cancelTrace(this._initialResponseTraceKey),this._initialResponseTraceKey=null),this._manifestLoadTraceKey&&(tt.cancelTrace(this._manifestLoadTraceKey),this._manifestLoadTraceKey=null));t&&(this._errorState=t)},n.prototype._clearExtensionReloadHandle=function(){this._extensionReloadHandle&&(it.clearTimeout(this._extensionReloadHandle),this._extensionReloadHandle=null)},n.maxConcurrentAcquireWindow=r.QConcurrent(2,2e3,(function(n){return n._acquireWindow()})),
n})();t.ExtensionImpl=ii;et=st.BladeNames.Hubs.ResourceMenuBlade;ri={};ri[or]=[{partName:et+"$"+et,locator:h.resourceMenu.withLens(et).withPartInstance(et),getPartDefinition:function(n){return n.getBladeDefinition(et).then((function(n){return n.lenses[0].partInstances[0].inline}))}}];fr=(function(){function n(n,t,i,u){var o=this,s,h;this.outstandingObjectCount=f.observable(0);this.metadataCount=f.observable(0);this._proxiedObjects=[];this._pools={};this._bladeDefMap={};this._partDefMap={};this._controlDefMap={};this._rpcClient=n;s=this._lifetime=new r.TriggerableLifetimeManager;s.registerForDispose(this._extension=t);this.cloudName=t.cloudName;h=this.name=t.name;this.definition=i;this.loadTime=u;(ri[h]||[]).forEach((function(n){o._pools[n.locator.toString()]=yu(s,5,(function(){return n.getPartDefinition(o).then((function(t){var i=t.details;return Q(o.getPartViewModel(n.partName,{initialState:{},createSelectable:p.needContainerSelectable(i),createHubsInternalCloudNameProperty:e.needInternalProperty(
h,i),partSize:t.initialSize,partLocation:2,collapsed:null,containerType:0}))}))}))}))}return u.defineProperty(n.prototype,"extension",{get:function(){return this._extension},enumerable:!0,configurable:!0}),n.prototype.canUseInputsSetParameters=function(n){var t=this._pools[n.toString()];return!t||!t.size()},n.prototype.getBladeRedirect=function(n){return this._extension.getBladeRedirect(n)},n.prototype.getWindow=function(){return this._extension.getWindow()},n.prototype.processMessages=function(){return rt.pingEndPoint.invoke(this._rpcClient,this._extension.getWindowId(),undefined)},n.prototype.dispose=function(){this._lifetime.dispose()},n.prototype.getManifest=function(n){return this._extension.getManifest(n)},n.prototype.getBladeDefinition=function(n){var f=this,r=this.definition,t=n.toLowerCase(),u=r.bladeMap[t],i;return u?Q(u):(i=this._bladeDefMap,i[t]||(i[t]=Q(rt.getBladeDefinitionEndPoint.invoke(this._rpcClient,this._extension.getWindowId(),n)).then((function(n){return o.processBlade(
r,f.getManifest("assetTypes"),n,h.redirects())})).then((function(n){var t=[];if(s.validateBlade(r,n,null,t),t.length)throw new Error("Invalid blade definition. Errors: "+t.join("\n"));return n})).finally((function(){delete i[t]}))))},n.prototype.getPartDefinition=function(n){var f=this,r=this.definition,t=n.toLowerCase(),u=r.partTypeMap[t],i;return u?Q(u):(i=this._partDefMap,i[t]||(i[t]=Q(rt.getPartDefinitionEndPoint.invoke(this._rpcClient,this._extension.getWindowId(),n)).then((function(n){return o.processPart(r,f.getManifest("assetTypes"),n,h.redirects())})).then((function(n){var t=[];if(s.validatePartType(n,t),t.length)throw new Error("Invalid part type definition. Errors: "+t.join("\n"));return n})).finally((function(){delete i[t]}))))},n.prototype.getControlDefinition=function(n){var i=this,t=this._controlDefMap;return t[n]||(t[n]=Q(rt.getControlDefinitionEndPoint.invoke(this._rpcClient,this._extension.getWindowId(),n)).then((function(n){return o.processControl(i.definition,i.getManifest("assetTypes"),
n)})).then((function(n){var t=[];if(s.validateControl(n,t),t.length)throw new Error("Invalid control definition. Errors: "+t.join("\n"));return n})).catch((function(i){return delete t[n],Q.reject(i)})))},n.prototype.getViewModel=function(n,t){return this._getViewModel(vt.Default,n,t)},n.prototype.getPartViewModel=function(n,t){var f,r,u;return t&&t.locator&&(f=this._pools[t.locator.toString()])&&!t.onInputsSetParameters&&!i.keysLength(t.initialState)&&(r=f.getItem(),r)?(u=t&&t.onViewModelAcquired,u&&u(r),ei().resolve(r).promise()):this._getViewModel(vt.Part,n,t)},n.prototype._getViewModel=function(n,t,i){var o=this,u,r,e;return(i=i||{},u=b.resolve(this,t,i.initialState,i.createSelectable),u)?u.then((function(n){if(i.onViewModelAcquired)i.onViewModelAcquired(n);return typeof i.partSize=="number"&&n&&n.content&&f.isObservable(n.content.size)&&n.content.size(i.partSize),i.onInputsSetParameters&&n&&n.updatePartInputValues&&(n.onInputsSetPromise=Q().then((function(){return n.updatePartInputValues(
i.onInputsSetParameters.inputs,i.onInputsSetParameters.settings,i.onInputsSetParameters.traceOptions)}))),n})):(r=ei(),e=n===vt.Part?st.ViewModelTypes.PartViewModel:st.ViewModelTypes.ViewModel,rt.getViewModelsDefinition.acquireObject(this._rpcClient,this._extension.getWindowId(),{type:e,containerType:i.containerType||0,name:t,initialState:i.initialState,createSelectable:i.createSelectable,createHubsInternalCloudNameProperty:i.createHubsInternalCloudNameProperty,telemetryContext:kr.getState(),partSize:i.partSize,partLocation:i.partLocation,onInputsSetParameters:i.onInputsSetParameters,collapsed:i.collapsed,flags:i.flags},i.onViewModelAcquired&&function(n){return i.onViewModelAcquired(n&&n.getValue())}).then((function(n){return o._proxiedObjects.push(n),n.getValue()})).then((function(n){r.resolve(n)}),(function(n){r.reject(n)})),r.promise())},n.prototype.releaseViewModel=function(n){i.disposeDisposable(n);var t=i.findIndex(this._proxiedObjects,(function(t){return t.getValue()===n}));t!==-1&&this._proxiedObjects.
splice(t,1)[0].dispose()},n.prototype.isPreview=function(){return this.getManifest("assetTypes").isPreview},n})();ui=(function(){function n(){}return n.prototype.createExtensionWindow=function(n){var t=(n.createIframe||rr)(),u=it.setTimeout(n.onError,vi),f=t.setEvents(["load",function(t){it.clearTimeout(u);n.onLoad(t.originalEvent)}],["error",function(n){var t=n.originalEvent;nt.error(t.error,3,{message:t.message,filename:t.filename,colno:t.colno,lineno:t.lineno})}]),r,i;t.attr("src",n.frameUri);r=t[0].contentWindow;i=new fi(r,n.trustedHost||"*",function(n){t.attr("src",n)});i.onDispose((function(){f.dispose();it.setTimeout((function(){t.remove()}),1e3)}));return i},n})();t.BrowserHostingContext=ui;fi=(function(n){function t(t,i,r){var u=this;n.call(this,t);this._resettingChannel=!1;this._trustedHost=(i||"*").toLowerCase();this.refresh=r;this._resetChannel();this.onDispose((function(){u._resettingChannel||u._resetChannel()}))}return __extends(t,n),t.prototype.postMessage=function(n,t){this.getValue(
).postMessage(n,this._trustedHost,t)},t.prototype.getTrustedHost=function(){return this._trustedHost},t.prototype.getChannel=function(){return this._rpcChannel},t.prototype.getExternalPort=function(){return this._externalPort},t.prototype.reloadChannel=function(){var n=new MessageChannel;this._rpcChannel.swapPort(n.port1);this._externalPort=n.port2},t.prototype._resetChannel=function(){var n=this;this._resettingChannel=!0;var t=this._rpcChannel,i=new MessageChannel,r=this._rpcChannel=new pt.RpcChannel(i.port1);this._externalPort=i.port2;t&&t.dispose();this._resettingChannel=!1;this._rpcChannel.onDispose((function(){r===n._rpcChannel&&n.dispose()}))},t})(pt.DisposableValue);t.ExtensionWindow=fi}));define("MsPortalImpl/Extension/ExtensionManager",["require","exports","f","i","o","$","./Extension","./Extension.Definition.Locator","../Services/Services.Storage","../Base/Telemetry"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function b(n){return u.keys(n||{}).filter((function(t){var i=n[t];return i&&
!!i.manifest})).length}function ot(n,t,i){w.Log.writeEntry2(2,n,t,i)}function st(){return new tt.ExtensionManagerImpl({createExtension:e.create,storageService:s.create()})}var a=r.Extension,l=i.Base,k=l.Constants.ExtensionNames.Hubs,w=l.Diagnostics,it=w.Telemetry,v=r.Rpc,y=window,d=y.fx,rt=d.early,c=w.createLog(n),ut=n.normalize(undefined),g=d.environment,nt=it.trace,ft=i.startTimer,et="###BOOT###",p,tt;(function(n){function r(n,i){var r={};return n&&(r["x-ms-effective-locale"]=n),Q(l.Net2.ajax({uri:t.getUri(n,i),performRetry:!0,type:"GET",dataType:"json",contentType:"application/json",headers:r}))}function u(r){var u;return u=r==="assetTypes"?i=i||Q(t.promise).catch((function(n){return c.warning(n,6),null})).then((function(t){return b(t)?t:n.getManifestsAjax(undefined,r)})):n.getManifestsAjax(undefined,r),u.then((function(n){return n||{}})).catch((function(n){return c.error(n,7),{}}))}var t=rt.manifestCache,i;n.getManifestsAjax=r;n.getManifests=u})(p=t.Relex||(t.Relex={}));t.create=st,(function(
n){function t(n,t,i){return n.count=i.count-t.count,n.chars=i.chars-t.chars,n}var s=(function(){function n(n){var t=this;this.initializedExtensions=[];this._messageHandlers=[];this._isRpcStarted=!1;this._callbacksMap=new i.Map;this._callbacks=f.Callbacks();this._unloadCallbacks=f.Callbacks();this._allManifestsLoaded=Q.defer();this._manifestLoadStarted=Q.defer();this._lifetimeManager=new r.TriggerableLifetimeManager;this.manifestLoadComplete=!1;this._manifestsMap={};this._initializedExtensionMap={};this._createExtension=n.createExtension;n.skipRegisterManifest||a.registerManifestDefinition.register(v.client,null,(function(n,i){t._getExtensionByWindowId(i.srcWindowId).onManifestReceived(n)}));this._addExtensionBootReceiver();this.getHubsExtension=function(){return t.getExtensionByName(k,a.getHubsCloudName())}}return u.defineProperty(n.prototype,"lifetimeManager",{get:function(){return this._lifetimeManager},enumerable:!0,configurable:!0}),n.prototype.getExtension=function(n,t){return this._getExtensionByDescriptor(
{cloudName:t,name:n})},n.prototype.getManifestByName=function(n,t){var u=this,i=this._manifestsMap,r=JSON.stringify([].slice.call(arguments));return i[r]||(i[r]=this._manifestLoadStarted.promise.then((function(){return u.getExtension(n,t).getManifestAsync()})).catch((function(n){return delete i[r],Q.reject(n)})))},n.prototype.getExtensionByName=function(n,t,i){var f=this,r,u;return i=i||{},r=this._initializedExtensionMap,u=JSON.stringify([].slice.call(arguments)),r[u]||(r[u]=this._manifestLoadStarted.promise.then((function(){var i=f._getExtensionByDescriptor({cloudName:t,name:n});if(!i)throw new Error("extension {0}, in cloud {1} was not found".format(n,t));return n===k?i:i.uriPromise().then((function(){return i}))})).then((function(t){t.unloaded&&!i.onlyIfLoaded&&t.loadAsync();t.ensureInitialize();var e=t.whenInitialized();return i.timeout>0&&(e=Q(e).timeout(i.timeout,"Timed out waiting for extension '{0}' to load.".format(n))),e.then((function(){var n=f._getLoadedExtensionByWindowId(t.getWindowId(
)),i;return n&&(i=f.lifetimeManager.createChildLifetime(),n.extension.initializedExtension.subscribe(i,(function(n){n||(delete r[u],i.dispose())}))),n}))})).catch((function(n){return delete r[u],Q.reject(n)})))},n.prototype.initialize=function(n){var t=this,r,c,u,y;this._extensionsMap={};var w=this._createExtension,f={},k=i.isFeatureEnabled("extensionredirect")?n.extensions.filter((function(n){return!(f[n.name]=n.redirectTo)})):n.extensions,d=function(n){var r=n&&i.remove(t.initializedExtensions,n).length;r&&t._unloadCallbacks.fire(n);n&&(t.initializedExtensions.push(n),t._callbacks.fire(n))},s=k.map((function(n){var i=w(v.internalClient,n),r=i.getWindowId().toLowerCase();if(t._getExtensionByWindowId(r))throw new Error("Extension with window ID '"+r+"' has already been registered.");return i.initializedExtension.subscribeAndRun(t.lifetimeManager,d),t._extensionsMap[r]=i}));return o.redirects(f),this.startRpc(),r=this._getExtensionByWindowId(a.getHubsWindowId()),r&&r.loadAsync(null,g.pageVersion).
then((function(){v.internalClient.acquireWindow(r.getWindowId())})),c=ft(),n.useCachedManifests?(u=p.getManifests("assetTypes"),this._callbacksMap.has("assetTypes")||this._callbacksMap.set("assetTypes",{initialPromise:u,callbacks:new l.Callbacks})):u=Q({}),u.then((function(n){nt({source:"ExtensionManager",action:"CachedManifestCount",actionModifier:h.ActionModifier.Default,data:b(n),duration:c()});s.forEach((function(t){var i=n[t.name],r;i&&i.manifest||(r=e.getCachedManifestFromLocalStorage(t.getWindowId()),e.canUseManifest(r)&&r.manifest&&(i={manifest:r.manifest,version:r.extVersion}));(t.isTestExtension||t.isTestStamp)&&(i=null);t.loadAsync(i)}))})),y=s.map((function(n){var i=n.getManifestAsync();return i.then((function(n){t._callbacksMap.has("assetTypes")&&t._callbacksMap.get("assetTypes").callbacks.fire(n)})),i})),this._manifestLoadStarted.resolve(),Q.any([Q.allSettled(y),Q.delay(6e4)]).then((function(){t._allManifestsLoaded.resolve();t.manifestLoadComplete=!0}))},n.prototype.startRpc=function(
){var n=this;this._isRpcStarted||(this._isRpcStarted=!0,v.start({originId:"fx",loadChannelFunction:function(t){var i=n._getExtensionByWindowId(t);if(!i)throw new Error("Failed to load extension '{0}'.".format(t));return i.getOrLoadWindow().getChannel()}}))},n.prototype.unloadExtension=function(n){n.dispose()},n.prototype.on=function(n,t){var u=this,f,i,r;return this._callbacksMap.has(n)||(f=void 0,f=g.relex.cachedManifestTypes[n]?p.getManifests(n).then((function(t){nt({source:"ExtensionManager",action:"CachedManifestTypeCount",actionModifier:n,data:b(t)});var i=u.getExtensions().map((function(i){var e=i.isTestExtension||i.isTestStamp?null:t[i.name],r=e&&e.manifest,f;if(r)i.setManifest(n,r),u._callbacksMap.get(n).callbacks.fire(r);else return i.loadAsync(),f=i.getManifestAsync(),f.then((function(t){u._callbacksMap.get(n).callbacks.fire(t)})),f.timeout(2e3)})).filter((function(n){return!!n}));return Q.allSettled(i)})):this._allManifestsLoaded.promise,this._callbacksMap.set(n,{initialPromise:f,callbacks:
new l.Callbacks})),i=this._callbacksMap.get(n),t&&(r=function(n){try{t(n)||i.callbacks.remove(r)}catch(u){c.error(u,11)}},i.callbacks.add(r),this.getExtensions().forEach((function(t){var i=t.getManifest(n);i&&r(i)}))),i.initialPromise},n.prototype.onLoad=function(n){var i=this,r=this.initializedExtensions.slice(0),t=function(r){try{n(r)||i._callbacks.remove(t)}catch(u){c.error("onLoad event callback has thrown an exception.",2,u)}};this._callbacks.add(t);r.forEach((function(t){n(t)}))},n.prototype.onUnload=function(n){var i=this,t=function(r){try{n(r)||i._unloadCallbacks.remove(t)}catch(u){c.error("onUnload event callback has thrown an exception.",3,u)}};this._unloadCallbacks.add(t)},n.prototype.refreshManifests=function(n){return p.getManifestsAjax(n)},n.prototype.dispose=function(){this._lifetimeManager.dispose();this._messageHandlers&&(this._messageHandlers.forEach((function(n){y.removeEventListener("message",n)})),this._messageHandlers=[])},n.prototype._getExtensionByWindowId=function(n)
{var t=this._extensionsMap;return t&&t[n.toLowerCase()]},n.prototype._getExtensionByDescriptor=function(n){return this._getExtensionByWindowId(a.getWindowId(n))},n.prototype._getLoadedExtensionByWindowId=function(n){return this.initializedExtensions.first((function(t){return t.extension.getWindowId()===n}))},n.prototype._getExtensionByWindow=function(n){return this.getExtensions().first((function(t){var i=t.getWindow();return!!i&&i.getValue()===n}))},n.prototype.getExtensions=function(){var n=this;return u.keys(this._extensionsMap||{}).map((function(t){return n._extensionsMap[t]}))},n.prototype._addExtensionBootReceiver=function(){var n=this,t=function(t){var i=n._getExtensionByWindow(t.source),r=t.data&&t.data.data||t.data||{},o=r.signature||t.data.signature,u,f,e;if(o===et){if(!i){u=n.getExtensions().map((function(n){return n.name}));f=y.location.origin;c.error("Received a boot message from '"+t.origin+"' which is not associated to an extension("+u+"). ShellOrigin: ("+f+")",9,JSON.stringify(
r));return}if(e=i.processBootMessage(r),!e){var s="{0} Origin: {1}".format(JSON.stringify(t.data),t.origin),h=i&&"/"+i.getWindowId(),l=ut+h;ot(l,s,10);i.noteScriptError({kind:2,error:t.data||t.data.data});return}}};y.addEventListener("message",t,!1);this._messageHandlers.push(t)},n.prototype.getMessageTelemetry=function(n){var i=this._m;return n&&i?{sent:t({startOffBy:n.sent.startOffBy,stopOffBy:i.sent.startOffBy},n.sent,i.sent),recv:t({},n.recv,i.recv)}:i},n})();n.ExtensionManagerImpl=s})(tt=t.Internal||(t.Internal={}))}));define("MsPortalImpl.Controls/Controls/ResourceFilterHelper",["require","exports","f","i","ko","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f){"use strict";function a(n){e.getOrSet(n.cloudName,[]).push(n)}function y(n){if(n){var t=e.get(n.cloudName),i=t&&t.first((function(t){return t.id===n.id}));i&&t.remove(i);t.length?e.set(n.cloudName,t):e.set(n.cloudName,[])}}function p(){return t.Internal.assetTypeService.assetTypes().forEach((function(n){a(n)})),e}function w(n,i){t.Internal.
assetTypeService=n;n.assetTypes.subscribeArrayChanges(h,(function(n){a(n)}),(function(n){y(n)}));i.registerForDispose(h)}function b(n,t){var f=[],r,h;return t&&t.length?(r=u.observable(),f=t.map((function(n){return{name:n.compositeDisplayName.plural,key:n.resourceType.toLowerCase(),keywords:n.keywords}})),r(i.stableSort(f,(function(n,t){return n.name.localeCompareIgnoreCase(t.name)}))),r):(r=c.get(n),r||(r=u.observable(),c.set(n,r),h=e.get(n)?e:p(),f=(h.get(n)||[]).filter((function(n){var i=n.assetTypeManifest.browseType,t=n.assetTypeManifest.resourceType,r=(i===1||i===4)&&!n.assetTypeManifest.privateBrowse&&n.lowerCaseResourceType!==s.Constants.ResourceTypes.ResourceGroups.toLowerCase();return r&&!(t&&(t.routingType===o.Tenant||t.routingType===o.ProviderProxy||t.routingType===o.Extension))})).map((function(n){return{name:n.compositeDisplayName.plural,key:n.lowerCaseResourceType,keywords:n.assetTypeManifest.keywords&&n.assetTypeManifest.keywords.split(",")}})),r(i.stableSort(f,(function(n,t){return n.
name.localeCompareIgnoreCase(t.name)})))),r)}function k(n){var t=l.get(n),u;return t?Q.resolve(t):(u=[],Q(f.Location.locationEndpoint.invoke(r.Rpc.client,s.Constants.ExtensionNames.Hubs,{cloudName:n,onlyAllowedRegions:!0})).then((function(r){return i.forEachKey(r,(function(n,t){u.push({displayName:t,name:n})})),t=i.stableSort(u,(function(n,t){return n.displayName.localeCompareIgnoreCase(t.displayName)})),l.set(n,t),Q.resolve(t)})))}var s=i.Base,v=r.TriggerableLifetimeManager,o=i.Extension.ResourceRoutingType,h=new v;t.Internal={};var e=r.getCloudMap(),c=r.getCloudMap(),l=r.getCloudMap();t.initialize=w;t.getResourceTypes=b;t.getLocations=k}));define("MsPortalImpl/Services/Services.SelectedSubscriptions",["require","exports","f","i","a","ko","FxHubs/HubsSettingsSchema","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){function g(){h=r.getCloudMap();t=r.getCloudMap()}function nt(t){var i=(t||[]).map((function(n){return n.
subscriptionId})).join(";");n.userSettingsManager.setSetting(d,w,i)}function lt(n,t){var r=(n.state||"").toLowerCase(),u=(t.state||"").toLowerCase(),i;if(r!==u){if(r===b)return 1;if(u===b)return-1}return i=n.displayName.localeCompareIgnoreCase(t.displayName),i===0&&(i=n.subscriptionId.localeCompareIgnoreCase(t.subscriptionId)),i}function c(n,t){var u=n||[],r=[],f;return t&&t.length&&(f=i.convertArrayToMap(t,(function(n){return n})),r=u.filter((function(n){return!!f[n.subscriptionId]}))),(r.length?r:u).stableSort(lt)}function at(t){g();n.userSettingsManager=t;rt.getSelectedSubscriptionsEndPoint.register(u.client,null,(function(n,t){return t.srcWindowId!==v.Shell&&t.srcWindowId!==y.getHubsWindowId()&&(n=y.getDescriptor(t.srcWindowId).cloudName),tt(n)}));n.selectedSubsUpdateTriggered.subscribe(ct,(function(n){et.pingSelectedSubscriptionsListEndPoint.invoke(u.client,ht,n)}))}function tt(i){var r=h.get(i),f;return r?Q(r):(t.get(i)||(f=Q(l.getAllSubscriptions(u.client,i)).then((function(t){return n.userSettingsManager.
querySetting(d,w).then((function(r){var e=(r||"").split(";"),u=c(t,e),f;return u.length>n.selectedSubscriptionsCap&&(u=u.slice(0,n.selectedSubscriptionsCap),nt(u),f=t.length,ot.publish({status:st.Information,title:k.cappedTitleFmt.format(n.selectedSubscriptionsCap,f),description:k.cappedFmt.format(n.selectedSubscriptionsCap,f),uri:"#menu/settings"})),h.set(i,u),u}))})),t.set(i,f.catch((function(n){return t.set(i,null),Q.reject(n)})))),t.get(i))}function vt(t,i){return l.getAllSubscriptions(u.client,i).then((function(r){var u=c(r,t);h.set(i,u);n.selectedSubsUpdateTriggered({cloudName:i,selectedSubscriptions:u});nt(u.length===r.length?[]:u)}))}var l=r.Azure,it=e.Keys,a=r,rt=a.Azure,ut=i.Base,v=ut.Constants,u=r.Rpc,ft=a.TriggerableLifetimeManager,et=o.SelectedSubscriptions,y=r.Extension,p=i.Hubs.Notifications,ot=p.ClientNotification,st=p.NotificationStatus,w=it.subscriptionsSelected,b="disabled",ht=v.ExtensionNames.Hubs;n.selectedSubscriptionsCap=60;var k=s.SubscriptionsNotification,d=6,ct=new ft,
t,h;n.selectedSubsUpdateTriggered=f.observable();n.resetState=g;n.getValidSelectedSubscriptions=c;n.init=at;n.getSelectedSubscriptions=tt;n.setSelectedSubscriptions=vt})(h||(h={})),h}));define("_generated/Less/MsPortalImpl.Controls/Controls/SimpleButton.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxc-simplebutton{display:inline-block;-webkit-user-select:none;min-width:80px;text-align:center;line-height:22px;position:relative}.fxs-button-icon{display:inline-block;height:12px;width:12px}.fxs-button-icon-left{margin-right:5px}.fxs-button-icon-right{margin-left:5px}.fxs-button-spinner{height:10px;width:10px;display:inline-block;position:absolute;right:8px}.fxs-button-text-hide{display:none}")}));define("MsPortalImpl.Controls/Controls/SimpleButton",["require","exports","f","o","ko","$","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Resources/ImplScriptResources","./Base/OptionsBase","../../_generated/Less/MsPortalImpl.Controls/Controls/SimpleButton.css"],
(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){var h=i.ViewModels.Controls.SimpleButton.ViewModel,c=jQuery,l=i.disposeDisposable,t="fxc-simplebutton",f="fxs-button-text",a="<span>"+o.Button.validating+"<\/span><div class='fxs-button-spinner' data-bind='image: MsPortalFx.Base.Images.Loading.Spinner()'><\/div>",v='<div class=\'fxs-button fxt-button\' role=\'button\' data-bind=\'visible: data.visible, css: { "fxs-button-disabled": $disabled, "fxs-portal-button-primary": data.primary, "fxs-button-default": !ko.unwrap(data.primary), "fxs-inner-dotted-border": !ko.unwrap($disabled) }, attr: { tabindex: $tabIndex, "aria-disabled": $disabled, title: data.text }\'><!-- ko if: data.icon() && data.icon().position === 0 --><div class=\'fxs-button-icon fxs-button-icon-left\' data-bind=\'image: MsPortalFx.Base.Images.CustomImageWithOptions(data.icon().image, {customClass: "fxs-escapeShadow"})\'><\/div><!-- /ko -->'+("<span class="+f+" data-bind='text: data.text'><\/span>")+"<!-- ko if: data.icon() && data.icon().position === 1 --><div class='fxs-button-icon fxs-button-icon-right' data-bind='image: MsPortalFx.Base.Images.CustomImageWithOptions(data.icon().image, {customClass: \"fxs-escapeShadow\"})'><\/div><!-- /ko --><!-- ko if: data.loading -->"+
("<div class=fxs-button-validating>"+a+"<\/div>")+"<!-- /ko --><\/div>",y=(function(n){function i(i,r,u){n.call(this,i,r,c.extend({viewModelType:h},u));this._events=[];this.element.addClass(t).html(v);var e=this.element.findByClassName("fxs-button");this.options.ariaLabel.subscribeAndRun(this.ltm,(function(n){e.attr("aria-label",n?n:null)}));this.options.loading.subscribeAndRun(this.ltm,(function(n){e.findByClassName(f).toggleClass("fxs-button-text-hide",n)}));this._attachEvents();this._bindDescendants()}return __extends(i,n),r.defineProperty(i.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._detachEvents(),this._cleanElement(t),n.prototype.dispose.call(this))},i.prototype._attachEvents=function(){var n=this,t,i;this._detachEvents();t=function(n){return u.isObservable(n)?n():n};i=function(i){i.stopPropagation();i.preventDefault();!t(n.$disabled)&&n.options.
onClick&&t(n.options.onClick)()};this._events.push(this.element.setEvents([e.default.click,i],[e.default.keypress,function(n){(n.keyCode===13||n.keyCode===32)&&i(n)}]))},i.prototype._detachEvents=function(){l(this._events);this._events=[]},i})(s.Widget);n.Widget=y})(h||(h={})),h}));define("MsPortalImpl/Services/Services.Settings",["require","exports","f","i","o","ko","FxHubs/HubsSettingsSchema","./Services.Settings.Schema","MsPortalImpl/Resources/ImplScriptResources","./Services.Storage"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function nt(n){return function(t){this[t]=n}}function lt(){var n={};return o.generalSettingsKeys.forEach(nt(!0),n),n}function kt(){return i.map(v,i.identity)}function dt(n){return y[n+1e3]}function gt(n){return v[n]}function ni(n){var t={manager:new k.InMemorySettingsManagerImpl,stores:[8,9,13,]};return k.createUserSettingsManager(new k.UserSettingsManagerImpl(n),[t])}function ti(n,t){if(!t||!t.length)return Q({});var i=t.map(n.queryStore,n);return Q.all(i).then(
(function(n){var i={};return n.forEach((function(n,r){i[t[r]]=n})),i}))}var l=i.Base,st=l.Constants,ht=l.Diagnostics,p=i.Hubs.Notifications.NotificationStatus,g=l.Net2,ct=i.tryImmediateResolve,at=window,tt=at.fx,c=s.Services.Settings,d=tt.environment,it=i.isFeatureEnabled,vt=it("inmemorysettings"),w=d.version,rt=l.getVersionFromString(w),b=d.settingsBaseUri+"{0}"+d.settingsUriQuery,ut=b.format("/Update"),ft=b.format("/Select"),yt=b.format("/Clear"),pt=b.format("/ClearAll"),a=ht.createLog(n),et=o.settingsVersionSettingKey,wt=lt(),ot=tt.early,bt=ot&&ot.preloadSettings,v,y,k;rt.revision=0;v={General:0,Blade:1,Part:2,LensState:3,Startboard:4,SharedPart:5,HubsExtension:6,CrossTenant:7,JourneySession:8,EditScopeSession:9,Favorites:10,DashboardInventory:11,FileUpload:12};y=[];i.forEachKey(v,(function(n,t){y[t]=n})),(function(){for(var t,i,n=0;n<100;n++)t="Dashboard"+n,i=n+1e3,v[t]=i,y[i]=t})();t.getAllStoreIds=kt;t.getDashboardStoreName=dt;t.getDashboardStoreId=gt;t.createUserSettingsManager=ni;t.queryStores=
ti,(function(n){function ti(n,t,i){return new tt(new d(new b(k.createWithWriteDeleteBufferTimeout(n,i),t)))}function s(n){var t=y[n];if(!t)throw new Error("Invalid store: "+n);return t}function ht(n,t){var r={},u;return i.forEachKey(t||{},(function(t,i){var f=s(t);r[f]=i;n&&delete n[f];u=r})),u}function lt(n){var i={},t;return n.keys.forEach(nt(null),i),t={},t[n.store]=i,t}function ii(n,t){var u=i.merge(n,t),r={settingsToSet:{},settingsToDelete:{}};return r=u.reduce((function(n,t){return v(n.settingsToSet,n.settingsToDelete,t.settingsToSet),v(n.settingsToDelete,n.settingsToSet,t.settingsToDelete),n}),r),[r]}function v(n,t,r){r&&i.forEachKey(r,(function(u){var f=parseInt(u),o=r[f],e;n&&(n[f]||(n[f]={}),at(o,n[f]));t&&(e=t[f],e&&(kt(o,e),i.isEmpty(e)&&delete t[f]))}))}function at(n,t){i.forEachKey(n,(function(n,i){t[n]=i}))}function kt(n,t){i.forEachKey(n,(function(n){delete t[n]}))}function dt(n,t,i){var r={};return r[t]=i,{store:n,settings:r}}function ot(n){return JSON.parse(JSON.stringify(n))}var
e,o,t,gt,b,ni,k,d,tt;n.createUserSettingsManager=ti;n.getSettingStoreName=s;n.convertSettingQueryToDictionary=lt;n.updateDictionary=v;n.updateSettingsDictionary=at;n.sanitizeSettingsDictionary=kt;e=(function(){function n(){this._eventsTriggered=f.observableArray()}return u.defineProperty(n.prototype,"eventsTriggered",{get:function(){return this._eventsTriggered},enumerable:!0,configurable:!0}),n.prototype._fireEvent=function(n,t,i){var r={status:i,title:n,description:t,timestamp:new Date,cloudName:st.DefaultCloudName};this.eventsTriggered.push(r)},n.prototype._fireError=function(n){this._fireEvent(c.useInMemorySettings,n||c.settingsCallFailed,p.Error)},n})();n.SettingsManagerVeryBase=e;t=(function(n){function t(t){n.call(this);o?this._baseManager=t||o:(this._baseManager=undefined,this._eventsTriggered=undefined)}return __extends(t,n),u.defineProperty(t.prototype,"eventsTriggered",{get:function(){var n=this._baseManager;return n&&n.eventsTriggered||this._eventsTriggered},enumerable:!0,configurable:
!0}),t.prototype.flushSettings=function(){var n=this._baseManager;return Q(n&&n.flushSettings())},t.prototype.dispose=function(){this._baseManager&&(this._baseManager.dispose(),this._baseManager=null)},t.prototype.setSettings=function(n){var t=this._baseManager;t&&t.setSettings(n)},t.prototype.deleteSettings=function(n,t){var i=this._baseManager;i&&i.deleteSettings(n,t)},t.prototype.queryStore=function(n){var t=this._baseManager;return Q(t&&t.queryStore(n))},t.prototype.clearSettings=function(){var n=this._baseManager;return Q(n&&n.clearSettings())},t})(e);n.SettingsManagerBase=t;o=new t;gt=(function(n){function t(){n.apply(this,arguments);this._maps={}}return __extends(t,n),t.prototype.setSettings=function(n){var t=n.settings,r;t&&(r=this._getMap(n.store),i.forEachKey(t,(function(n,t){r.set(n,JSON.stringify(t))})))},t.prototype.queryStore=function(n){var i=this._getMap(n),t={};return i.forEach((function(n,i){t[i]=JSON.parse(n)})),Q(t)},t.prototype.deleteSettings=function(n){if(n.keys){var t=
this._getMap(n.store);n.keys.forEach((function(n){t.delete(n)}))}},t.prototype.clearSettings=function(){return Q(this._maps={})},t.prototype._getMap=function(n){return this._maps[n]=this._maps[n]||new i.Map},t})(t);n.InMemorySettingsManagerImpl=gt;b=(function(n){function t(t,i){n.call(this,t);this._initialize(i)}return __extends(t,n),t.prototype.queryStore=function(n){return this._getManager(n).queryStore(n)},t.prototype.deleteSettings=function(n){this._getManager(n.store).deleteSettings(n)},t.prototype.setSettings=function(n,t){this._getManager(n.store).setSettings(n,t)},t.prototype.clearSettings=function(){return Q.all(this._managers.map((function(n){return n.clearSettings()})))},t.prototype._initialize=function(n){var t=this;this._managersDictionary={};this._managers=[this._baseManager];n&&n.forEach((function(n){t._managers.push(n.manager);n.stores.forEach((function(i){t._managersDictionary[i]=n.manager}))}))},t.prototype._getManager=function(n){return this._managersDictionary[n]||this._baseManager}
,t})(t);n.RoutingSettingsManager=b;ni=(function(n){function t(t,r){var u=this,f;r===void 0&&(r=bt);n.call(this);this._ajaxState=0;this._memoizedQueryStore=i.memoizeQ((function(n){var t=i.startTimer();return u._ajax(ft,[n]).then((function(i){u._setAjaxState(1);var f=i&&i.content&&i.content[n]||{},r=t();return r>5e3&&a.warning("Request to store '"+n+"' took more than 5s to complete.\n                                                    Request time: "+r+"ms.\n                                                    Response size: "+(i&&i.jqXHR&&i.jqXHR.responseText.length)),f})).catch((function(n){return u._setAjaxState(2,n,"queryStore(duration:"+t()+")"),u._fireEvent(c.useInMemorySettings,c.querySettingsCallFailed,p.Error),Q({})}))}));this._storageService=t;r&&(f={},i.forEachKey(r,(function(n,t){f[n]=i.tryImmediateResolve(Q(t),(function(n){return u._setAjaxState(1),n}),(function(t){return i.Helpers.isXMLHttpRequestLike(t)&&g.isRetryable(t)||a.error(new i.Errors.Error({message:"Early Failed to preload store '"+
n+"'.",innerErrors:t}),1),u._memoizedQueryStore(n)}))})),this._preloadStores=f)}return __extends(t,n),t.prototype._ajax=function(n,t){var u=this;return!t&&(n===ut||n===ft)?Q.reject(r.createError("Invalid setting ajax call uri: "+n+", data: "+i.getObjectDescriptor(t))):Q(g.ajaxExtended({uri:n,headers:{"x-ms-user-settings-session":this._storageService.getValue(h.ComponentName.UserSettingsService,"x-ms-user-settings-session",1)||""},type:"POST",dataType:"json",data:t&&JSON.stringify(t),contentType:"application/json;charset=utf-8",performRetry:!0})).then((function(n){return u._storageService.setValue(h.ComponentName.UserSettingsService,"x-ms-user-settings-session",n.jqXHR.getResponseHeader("x-ms-user-settings-session"),1),n})).catchError(i.Errors.AjaxError,(function(r){return r.jqXHR.status===400&&a.error("Setting _ajax 400 occured. uri: "+n+", data: "+i.getObjectDescriptor(t,!0)+"."),Q.reject(r)}))},t.prototype._setAjaxState=function(n,t,r){n>this._ajaxState&&(this._ajaxState=n,n===2&&a.error(new
i.Errors.Error({message:r+" Setting is transitioned into HasFailRequests state. All further querystore/updatesetting will be in-memory mode.",innerErrors:t})))},t.prototype.queryStore=function(n){var i=s(n),t,r;return this._ajaxState>=2?Q({}):(t=this._preloadStores,r=t&&t[i],r||this._memoizedQueryStore(i))},t.prototype.clearSettings=function(){var t=this,n=this._preloadStores,r;return n&&u.keys(n).forEach((function(t){delete n[t]})),this._memoizedQueryStore.clear(),r=i.startTimer(),this._ajax(it("clearallusersettings")?pt:yt).catch((function(n){t._setAjaxState(2,n,"clearSetting(duration:"+r()+"):");t._fireError(c.clearSettingsCallFailed)}))},t.prototype.updateSettings=function(n){var f=this,r,t,u;return this._ajaxState===1&&(r=this._preloadStores,t={save:ht(r,n.settingsToSet),remove:ht(r,n.settingsToDelete)},t.save||t.remove)?(u=i.startTimer(),this._ajax(ut,t).catch((function(n){return f._setAjaxState(2,n,"updateSettings(duration:"+u()+"):"),Q.reject(n)}))):Q()},t})(e);n.UserSettingsManagerImpl=
ni;k=(function(n){function t(t,i,r,u){var f=this;n.call(this,null);this._primitiveSettingsManager=t;this._sequencer=i(ii,(function(n){return f._executeMethod(n[0])}),r,!0,{optionalDataInterval:u})}return __extends(t,n),t.createWithWriteDeleteBufferTimeout=function(n,i,r){var u=i!==undefined?i:5e3,f=r!==undefined?r:3e5;return new t(n,function(n,t,i,r,u){return new l.Debouncer(n,t,i,r,u)},u,f)},t.prototype.queryStore=function(n){return this._primitiveSettingsManager.queryStore(n)},t.prototype.setSettings=function(n,t){if(!i.isEmpty(n.settings)){var r={};r[n.store]=n.settings;this._sequencer.execute([{settingsToSet:r,settingsToDelete:{}}],t===1)}},t.prototype.deleteSettings=function(n,t){n.keys&&n.keys.length&&this._sequencer.execute([{settingsToDelete:lt(n),settingsToSet:{}}],t===1)},u.defineProperty(t.prototype,"eventsTriggered",{get:function(){return this._primitiveSettingsManager.eventsTriggered},enumerable:!0,configurable:!0}),t.prototype.flushSettings=function(){return this._sequencer.
flush()},t.prototype.clearSettings=function(){var t=this,n=Q.defer();return this.flushSettings().finally((function(){t._primitiveSettingsManager.clearSettings().finally((function(){n.resolve()}))})),n.promise},t.prototype.dispose=function(){this.flushSettings();n.prototype.dispose.call(this)},t.prototype._executeMethod=function(n){return this._primitiveSettingsManager.updateSettings(n)},t})(t);n.SequencingSettingsManager=k;d=(function(n){function t(t){var r=this;n.call(this,t);this._cache={};this._activeUpdatePromises=new i.Map;this._isSettingsVersionChecked=!1;this._isSettingsVersionVerified=!1;this._uniqueId=1;this._memoizedQueryPromises=i.memoizeQ((function(n){return i.tryImmediateResolve(i.tryImmediateResolve(r._canCallBaseManager(),(function(t){return t?r._baseManager.queryStore(n):{}})),(function(t){return r._updateCaches(n,t)}))}))}return __extends(t,n),t.prototype.queryStore=function(n){return this._memoizedQueryPromises(n)},t.prototype.setSettings=function(n,t,i){this._execute(this._setSettingsInternal,
n,t,i)},t.prototype._setSettingsInternal=function(n,t,i,r){var f=this,e=this._writeSettingsToCache(n,!0),u=function(){f._baseManager.setSettings(e,t)};r?(u(),this._resolveSetPromise(i)):this._executeIfBaseManagerCallIsAllowed(u,i)},t.prototype._resolveSetPromise=function(n){var t=this._activeUpdatePromises.get(n);t&&(t.resolve(),this._activeUpdatePromises.delete(n))},t.prototype._execute=function(n,t,i,r){var o=this,e=this._uniqueId++,u,f;this._activeUpdatePromises.set(e,Q.defer());t&&(u=t.store,f=function(){n.call(o,t,i,e,r)},this._cache[u]?f():ct(this.queryStore(u),f))},t.prototype.deleteSettings=function(n,t){this._execute(this._deleteSettingsInternal,n,t)},t.prototype._deleteSettingsInternal=function(n,t,i){var r=this;this._deleteSettingsFromCache(n);this._executeIfBaseManagerCallIsAllowed((function(){r._baseManager.deleteSettings(n,t)}),i)},t.prototype.clearSettings=function(){var n=this,t=Q.defer();return this.flushSettings().finally((function(){return Q(n._baseManager.clearSettings(
)).finally((function(){n._cache={};n._memoizedQueryPromises.clear();t.resolve()}))})),t.promise},t.prototype.flushSettings=function(){var t=this,n=[];return this._activeUpdatePromises.forEach((function(t){return n.push(t)})),Q.all(n).then((function(){return t._baseManager.flushSettings()}))},t.prototype._updateCaches=function(n,t){return this._writeSettingsToCache({store:n,settings:t}),this._cache[n]},t.prototype._canCallBaseManager=function(){return this._isSettingsVersionChecked?Q(this._isSettingsVersionVerified):(this._settingsVerificationPromise||(this._settingsVerificationPromise=this._verifySettings()),this._settingsVerificationPromise)},t.prototype._verifySettings=function(){var n=this,t=0,r=this._baseManager===o;return vt||r?(this._fireEvent(c.useInMemorySettings,r?c.noBaseManager:c.inMemorySettingsMode,p.Warning),this._isSettingsVersionVerified=!1,this._isSettingsVersionChecked=!0,Q(!1)):i.tryImmediateResolve(Q(this._baseManager.queryStore(t)),(function(i){var r=i[et],u;return r?(u=l.
getVersionFromString(r),u.revision=0,n._isSettingsVersionVerified=rt.compareTo(u)>=0):n._isSettingsVersionVerified=!0,n._isSettingsVersionChecked=!0,n._isSettingsVersionVerified?(n._updateCaches(t,i),n.setSettings(dt(t,et,w),0,!0),n._processGeneralSettings(i),!0):(n._fireEvent(c.useInMemorySettings,c.portalVersionMismatch.format(r,w),p.Warning),a.error("Current version '"+w+"' does not match with the version '"+r+"' saved in user settings",3),!1)}))},t.prototype._executeIfBaseManagerCallIsAllowed=function(n,t){if(!this._isSettingsVersionChecked)throw new Error("_canCallBaseManagerSync has been called before completing async verification.");this._isSettingsVersionVerified&&n();this._resolveSetPromise(t)},t.prototype._deleteSettingsFromCache=function(n){var t=this._cache[n.store];n.keys&&t&&n.keys.forEach((function(n){delete t[n]}))},t.prototype._writeSettingsToCache=function(n,t){if(n){var r=this._cache[n.store]||(this._cache[n.store]={}),u={};return n.settings&&i.forEachKey(n.settings,(function(
n,i){t&&(r[n]===i||JSON.stringify(r[n])===JSON.stringify(i))||(r[n]=u[n]=i)})),{store:n.store,settings:u}}return null},t.prototype._processGeneralSettings=function(n){if(n){var t=u.keys(n).filter((function(n){return!wt[n]}));t.length&&this.deleteSettings({store:0,keys:t})}},t})(t);n.CachingSettingsManagerImpl=d;tt=(function(n){function t(t){n.call(this,t)}return __extends(t,n),t.prototype.queryStore=function(n,t){return i.tryImmediateResolve(this._baseManager.queryStore(n),(function(n){return t?n:ot(n)}))},t.prototype.querySettings=function(n){return n.keys&&n.keys.length>0?this.queryStore(n.store,!0).then((function(t){var i={},r;return t&&(r=n.keys.filter((function(n){return n in t})),r.forEach((function(n){i[n]=t[n]}))),ot(i)})):this.queryStore(n.store)},t.prototype.querySetting=function(n,t){return this.querySettings({store:n,keys:[t]}).then((function(n){if(n){var i=n[t];return i===undefined?null:i}return null}))},t.prototype.setSettings=function(n,t){this._baseManager.setSettings(ot(n),t)},t.prototype.
setSetting=function(n,t,i,r){this.setSettings(dt(n,t,i),r)},t})(t);n.ExtendedSettingsManager=tt})(k=t.Internal||(t.Internal={}))}));define("MsPortalImpl/Base/Base.KnockoutExtensions",["require","exports","ko","$","./Base.EventTypes"],(function(n,t,i,r,u){"use strict";var f;return (function(){i.bindingHandlers.commands={update:function(n,t){var e=r(n),f=t(),o,s;if(f&&f.group){e.on(u.default.fxcontextmenurequest,o=function(n){var o,t;o=i.unwrap(f.viewModel);t=r.Event(u.default.fxrightclick);t.clientX=n.clientX;t.clientY=n.clientY;e.trigger(t,{commandGroup:f.group,viewModel:o,entityType:2});n.preventDefault();n.stopPropagation()});i.utils.domNodeDisposal.addDisposeCallback(n,s=function(){e.off(u.default.fxcontextmenurequest,o)})}}}})(f||(f={})),f}));define("MsPortalImpl/Controls/ControlBindings.Async",["require","exports","ko","../Widgets/Widgets.Common"],(function(n,t,i,r){"use strict";var u;return (function(n){function o(n,t,i,r){e.push({name:t,moduleId:n+i,initOptions:r})}function t(n,t,i){o("MsPortalImpl.Controls/",
n,t,i)}function u(n,t,i){o("MsPortalImpl/Controls/",n,t,i)}function s(t){n.portalControlBindings.forEach((function(n){i.bindingHandlers[n.name]=r.getAsyncBindingHandler(n.moduleId,n.initOptions,t)}))}var e=[],f={controlsDescendantBindings:!1};t("pcAccordion","Controls/Accordion");t("pcButton","Controls/Forms/Button",f);t("pcChart","Controls/Visualization/Chart");t("pcCheckBoxField","Fields/CheckBoxField");t("pcConsole","Controls/Console");t("pcConsoleV2","Controls/ConsoleV2");t("pcCopyableLabel","Controls/Forms/CopyableLabel");t("pcCreatorAndSelector","Fields/CreatorAndSelectorField");t("pcCreatorAndSelectorV2","Fields/CreatorAndSelectorFieldV2");t("pcCustomHtmlField","Fields/CustomHtmlField");t("pcCustomValueSlider","Fields/CustomValueSliderField");t("pcCustomRangeSlider","Fields/CustomRangeSlider");t("pcDatePickerField","Fields/DatePickerField");t("pcDateTimePickerField","Fields/DateTimePickerField");t("pcDateTimeRangePickerField","Fields/DateTimeRangePickerField");t("pcDayPickerField",
"Fields/DayPickerField");t("pcDiffEditor","Controls/Documents/DiffEditor");t("pcDockedBalloon","Controls/DockedBalloon");t("pcDonut","Controls/Visualization/Donut");t("pcDropDownField","Fields/DropDownField");t("pcDurationPickerField","Fields/DurationPickerField");t("pcEditor","Controls/Documents/Editor");t("pcFileUpload","Controls/Forms/FileUpload");t("pcFilterComboField","Fields/FilterComboField");t("pcFormSection","Fields/SectionField",f);t("pcGallery","Controls/Lists/List1/Gallery");t("pcGraph","Controls/Visualization/Graph");t("pcGrid","Controls/Lists/Grid1/Grid1");t("pcGrid2","Controls/Lists/Grid2/Controls.Grid2");t("pcEditableGrid","Controls/Lists/Grid2/Grid2e.EditableGrid.Control");t("pcHeatMap","Controls/HeatMap");t("pcIFrame","Controls/IFrame");t("pcIFrame2","Controls/IFrameV2");t("pcLegend","Controls/Visualization/Legend");t("pcListView","Controls/Lists/List1/ListView");t("pcLogStream","Controls/LogStream");t("pcMap","Controls/Visualization/Map");t("pcMediaPlayer","Controls/AzureMediaPlayer");
t("pcMenu","Controls/Lists/Menu");t("pcMetrics","Controls/Visualization/Metrics");t("pcMonitorChart","Controls/Visualization/MonitorChart/MonitorChart");t("pcMonitorChartV2","Controls/Visualization/MonitorChartV2/MonitorChartV2");t("pcMultiLineTextField","Fields/MultiLineTextField");t("pcMultiselectDropDownField","Fields/MultiselectDropDownField");t("pcNumericTextBoxField","Fields/NumericTextBoxField");t("pcOAuthButtonField","Fields/OAuthButtonField");t("pcOptionsGroupField","Fields/OptionsGroupField");t("pcPairedTimeline","Controls/Visualization/PairedTimeline");t("pcPairedTimelineBadges","Controls/Visualization/PairedTimelineBadges");t("pcPartPinner","Controls/PartPinner");t("pcPasswordField","Fields/PasswordField");t("pcPreviewTag","Controls/PreviewTag");t("pcProgressBar","Controls/Visualization/ProgressBar");t("pcQueryBuilder","Controls/Data/QueryBuilder");t("pcQuotaGauge","Controls/Visualization/QuotaGauge");t("pcRangeSliderField","Fields/RangeSliderField");t("pcSearchBox","Controls/SearchBox");
t("pcResourceFilter","Controls/ResourceFilter");t("pcSection","Fields/Section");t("pcSelectorField","Fields/SelectorField");t("pcSettings","Controls/Settings");t("pcSimpleButton","Controls/SimpleButton");t("pcSingleSetting","Controls/SingleSetting");t("pcSingleValueGauge","Controls/Visualization/SingleValueGauge");t("pcSliderField","Fields/SliderField");t("pcSpecComparisonTable","Controls/SpecComparisonTable");t("pcSplitter","Fields/Splitter",f);t("pcStringListField","Fields/StringListField");t("pcTextBlock","Controls/TextBlock");t("pcTextBox","Controls/Forms/TextBox");t("pcTextField","Fields/TextField");t("pcTimePickerField","Fields/TimePickerField");t("pcToolbar","Controls/Toolbars/Toolbar");t("pcTreeView","Controls/Lists/Tree1/TreeView");t("pcTriStateCheckBox","Fields/TriStateCheckBox");t("pcMarkdown","Controls/Markdown");t("pcVideo","Controls/Video");u("pcAsyncFileUpload","Forms/AsyncFileUpload");u("pcDeleteAssetConfirmation","Controls.DeleteAssetConfirmation");u("pcEssentials","Controls.Essentials");
u("pcFileDownloadButton","Controls.FileDownloadButton");u("pcFileUploadWidget","Forms/Controls.FileUpload");u("pcGroupDropDownField","Forms/GroupDropDown");u("pcResourceDropDown","Forms/ResourceDropDown");u("pcHeroBanner","Controls.HeroBanner");u("pcHotSpot","Controls.HotSpot",f);u("pcInfoBox","Controls.InfoBox");u("pcNotice","Controls.Notice");u("pcPicker","Controls.Picker");u("pcPickerV3","Controls.PickerV3");u("pcPill","Controls.Pill");u("pcPillCollection","Controls.PillCollection");u("pcPillList","Controls.PillList");u("pcTokenComboBox","Forms/Controls.TokenComboBox");u("pcWizard","Controls.Wizard");u("pcIntuneAppFileUpload","Forms/IntuneAppFileUpload");u("pcFileShareDropDown","Storage/FileShareDropDown");n.portalControlBindings=e;n.initialize=s})(u||(u={})),u}));define("MsPortalImpl/Services/Services.PortalIdleState",["require","exports"],(function(){"use strict";var n;return (function(n){function r(){return new t.PortalIdleStateServiceImpl(window,i)}var t,i;(function(n){var t=(function(
){function n(n,t){var i=this;this._win=n;this._defaultPollMS=t;this._state=0;this._handleId=1;this._iteration=0;this._actions=[];this._win.addEventListener("blur",this._blurFunc=function(){i._blurStartTime=new Date;i._state=1;i._processCallbacks(i._defaultPollMS)});this._win.addEventListener("focus",this._focusFunc=function(){i._blurStartTime=null;i.signalBusy()})}return n.prototype.dispose=function(){var n=this._win;return n?(this._win=null,n.removeEventListener("blur",this._blurFunc),n.removeEventListener("focus",this._focusFunc),this._state=0,!0):!1},n.prototype.addCallbacks=function(n){var t=this._handleId++;return this._actions.push({key:t,value:n}),t},n.prototype.removeCallbacks=function(n){var t=this._actions,i=t.firstIndex((function(t){return n===t.key}));return i!==-1?(t.splice(i,1),!0):!1},n.prototype.signalBusy=function(){this._state===1&&(this._state=2,this._processCallbacks(5e3))},n.prototype.signalIdle=function(){this._blurStartTime||(this._blurStartTime=new Date);this._state=
1;this._processCallbacks(0)},n.prototype._processCallbacks=function(n){var t=this,i;this._win&&(i=this._timeoutHandle,i&&this._win.clearTimeout(i),this._timeoutHandle=this._win.setTimeout((function(){t._timeoutHandle=null;try{t._processIteration()}finally{t._state!==0&&t._processCallbacks(t._defaultPollMS)}}),n))},n.prototype._processIteration=function(){var i=this,t,n;switch(this._state){case 2:this._state=0;t=function(n){n.onBusy(new Date)};break;case 1:this._state=1;t=function(n){n.onIdle(new Date,i._blurStartTime)};break;default:case 0:return}var r=function(n){var r=i._actions[n];r&&t(r.value)},u=this._actions.length,f=this._iteration%u;for(this._iteration++,n=f;n<u;n++)r(n);for(n=0;n<f;n++)r(n)},n})();n.PortalIdleStateServiceImpl=t})(t=n.Internal||(n.Internal={}));i=9e5;n.createInstance=r})(n||(n={})),n}));define("MsPortalImpl/Controls/ControlBindings",["require","exports","ko"],(function(n,t,i){"use strict";var r;return (function(){function n(n,i){t[n]=i}function f(n,t){var r=i.unwrap(n(
)),f;if(r){if(f=t[r.controlType],!f)throw new Error("Unsupported ControlType in formControl binding handler: "+r.controlType+".");return u[f]}}function e(n,t,i,r,u,e){var s=f(t,e),o;if(s)return o=$(n),o.attr("data-formelement",o.attr("data-bind")),s.init(n,t,i,r,u)}function o(n,t,i,r,u,e){if(n){var o=f(t,e);if(o)return o.update(n,t,i,r,u)}}var u=i.bindingHandlers,t={},r;n(127,"pcAccordion");n(20,"pcArtifactLinks");n(106,"pcAsyncFileUpload");n(16,"pcAttachment");n(38,"pcButton");n(63,"pcChart");n(7,"pcCheckBoxField");n(75,"pcConsole");n(90,"pcConsoleV2");n(40,"pcCopyableLabel");n(83,"pcCreatorAndSelector");n(85,"pcCreatorAndSelectorV2");n(23,"pcCustomHtmlField");n(91,"pcCustomValueSlider");n(111,"pcCustomRangeSlider");n(25,"pcDatePickerField");n(26,"pcDateTimePickerField");n(27,"pcDateTimeRangePickerField");n(92,"pcDayPickerField");n(76,"pcDeleteAssetConfirmation");n(33,"pcDiffEditor");n(32,"pcDockedBalloon");n(65,"pcDonut");n(3,"pcDropDownField");n(99,"pcDurationPickerField");n(15,"pcSection");
n(37,"pcEditor");n(120,"pcEssentials");n(82,"pcFileDownloadButton");n(28,"pcFileUpload");n(81,"pcFileUploadWidget");n(12,"pcFilterComboField");n(55,"pcGallery");n(67,"pcGraph");n(103,"pcGrid2");n(125,"pcEditableGrid");n(98,"pcGroupDropDownField");n(77,"pcHeroBanner");n(19,"pcHistory");n(84,"pcHotSpot");n(108,"pcIFrame");n(113,"pcIFrame2");n(78,"pcInfoBox");n(121,"pcIntuneAppFileUpload");n(118,"pcLegend");n(88,"pcHotSpot");n(87,"pcInfoBox");n(104,"pcList2");n(58,"pcLogStream");n(68,"pcMap");n(109,"pcMediaPlayer");n(115,"pcMenu");n(69,"pcMetrics");n(122,"pcMonitorChart");n(126,"pcMonitorChartV2");n(13,"pcMultiLineTextField");n(8,"pcMultiselectDropDownField");n(79,"pcNotice");n(10,"pcNumericTextBoxField");n(29,"pcOAuthButtonField");n(4,"pcOptionsGroupField");n(70,"pcPairedTimeline");n(94,"pcPairedTimelineBadges");n(5,"pcPasswordField");n(39,"pcCheckBox");n(42,"pcDropDown");n(43,"pcFilterCombo");n(54,"pcGrid");n(56,"pcListView");n(110,"pcMarkdown");n(45,"pcMultiLineTextBox");n(46,"pcMultiselectDropDown");
n(47,"pcNumericTextBox");n(48,"pcOptionPicker");n(49,"pcPassword");n(50,"pcRangeSlider");n(52,"pcSlider");n(53,"pcTextBox");n(57,"pcTreeView");n(112,"pcPartPinner");n(80,"pcPicker");n(128,"pcPill");n(129,"pcPillCollection");n(123,"pcPillList");n(89,"pcPreviewTag");n(71,"pcProgressBar");n(31,"pcQueryBuilder");n(72,"pcQuotaGauge");n(9,"pcRangeSliderField");n(93,"pcSearchBox");n(114,"pcResourceFilter");n(1,"pcFormSection");n(11,"pcSelectorField");n(60,"pcSettings");n(100,"pcSimpleButton");n(97,"pcChart");n(61,"pcSingleSetting");n(73,"pcSingleValueGauge");n(6,"pcSliderField");n(95,"pcSpecComparisonTable");n(21,"pcSplitter");n(17,"pcStringListField");n(124,"pcResourceDropDown");n(101,"pcTextBlock");n(2,"pcTextField");n(24,"pcTimePickerField");n(30,"pcTokenComboBox");n(62,"pcToolbar");n(105,"pcTree2");n(22,"pcTriStateCheckBox");n(116,"pcVideo");n(107,"pcWizard");n(119,"pcHeatMap");n(201,"pcFileShareDropDown");r={};[127,20,16,7,83,85,23,91,111,25,26,27,92,3,99,15,120,201,81,12,98,124,19,108,113,
110,13,8,10,29,4,5,128,129,123,89,9,1,11,6,21,17,2,112,24,30,22].forEach((function(n){return r[n]=t[n]}));u.pcControl={init:function(n,i,r,u,f){return e(n,i,r,u,f,t)},update:function(n,i,r,u,f){return o(n,i,r,u,f,t)}};u.formElement={init:function(n,t,i,u,f){return e(n,t,i,u,f,r)},update:function(n,t,i,u,f){return o(n,t,i,u,f,r)}}})(r||(r={})),r}));define("_generated/Less/MsPortalImpl/Widgets/CopyField.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-copyfield{display:none;position:absolute;width:24px;top:0;right:0}.fxs-copyfield .fxc-copyablelabel{padding:0}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox{display:none}.fxs-copyfield-container .fxs-copyfield,.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-textbox{display:block}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{padding:0;border:0;margin:0;height:auto;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button{padding:0;margin:0;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button:hover{background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button .fxc-copyablelabel-copyimage{padding:2px 6px 6px 2px}.fxs-copyfield-container .fxs-copyfield-wrapper{position:absolute;top:0;right:0;width:24px;height:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxc-copyablelabel{padding-right:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield,.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield-wrapper{width:100%}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-copybutton{margin-right:-24px}.fxs-part-resourcesummary .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{font-size:13px}")})
);define("MsPortalImpl/Base/Base.KnockoutExtensions.Copy",["require","exports","f","i","ko","./Base.EventTypes","../../_generated/Less/MsPortalImpl/Widgets/CopyField.css"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function a(n,t,r,e){var l="fxs-copyfield",a="fxs-copyfield-copied",s=$(t),o=$('<div class="'+l+'-wrapper" data-bind="stopBindings: true"><\/div>'),v=$('<div data-bind="pcCopyableLabel: $data" class="'+l+'"><\/div>'),h;v.appendTo(o);o.appendTo(s);h=new c.Forms.CopyableLabel.ViewModel(n,e);h.disabled(!0);u.reactor(n,(function(){var n=u.unwrap(r);h.value(n);s.toggleClass("fxs-copyfield-container",!i.isNullOrWhiteSpace(n))}));u.applyBindingsToDescendants(h,o[0]);n.registerForDispose([s.setEvents([f.default.fxcopybuttonclick,function(){s.addClass(a)}],[f.default.mouseleave,function(){s.removeClass(a)}]),function(){o&&(u.utils.cleanDescendantNodes(o),o.remove())}])}function e(n,t,i){function h(){e&&(e.dispose(),e=null);r&&(clearTimeout(r),r=null)}var c=$(n),e,r,s={};
s[f.default.mouseenter]=function(){r||(r=setTimeout((function(){h();a(e=new o,n,t(),i)}),l))};s[f.default.mouseleave]=h;c.on(s);u.utils.domNodeDisposal.addDisposeCallback(n,(function(){h();c.off(s)}))}var o=r.TriggerableLifetimeManager,s=i.Base,h=s.Diagnostics,c=i.ViewModels.Controls,v=h.createLog(n),l=100;t.initializeCopyBinding=e;u.bindingHandlers.copy={init:e}})(e||(e={})),e}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand",["require","exports","f","ko","MsPortalImpl/Resources/ImplScriptResources","../UI.NotificationManager"],(function(n,t,i,r,u,f){"use strict";var s=i.Azure.ResourceManager,a=i.Base,v=a.Diagnostics,y=i.Services.Gallery,h=y.Constants,o=u.Gallery.Notifications,e=v.createLog(n),c=h.GalleryParametersKey,l=i.clone,p=r.observable,w=(function(){function n(n){this.status=p();this._cloudName=n}return n.prototype.execute=function(t){var f;if("data"in t&&"options"in t){if(f=t.data,c in f.outputParameters){var i=f.outputParameters[c],r=t.options[h.GalleryOptionsKey],u=r&&
r.launchingContext||{},a=this._getGalleryItemId(r.galleryItem);if(a||(e.warning("Null GalleryItemId."),a=i.deploymentName),u=l(u,!0),u.oldCreateApi=!0,u.galleryItemId=u.galleryItemId||a,this._validateOptions(i,r,f)){var y=l(f.outputParameters[i.selectedTemplateId],!0),p=n._findPropInObject(i.selectedTemplateId,r.deploymentTemplateFileUris),w={subscriptionId:i.subscriptionId,deploymentName:i.deploymentName||r.deploymentName,resourceGroupName:i.resourceGroupName,resourceGroupLocation:i.resourceGroupLocation,resourceProviders:JSON.parse(i.resourceProviders||null),parameters:y,templateLinkUri:!i.templateJson&&p||undefined,templateJson:i.templateJson,deploymentMode:1,launchingContext:u,cloudName:this._cloudName},v=new Date;return s.Deployments.deployTemplate(w).then((function(n){if(n===void 0&&(n={}),n.deploymentStatusCode===s.DeploymentStatusCode.Success){var i=(n.deployment||{}).properties||{},t=new Date(i.timestamp&&i.timestamp.valueOf()||n.timestamp&&n.timestamp.valueOf());return t&&t.getTime(
)<=v.getTime()&&(t=new Date(v.getTime()+1)),{correlationId:i.correlationId||n.correlationId,timestamp:t}}return Q.reject()}))}return this._notify(o.createArgumentsValidationFailedMessage),Q.reject()}return this._notify(o.createOptionsNotSpecifiedMessage),e.error("Create options are not specified in the output parameters."),Q.reject()}return this._notify(o.createCommandMissingArgumentsMessage),e.error("The data or the options needed by the deployment command are not specified."),Q.reject()},n.prototype._validateOptions=function(t,i,r){var u="CsmCommand was rejected because ";if(t){if(!t.templateJson&&!t.selectedTemplateId)return e.error(u+"neither templateJson nor selectedTemplateId were specified."),!1;if(t.templateJson)try{JSON.parse(t.templateJson)}catch(f){return e.error(u+"templateJson was malformed."),!1}if(!t.subscriptionId)return e.error(u+"subscriptionId not specified."),!1;if(!t.resourceGroupName)return e.error(u+"resourceGroupName not specified."),!1;if(!t.resourceGroupLocation)
return e.error(u+"resourceGroupLocation not specified."),!1;if(i){if("subscriptionId"in i&&i.subscriptionId!==t.subscriptionId)return e.error(u+"subscriptionId was changed in the create process."),!1;if("resourceGroupName"in i&&i.resourceGroupName!==t.resourceGroupName)return e.error(u+"resourceGroupName was changed in the create process."),!1;if("resourceGroupLocation"in i&&i.resourceGroupLocation!==t.resourceGroupLocation)return e.error(u+"resourceGroupLocation was changed in the create process."),!1}}else return e.error(u+"galleryParameters not specified."),!1;if(i){if(i.deploymentTemplateFileUris){if(!t.templateJson&&!n._findPropInObject(t.selectedTemplateId,i.deploymentTemplateFileUris))return e.error(u+"templateJson wasn't defined and selectedTemplateId isn't defined in the deploymentTemplateFileUris."),!1}else return e.error(u+"deploymentTemplateFileUris not specified."),!1;if(!("deploymentName"in i))return e.error(u+"deploymentName not specified."),!1}else return e.error(u+"configurationOptions not specified."),
!1;return r?!0:(e.error(u+"create outputs not specified."),!1)},n._findPropInObject=function(n,t){n=n.toLowerCase();for(var i in t)if(t.hasOwnProperty(i)&&n===(i+"").toLowerCase())return t[i];return null},n.prototype._notify=function(n){var t={title:o.createResourceFailedLabel,description:n,status:i.Hubs.Notifications.NotificationStatus.Error};f.getNotificationManager().addClientNotification(t)},n.prototype._getGalleryItemId=function(n){var t=n&&n.id,r=(n||{}).launchingContext,i;return t=r&&r.galleryItemId||t,t&&(i=t.split("."),i.length>1&&(t="{0}.{1}".format(i[0],i[1]))),t},n.prototype._deployTemplate=function(n){var t=new Date;return s.deployTemplate(n).then((function(n){var i=n&&n.timestamp&&new Date(n.timestamp.valueOf());return i&&i.getTime()<=t.getTime()&&(i=new Date(t.getTime()+1)),{correlationId:n.correlationId,timestamp:i}}))},n})();t.CsmCommand=w}));define("MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector",["require","exports","f","i","o","ko","../Extension/Extension.Definition.Locator",
"../UI/Hubs/ViewModels/UI.Gallery.CsmCommand","../Widgets/Widgets.WidgetBase","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function d(){return c||(c=i.require("MsPortalImpl/UI/Hubs/UI.CreateManager")),c}function g(n,t){f.bindingHandlers.fxParameterCollector={init:function(){return{controlsDescendantBindings:!1}},update:function(i,r,u,e,o){var s=f.unwrap(r()),h=o.$data.cloudName||f.observable();s&&new l($(i),s,n,t,h)}}}var y=e.Locator,p=r.Extension.CloudName,w=i.Base.Constants.ExtensionNames.Hubs,b=i.Base.Diagnostics,k=b.createLog(n),a=h.Part.Provisioning,c,v=(function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t})(s.ViewModel),l;t.ViewModel=v;l=(function(n){function t(t,r,u,e,s){var h,c,l;n.call(this,t,r||new v);h=r.privatePcPrBI;h.triggerProvisioningInStartboardPart.subscribe(this.ltm,(function(n){var t;if(n){var r=h.provisioningPartExtensionName(),f=h.provisioningPartName(),e=y.forExtension(r,s.peek()).withPartType(f);r===w&&
(n=i.clone(n,!0),p.addToModel(s.peek(),n));u.addPartToStartBoard({originPartLocator:e,model:n,modelContainsSensitiveData:!0,initialSize:2});t=u.getActiveJourney();t&&h.forceDiscardJourney()&&u.forceDiscardJourney(t.id)}}));c=function(){var n=new o.CsmCommand(s.peek());h.provisioningCommand(n)};h.triggerProvisioningCommand.subscribe(this.ltm,c);h.triggerProvisioningCommand.peek()&&f.ignoreDependencies(c);h.provisioningAttempted.subscribe(this.ltm,(function(n){if(n){var t=u.getActiveJourney();t&&h.forceDiscardJourney()&&u.forceDiscardJourney(t.id)}}));l=function(n){n&&(n.galleryParameters?d().then((function(t){return t.processResourceGroupChange(e,n.galleryParameters,n.configurationOptions,n.deploymentResponse,s.peek()).then((function(){h.provisioningCompleted({succeeded:!0})}),(function(n){h.provisioningCompleted({succeeded:!1,statusUnavailable:n===a.deploymentStatusUnavailable,pollingFailed:n===a.pollingFailed,errorMessage:n})}))})):k.error("galleryParameters should be specified in the provisioningStarted object."))}
;h.provisioningStarted.subscribe(this.ltm,(function(n){l(n)}));l(h.provisioningStarted())}return __extends(t,n),t})(s.Widget);t.Widget=l;t.initialize=g}));define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding",["require","exports","f","o","a","ko","./Base.KnockoutTemplateSanitizer"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(){function s(n,t){var i=f.unwrap(n()),r=a(i,t);return function(){return r}}function a(n,t){var f;if(n&&typeof n=="object")return f={},r.getOwnPropertyNames(n).forEach((function(r){i.isSerializableProperty(r)&&(e.isAllowedCssClassName(r)?f[r]=n[r]:r&&t.push(r))})),f;var o=String(n||""),s=o.split(" "),h=u.prototype.map.call(s,(function(n){return n=String(n||""),e.isAllowedCssClassName(n)?n:(n&&t.push(n),"")}));return h.join(" ")}function v(n,t){var i=n.getAttribute("data-bind")||"None",r=l.format(String(n.tagName),i,t.join(", "));c.error(r)}var h=i.Base.Diagnostics,c=h.createLog(n),l="Sanitization error found in 'sanitizedCss' binding\nTag name: {0}; Binding attribute: \"{1}\"\nDisallowed class name(s): {2}",
o=f.bindingHandlers,t=o.css;o.sanitizedCss={init:function(n,i,r,u,f){if(t.init){var e=s(i,[]);return t.init(n,e,r,u,f)}return null},update:function(n,i,r,u,f){var e=[],o=s(i,e);return e.length&&v(n,e),t.update(n,o,r,u,f)}}})(o||(o={})),o}));define("MsPortalImpl/Base/ClaimsIdentity",["require","exports","f","i","a","../Services/Services.Storage"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function e(n){var t=Q.defer(),i=new FileReader,u="data:image/jpeg;base64,";return i.onload=function(n){for(var i=n.target.result,r="",e=new Uint8Array(i),f=0;f<e.byteLength;f++)r+=String.fromCharCode(e[f]);try{atob(r);i=u+r}catch(o){if(o.code===5)i=u+btoa(r);else{t.reject(o);return}}t.resolve(i)},i.onerror=function(){t.reject(r.createError("Error reading thumbnail photo. Error:"+i.error))},i.readAsArrayBuffer(n),t.promise}function o(n,t,i,r){var o=t,s,h;return n&&(s=f.ComponentName.Avatar,h=0,o=!r&&i.getValue(s,n,h),!o)?Q(u.ajax({uri:n,type:"GET",dataType:"binary",responseType:"arraybuffer",
isBackgroundTask:!0,performRetry:!0,setAuthorizationHeader:{resourceName:"graph"}})).then((function(n){return e(n)})).catch((function(n){var i=n.jqXHR&&n.jqXHR.status;return i===404||i===403?t:Q.reject(n)})).then((function(t){return i.setValue(s,n,t,h),t})):Q(o)}var t=i.Base,u=t.Net2;n.getAvatarImage=o})(e||(e={})),e}));define("MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(t){function v(n){return h.test(n)}var e=i.Base,u=e.Diagnostics.createLog(n),o=/^[a-zA-Z][\w]*$/,s=i.isFeatureEnabled,h,f,c,l,a;t.canModifyExtensions=s("canmodifyextensions");h=/^(https?:)?\/\/localhost(\:\d+)?(\/|$)/;f=function(n,t){return(n&&n.toLowerCase())===(t&&t.toLowerCase())};t.isLocalhostUri=v;t.canAddGalleryPackages=s("canaddgallerypackages");c=(function(){function n(){}return n.prototype.isValid=function(){if(typeof this.name!="string")return u.error("Invalid extension name",1,this),!1;if(typeof this.uri!="string"||!this.
uri)return u.error("Invalid extension uri",1,this),!1;if(!o.test(this.name))return u.error("Invalid extension name '{0}'. Expected pattern '{1}'".format(this.name,o),8),!1;return!0},n.prototype.isEqual=function(n){var t=n;return r.Extension.isEqualDescriptor(this,t)},n.prototype.updateWith=function(n){var t=n;this.name=t.name;this.uri=t.uri;this.obsoleteBundlesBitmask=t.obsoleteBundlesBitmask;this.features=t.features;this.trustedHost=t.trustedHost;this.startBoardParts=t.startBoardParts;this.isTestExtension=t.isTestExtension},n.prototype.markAsTestExtension=function(){this.isTestExtension=!0},n.prototype.logUsageWarning=function(){u.warning("Extension '{0}' is running untrusted code from '{1}'".format(this.name,this.uri),7,this)},n.prototype.normalizeCloudName=function(){r.Extension.multiCloudEnabled&&(this.cloudName=this.cloudName||e.Constants.DefaultCloudName);this.trustedHost=this.trustedHost||"*"},n.create=function(t){var r=i.extend(new n,t);return r.normalizeCloudName(),r},n})();t.ExtensionMetadataExt=
c;l=(function(){function n(){}return n.prototype.isValid=function(){return!0},n.prototype.isEqual=function(n){var t=n||{uri:""};return f(this.uri||"",t.uri)},n.prototype.updateWith=function(n){var t=n;this.uri=t.uri},n.prototype.logUsageWarning=function(){u.warning("Untrusted gallery package '{0}' is running".format(this.uri),7,this)},n.create=function(t){var i=new n;return i.uri=t.uri,i},n})();t.GalleryPackageExt=l;a=(function(){function n(){}return n.prototype.isValid=function(){return!0},n.prototype.isEqual=function(n){var t=n;return f(this.uri,t&&t.uri)},n.prototype.updateWith=function(n){var t=n;this.uri=t.uri},n.prototype.logUsageWarning=function(){u.warning("Untrusted patch '{0}' is running".format(this.uri),7,this)},n})();t.PatchExt=a})(u||(u={})),u}));define("MsPortalImpl/Services/Services.AssetManagement",["require","exports","f","i","o","a","ko","$","../Base/Base.LruMap","../Services/Services.AssetTypes","../Services/Services.PortalIdentity","./Services.Settings.Schema"],(function(
n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function ot(n){return rt(n)||ut(n)||lt(n)}function at(n,t,i){return new w(c.getSignedInUser(),n,t,i,st.client)}function vt(n,t){return t}function yt(n,t){var i=n;return i&&f.isArray(i)?(i.reverse().forEach((function(n){var i=h.getMruItemKey({cloudName:n.cloudName,name:n.extension},n.assetType,n.resourceId||n.assetId);t.addOrUpdate(i,n)})),!0):!1}var k=r,d=k.Extension,v=i.Base,st=r.Rpc,a=i.ViewModels.Services.ResourceTypes,y=k.AssetManager,g=v.Constants.ResourceTypes,ht=v.Constants.ExtensionNames.Hubs,ct=v.Diagnostics,nt=l.assetMruListKey,tt="fulfilled",p=ct.createLog(n),it="MRU entry with no mapping view model",rt=a.isSubscriptionId,ut=a.isResourceGroupId,lt=a.isResourceId,ft=a.tryBuildResourceManagerKey,et=a.parseResourceManagerDescriptor,w,b;t.createAssetManager=at;w=(function(){function n(n,t,r,u,f,e){var c=this,s;this._assetDeletedCallbacks=o.Callbacks();this._hubsWindowId=d.getHubsWindowId();this._extensionManager=t;this._settingsService=r;this._assetTypeService=
u;this._portalIdentity=n;this._assetMruList=e;s=function(n,t,i){var f,r,e,o,s;i.reason=i.reason||"Received asset deletion notification from the extension '"+n+"'";f=c.handleAssetDeleted.bind(c);i.extensionName===ht&&(t.cloudName=i.cloudName);r=i.assetId;e=i.assetType;e===y.resourceAssetType?(o=t.cloudName,s=void 0,s=rt(r)?g.Subscriptions:ut(r)?g.ResourceGroups:a.buildResourceTypeFromResourceId(r),s&&u.mapResourceIdToAssetId(r,o).then((function(n){f({cloudName:o,name:n.extensionName},n.assetType,n.assetId,i.reason)})).catch((function(n){var t=n&&n.message||"";t.indexOf(h.failedToFindAssetTypePrefix)!==0&&p.warning(n)}))):f(t,e,r,i.reason)};f&&(y.notifyAssetDeletedDefinition.register(f,null,(function(n,t){var u=i.makeArray(n),r=t.srcWindowId,f=d.getDescriptor(r);u.forEach((function(n){s(r,f,n)}))})),y.hubsNotifyAssetDeletedDefinition.register(f,[this._hubsWindowId],(function(n,t){var r=i.makeArray(n),u=t.srcWindowId;r.forEach((function(n){s(u,{cloudName:n.cloudName,name:n.extensionName},n)}))})));this.
_notifyDeletedResources()}return n.prototype.onAssetDeleted=function(n){this._assetDeletedCallbacks.add(n)},n.prototype.markAssetDeleted=function(n,t,i,r){this.handleAssetDeleted(n,t,i,r)},n.prototype.getDiagnosticsData=function(){return{mruList:this.assetMruList.mruList.peek()}},n.prototype.handleAssetDeleted=function(n,t,i,r){this._assetDeletedCallbacks.fire(n,t,i,r)},u.defineProperty(n.prototype,"assetMruList",{get:function(){var n=this._assetMruList;if(!n){n=this._assetMruList=this._createMruList();this.onAssetDeleted((function(t,i,r){return n.removeAssetEntry(t,i,r)}))}return n},enumerable:!0,configurable:!0}),n.prototype._createMruList=function(){return new b(this._portalIdentity,this._settingsService,this._assetTypeService)},n.prototype._notifyDeletedResources=function(){var t=this,n={},i=[];this.assetMruList.mruList.peek().filter((function(n){return!ot(n.assetId)})).forEach((function(r){var f=r.assetType,e=r.extension,o=r.cloudName,u=((o||"")+":"+e+f).toLowerCase(),s;n[u]||(s=t._assetTypeService.
getAssetTypePromise(e,f,o).then((function(n){return{assetType:n,mapKey:u}})),i.push(s),n[u]=[]);n[u].push(r)}));Q.allSettled(i).then((function(i){i.forEach((function(i){var r,u;i.state===tt&&(r=i.value,r&&(u=r.assetType&&r.assetType.assetTypeManifest.resourceType,u&&!u.mappingViewModel&&n[r.mapKey].forEach((function(n){p.debug("Removing "+it);t._assetMruList.removeEntry({name:n.extension,cloudName:n.cloudName},n.assetType,n.assetId)}))))}))}))},n})();t.AssetManagerImpl=w;b=(function(){function n(n,t,r,u){var f=this;this._list=new s.LruMap(50);this._observableList=null;this._settingsService=t;this._assetTypeService=r;this._logDelay=i.isNullOrUndefined(u)?1e4:u;this._debouncer=new v.Debouncer(vt,function(n){return f._logAssetAccess(n)},this._logDelay);this.initialSettingsSyncPromise=this._startSyncSettingsFromCloud().then((function(){f.updateObservableList()}))}return n.prototype.logAssetAccess=function(n,t,i,r){var u={cloudName:n.cloudName,extension:n.name,assetType:t,assetId:i,assetName:r,timeStamp:
Date.now()};return this._logDelay?(this._debouncer.execute([u]),Q(!0)):this._logAssetAccess([u])},u.defineProperty(n.prototype,"mruList",{get:function(){var n=this._observableList;return n||(n=this._observableList=e.observableArray(),this.updateObservableList()),n},enumerable:!0,configurable:!0}),n.prototype.removeAssetEntry=function(n,t,i){var f=this,r,u=ft(i);return r=u?Q(u):Q(this._assetTypeService.mapAssetIdToResourceId({extensionName:n.name,assetType:t,assetId:i},n.cloudName).then((function(n){return et(n),n}),(function(){return null}))),r.then((function(r){f.removeEntry(n,t,r||i)}))},n.prototype.clear=function(){this._list.getList().forEach((function(n){n.removedTimeStamp=Date.now()}));this.updateObservableList();this._startSyncSettingsFromCloud()},n.prototype.removeEntry=function(n,t,i){var u=h.getMruItemKey(n,t,i),r=this._list.get(u);r&&(r.removedTimeStamp=Date.now(),this.updateObservableList(),this._startSyncSettingsFromCloud())},n.prototype.onCloudSyncFinished=function(n){this._cloudSyncCompletedCallback=
n},n.prototype._logAssetAccess=function(n){var t=this,i=[];return n.forEach((function(n){var r=ft(n.assetId);r?i.push(Q({resourceId:r,entry:n})):i.push(Q(t._assetTypeService.mapAssetIdToResourceId({extensionName:n.extension,assetType:n.assetType,assetId:n.assetId},n.cloudName).then((function(t){return et(t),{resourceId:t,entry:n}}),(function(){return{resourceId:null,entry:n}}))))})),Q.allSettled(i).then((function(n){var i=!1;n.forEach((function(n){var e,o,y,u;if(n.state===tt){var s=n.value,f=s.resourceId,r=s.entry,c=r.assetId,l=r.cloudName,a=r.extension,v=r.assetType;if(!f&&!ot(c)&&(e=t._assetTypeService.getAssetType(a,v,l),o=e&&e.assetTypeManifest.resourceType,o&&!o.mappingViewModel)){p.warning("Not adding "+it+": "+JSON.stringify(r));return}i=!0;y=h.getMruItemKey({cloudName:l,name:a},v,f||c);u=t._list.getOrAdd(y,(function(){return r}));u.resourceId=f;u===r||u.removedTimeStamp&&Date.now()-u.removedTimeStamp<2e4||(u.removedTimeStamp=undefined,u.assetName=r.assetName,u.timeStamp=r.timeStamp)}}));i&&
(t.updateObservableList(),t._startSyncSettingsFromCloud())}))},n.prototype.updateObservableList=function(){var i=this,n=this._observableList,t;n&&(t=this._list.getList().filter((function(n){if(typeof n.removedTimeStamp=="number")return!1;var t=i._assetTypeService.getAssetType(n.extension,n.assetType,n.cloudName,0);return!(t&&t.assetTypeManifest.browseType===1&&!n.resourceId&&typeof n.assetId!="string")})),n.splice.apply(n,[0,n().length].concat(t)))},n.prototype._startSyncSettingsFromCloud=function(){var n=this,u=function(){n._settingsService.setSetting(0,nt,n._list.getList());var t=n._cloudSyncCompletedCallback;t&&t()},t,r=this._querySettingsCalledDeferred;return r?t=r.promise():(this._querySettingsCalledDeferred=i.Helpers.Deferred(),t=this._settingsService.querySetting(0,nt).then((function(t){var i=new s.LruMap(50);yt(t,i)&&(n._list=i);return}))),Q(t).then((function(){u();n._querySettingsCalledDeferred.resolve();return}))},n})();t.AssetMruListImpl=b}));define("MsPortalImpl/Services/Services.Permissions",
["require","exports","f","i","FxHubs/Permissions"],(function(n,t,i,r,u){"use strict";var f;return (function(t){function w(n,t){return new l(n,t)}function b(n,t,i){return s.hasPermissionsToHubs.invoke(f.client,e,{entityId:n,requestedActions:t,providedActions:null,cloudName:i})}function k(n,t){return s.getPermissionsToHubs.invoke(f.client,e,{entityId:n,cloudName:t})}function d(n){return s.isCoAdminEndpoint.invoke(f.client,e,{cloudName:n})}var a=r,o=a.Extension,h=i.Base,v=h.Diagnostics,f=r.Rpc,y=i.ViewModels.Services.ResourceTypes,c=u.PermissionChecker,s=u.Rpc,e=o.getHubsWindowId(),p=v.createLog(n),l;t.Internal={};t.createPermissionsManager=w;l=(function(){function n(n,t){var r=this,i;this._extensionManager=n;this._assetTypeService=t;i=u.createCachedPermissionsGetter(k);this._cachedPermissionsGetter=i;this._getPermissionsCallback=i.getPermissions.bind(i);o.hasPermissionsToShell.register(f.client,null,(function(n,t){var i=t.srcWindowId;return i!==e&&i!==h.Constants.Shell&&(n.cloudName&&p.warning(
"{0} should not pass cloud name".format(i)),n.cloudName=o.getDescriptor(t.srcWindowId).cloudName),r.hasPermission(n.entityId,n.requestedActions,n.cloudName)}))}return n.prototype.isCoAdmin=function(n){return d(n)},n.prototype.hasPermission=function(n,i,r){return t.Internal.hasPermissionOverride?t.Internal.hasPermissionOverride(n,i):c.isRDFEAction(i)?b(n,i,r):y.isResourceManagerId(n,!0)?c.hasPermission(n,i,null,r,this._getPermissionsCallback):Q("The entity ID for hasPermission must be a resource ID, a subscription ID or a resource group ID")},n.prototype.getCachedPermissions=function(n){return this._cachedPermissionsGetter.getCachedPermissions(n)},n})()})(f||(f={})),f}));define("MsPortalImpl/UI/Hubs/UI.BrowseManager",["require","exports","f","i","u","ko","FxHubs/RpcEndPoints","../../Services/Services.AssetTypes"],(function(n,t,i,r,u,f,e,o){"use strict";function it(n,t){var i=n.toLocaleLowerCase(),r=t.toLocaleLowerCase();return i===r?0:i<r?-1:1}function kt(n){nt||(nt=n.assetManager.assetMruList.
mruList.subscribe((function(){var t=e.Mru.pingMruAssetsListEndPoint;n.extensionManager.getHubsExtension().then((function(){t.invoke(ht.client,ft,u)}))})))}function dt(n){if(!tt){tt=!0;var t=n.rpcClient,f=n.assetManager,i=n.assetTypeService,r=[yt],u=f.assetMruList;e.Mru.clearMruAssetsListEndPoint.register(t,r,(function(){return u.clear(),Q(!0)}));e.Mru.removeMruAssetEndPoint.register(t,r,(function(n){return u.removeAssetEntry({cloudName:n.cloudName,name:n.extension},n.assetType,n.assetId).then((function(){return!0}))}));e.Mru.getMruAssetsListEndPoint.register(t,r,(function(){var t=u.mruList().slice(0),n=[];return t.forEach((function(t){var r=t.cloudName,u=t.extension,f=t.assetType,s,e,h;(u===et&&f===ut||i.hasAssetType(u,f,r,1))&&(s=t.resourceId||t.assetId,e=i.getAssetType(u,f,r),e?(h={key:o.getMruItemKey({cloudName:r,name:u},f,s),isResourceTypeBrowse:e.assetTypeManifest.browseType===w,id:s,isPreview:e.isPreview,name:t.assetName,resourceTypeAssetTypeInformation:i.mapAssetTypeToResourceTypeAssetTypeInformation(
e),timeStamp:t.timeStamp,cloudName:r},n.push(h)):c.warning("Could not find the asset type for the MRU entry. AssetTypeId : <"+r+":"+u+":"+f+"> : ID: <"+JSON.stringify(s)+">"))})),n}))}}function gt(n,t,i,r){return new rt(n,t,i,r)}var a=i.Base,h=a.Constants,ut=h.AssetNames.SubscriptionDetail,ft=h.ExtensionNames.Hubs,et=h.ExtensionNames.Billing,ot=h.ResourceTypes.ResourceGroups,st=a.Diagnostics,ht=r.Rpc,v=i.ViewModels.Services,ct=v.Browse,lt=v.GridColumns,l=r.Extension,y=i.getUniqueId,at=window.fx.environment,c=st.createLog(n),vt=ot.toLowerCase(),yt=l.getHubsWindowId(),s=c.verbose.bind(c),p=i.forEachKey,pt=4,w=1,b=3,k=0,d="The asset type does not have a ",g=" service view model was already disposed.",wt=i.isFeatureEnabled("supportthirdpartyresources"),nt,tt=!1,bt=r.getErrorMap({badCriteria:""}),rt;t.compareAssetTypeForSort=it;t.subscribeToMruItems=kt;t.registerRpcEndpoints=dt;t.createBrowseManager=gt;rt=(function(){function n(n,t,r,u){var o=this,e;if(this._browsePackages={},this._registeredResourceProviders=
f.observableArray(["*"]),this._haveRdfeAccess=!1,this._callbacks={},this._isCoAdmin=!1,this._extensionManager=n,this._assetTypeService=t,this._permissionsService=r,e=this._executeCallbacks.bind(this),this._registeredResourceProviders.subscribe(e),this._haveRdfeAccess=u(),u.subscribe((function(n){o._haveRdfeAccess=n;e()})),i.isFeatureEnabled("loadassetsasync"))n.on("assetTypes",(function(){return e(),t.assetTypes.subscribe(e),!0}));else n.on("assetTypes").then((function(){e();t.assetTypes.subscribe(e)}))}return n.prototype._executeCallbacks=function(){var n=this._callbacks;n&&p(n,(function(n,t){t()}))},n.prototype._assetTypeSupportsCriteria=function(n,t){return n.extension===t.assetOwner&&n.assetTypeManifest.name===t.assetType&&l.isEqualCloudName(n.cloudName,t.cloudName)},n.prototype._releaseViewModel=function(n,t){i.disposeViewModelProperties(t);n.releaseViewModel(t)},n.prototype._assetTypeMeetsRequirements=function(n){var r,l,a,f,e,o,s,h,c,v;if(!n)return!1;var t=n.browseType,y=n.browseRequirements&
1,p=!y||this._isCoAdmin;if(t===u||!p)return!1;r=this._haveRdfeAccess;l=!n.browseRequiresRdfe||r;switch(t){case b:case pt:if(a=n.browseLinkUri||"",f=function(n){return n+="Portal",a.indexOf("{"+n+"}")>=0&&(i.getFeatureValue(n)==="false"||!at.links[n])},f("classic")||f("account"))return!1;case k:case w:if(!l)return!1}return(e=n.resourceType,!e)?!0:(o=e.resourceTypeName,s=o.toLowerCase(),s===vt)?!0:!wt&&!r&&!s.startsWith("microsoft.")?!1:(h=o.split("/"),h.length<2)?!1:t===b?!0:(c=this._registeredResourceProviders,c().some((function(n){return n.toLowerCase()==="*"})))?!0:(v=h[0].toLowerCase(),c().some((function(n){return n.toLowerCase()===v})))},n.prototype.dispose=function(){p(this._browsePackages,(function(n,t){t.cancel();t.dispose()}));this._browsePackages=null},n.prototype.initialize=function(){this._extensionManager.getHubsExtension()},n.prototype.registerAssetTypesUpdateCallback=function(n){var t=y();return this._callbacks[t]=n,t},n.prototype.unregisterAssetTypesUpdateCallback=function(n){
var t=this._callbacks;t[n]&&delete t[n]},n.prototype.addRegisteredResourceProvider=function(n){this._registeredResourceProviders.push(n)},n.prototype.initiateBrowse=function(n){var t=this,r;return n||bt.badCriteria(),r=new ct.ResultsViewModel(n,[]),i.require("MsPortalImpl/UI/Hubs/UI.BrowseManagerDelayed").then((function(i){var o="All browse operations returned.",h="browse-"+y(),u=new i.BrowsePackage(r,t),p=u.ltm;t._browsePackages[h]=u;var f=0,e=0,a=!1,v=[];return t._assetTypeService.assetTypes().forEach((function(i){var y,h;if(!u.canceled&&t._assetTypeSupportsCriteria(i,n)&&(y=i.assetTypeManifest,y.browseType===k)){var r=function(){++e;a&&e===f&&(s(o),u.allOperationsReturned())},w=y.browseServiceViewModel,b=l.getWindowId({name:i.extension,cloudName:i.cloudName})+"."+y.name+"."+w;s("Browse provider "+b+" using optimized browse.");h="browse operation from "+b+" browse provider";v.push(t._extensionManager.getExtensionByName(i.extension,i.cloudName).then((function(f){return Q(f.getViewModel(w)).
then((function(e){var o=e.content,c,a,l;o?(c=!1,p.registerForDispose((function(){c=!0;t._releaseViewModel(f,e)})),c?(s("The "+h+" was already disposed."),r()):(a=function(n,t){u.canceled||(s("Got "+h+"."),u.addOperation(i,n,t));r()},l=void 0,typeof o.onInputsSet=="function"&&(l=o.onInputsSet({criteria:n})),Q(l||!0).then((function(){a(b,o)})).catch((function(n){s("The "+h+" rejected the load promise: "+n);r()})))):(s("$Failed to get the "+h+"."),r())})).catch((function(n){s("Failed to get browse operation "+w+": "+n+".");r()}))})).catch((function(n){c.error("Failed to get extension for browse operation "+w+": "+n);r()})));s("Getting "+h+".");++f}})),a=!0,e===f&&(s(o),u.allOperationsReturned()),Q.all(v).then((function(){return h}))}))},n.prototype.getViewModelForBrowse=function(n){var t=this._browsePackages;return n in t?t[n].viewModel:null},n.prototype.releaseBrowse=function(n){var t=this._browsePackages,i;n in t&&(i=t[n],i.cancel(),i.dispose(),delete t[n])},n.prototype.getFilteredAssetTypes=function(){
var n=this,t,r;return this._isCoAdminPromise||(this._isCoAdminPromise=Q(this._permissionsService.isCoAdmin(h.DefaultCloudName)).then((function(t){n._isCoAdmin!==t&&(n._isCoAdmin=t,n._executeCallbacks())}))),t=[],r=[],this._assetTypeService.assetTypes().forEach((function(i){var r=i.assetTypeManifest;n._assetTypeMeetsRequirements(r)&&(r.privateBrowse||t.push(i))})),t.length&&i.stableSort(t,(function(n,t){return it(n.compositeDisplayName.service,t.compositeDisplayName.service)})).forEach((function(n){r.push(n)})),r},n.prototype.getGridColumnsPromiseForAssetType=function(n,t){var r=this,i=n.assetTypeManifest.gridColumnsServiceViewModel;return i?Q(this._extensionManager.getExtensionByName(n.extension,n.cloudName)).then((function(n){return Q(n.getViewModel(i)).then((function(i){var e=!1,u,f;return(t.registerForDispose((function(){e=!0;r._releaseViewModel(n,i)})),!e)?(u=i.content,f=void 0,typeof u.onInputsSet=="function"&&(f=u.onInputsSet({usage:lt.Usage.Default})),f)?f.then((function(){return u})):u:Q.reject(
"The grid columns"+g)}))})):Q.reject(d+" grid columns service view model.")},n.prototype.getDynamicBladePromiseForAssetType=function(n,t){var r=this,i=n.assetTypeManifest.dynamicBladeServiceViewModel;return i?Q(this._extensionManager.getExtensionByName(n.extension,n.cloudName)).then((function(n){return Q(n.getViewModel(i)).then((function(i){var u=!1;return(t.registerForDispose((function(){u=!0;r._releaseViewModel(n,i)})),!u)?i.content:Q.reject("The dynamic blade"+g)}))})):Q.reject(d+" dynamic blade service view model.")},n})()}));define("MsPortalImpl/UI/Commands/UI.CommandManager",["require","exports","f","i","$","MsPortalImpl.Controls/Controls/Balloon","../../Interactions/Interactions.DismissHandler","./UI.Commands","../Compositions/UI.Composition","../../Widgets/Widgets.ContextMenu","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){function k(n){return new t(n)}function a(n){var r,i,t;if((b?n.metaKey:n.ctrlKey)||(r=p.getSelection(),r.rangeCount&&
!r.getRangeAt(0).collapsed)||(i=u(n.target),i.filter("input,textarea").length)||i.add(u(n.target).parents("a")).filter("a[href]:not([href='#']):not([href=''])").length)return!0;n.preventDefault();n.stopPropagation();t=u.Event(c.default.fxcontextmenurequest);t.pageX=n.pageX;t.pageY=n.pageY;t.clientX=n.clientX;t.clientY=n.clientY;i.trigger(t)}var v=r.TriggerableLifetimeManager,l=i.ViewModels.Controls.Balloon,y=l.ViewModel,p=window,w="<div class='fxs-commands-contextMenu'><\/div>",b=navigator.platform.indexOf("Mac")!==-1,t;n.createCommandManager=k;n.onContextMenu=a;t=(function(){function n(n){var t=this,r;this._ltm=new v;this._body=u("body");this._desktop=n;this._initializeContextMenu();this._handleDesktopModeChange();r=function(n){var i=t._balloonContentElement;return!(i===n)&&!u.contains(i,n)};this._dismissHandle={dismissFn:function(){i.require("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox").then((function(n){n.cancelMessageBox(u(t.getForm()));t.hideForm()}));e.unregister(t._dismissHandle)}
,shouldDismissOnMouseDownFn:r,shouldDismissOnMouseWheelFn:r,restoreFocus:function(){e.validatePreviousFocusedElement(t._dismissHandle,t._previouslyFocusedElement)&&t._previouslyFocusedElement.focus()},logName:"commandmanager"}}return n.prototype.dispose=function(){this.stopListeningForEvents();e.unregister(this._dismissHandle);this._ltm.dispose()},n.prototype.startListeningForEvents=function(){var u=this,n=this._body;n.on(c.default.fxcontextmenu,this._fxMenuEventHandler=function(n,t){u._showContextMenu(n,t)}).on(c.default.contextmenu,this._browserMenuEventHandler=function(n){a(n)});var t=this._contextMenuElement,i=this._desktop.portalWidget,r=i&&i.element;return r?r.append(t):n.append(t),this},n.prototype.stopListeningForEvents=function(){var n=this._body;this._fxMenuEventHandler&&(n.off(c.default.fxcontextmenu,this._fxMenuEventHandler),this._fxMenuEventHandler=null);this._browserMenuEventHandler&&(n.off(c.default.contextmenu,this._browserMenuEventHandler),this._browserMenuEventHandler=
null);this._contextMenu.hide();this._contextMenuElement.detach()},n.prototype.getForm=function(){if(!this._balloonContentElement){var n=u("<div/>"),t=this._balloonViewModel=new y(this._ltm);t.position(l.Position.Top);t.content("<div><\/div>");u("body").append(n);new f.Widget(n,t);n.addClass("fxs-dialogballoon");this._balloonContentElement=n.findByClassName("azc-balloon-content").children()[0].children[0]}return this._balloonContentElement},n.prototype.showForm=function(n){var t=this;this._balloonViewModel.box(n);this._balloonViewModel.visible(!0);i.require("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox").then((function(n){n.setFocusOnMessageBox(u(t.getForm()),t._previouslyFocusedElement)}));e.register(this._dismissHandle)},n.prototype.hideForm=function(){this._balloonViewModel&&(this._balloonViewModel.visible(!1),u(this._balloonContentElement).empty())},n.prototype.getDismissHandler=function(){return this._dismissHandle},n.prototype._initializeContextMenu=function(){this._contextMenuElement=
u(w);this._contextMenu=new h.Widget(this._contextMenuElement);this._contextMenu.hide()},n.prototype._showContextMenu=function(n,t){var p=this,h=t.contextMenu?t.contextMenu:this._contextMenu,v=h.options.menuItems,r,f,y,c=n.clientX,l=n.clientY,a,i,e;if(t.commands&&t.commands.length!==0){if(t.srcElement){for(a=t.srcElement,i=a,u(a).hasClass("fxs-tile")&&(i=u(a).find(".fxs-part")[0]);i&&typeof i.focus!="function";)i=u(i).closest("[tabindex]")[0];this._previouslyFocusedElement=i}y=t.formTarget&&t.formTarget.length>0?o.getBladeContentWidget(t.formTarget):this;h.hide();v.splice(0,v().length);do f=f?f.parentNode:n.target,r=u(f).data(s.CompositionInstanceDataName);while(!r&&f.parentNode);(s.isContextMenuContainer(r)&&r.beforeActivateCommandMenuItems(t),t.commands.forEach((function(t){p._shouldShowCommand(t)&&(t.activate(),t.bind(new o.CompositionInstanceCommandContext(n.target,y,r)),v.push(t))})),h.options.hasVisibleCommands())&&(c||l||(e=n.target.getClientRects()[0],c=e&&e.left||c,l=e&&e.bottom||
l),h.show(c,l,t&&t.forceLeft))}},n.prototype._handleDesktopModeChange=function(){var n=this;this._desktop.mode.subscribe(this._ltm,(function(t){t===1&&n.hideForm()}))},n.prototype._shouldShowCommand=function(n){return this._desktop.mode()!==1||!this._isExtensionCommand(n)},n.prototype._isExtensionCommand=function(n){return!!n._extension},n})();n.PortalCommandManager=t})(l||(l={})),l}));define("MsPortalImpl/UI/UI.ContextPane",["require","exports","o","ko","$","../Interactions/Interactions.DismissHandler","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function o(n,i){return new t(n,i)}n.create=o;var t=(function(){function n(n,t){var s=this,i,o;this._widget=n;i=this._viewModel=n.options;this.collapsed=i.collapsed;o={dismissFn:function(){s.close()},shouldDismissOnMouseDownFn:u.noop,shouldDismissOnMouseWheelFn:u.noop,logName:"contextPane"};r.reactor(t,(function(){i.opened()?f.register(o):f.unregister(o)}));t.registerForDispose(n.element.setEvents(
[e.default.fxcontextpaneclosing,function(n){n.stopPropagation();s.close()}]))}return i.defineProperty(n.prototype,"opened",{get:function(){return this._viewModel.opened},enumerable:!0,configurable:!0}),n.prototype.hasContent=function(n){return this._contentProvider===n},n.prototype.getContent=function(){return this._contentProvider},n.prototype.tryOpen=function(n){var r=this,t,i;return this._contentProvider===n?(this._widget.setFocus(),Q(!0)):(t=this._tryRemoveContent(),t)?(this._contentProvider=n,this._previouslyFocusedElement=document.activeElement,i=this._viewModel,i.opened(!0),i.loading(!0),n.onAddingContent(this._widget).finally((function(){i.loading(!1)})).then((function(){return r._widget.setFocus(),t}))):Q(t)},n.prototype.close=function(n){var t=!0,i;return n?this._clearContent():t=this._tryRemoveContent(),t&&(i=this._viewModel,i.opened(!1),i.loading(!1),this._restoreFocus()),t},n.prototype._clearContent=function(){var n=this._contentProvider;n&&n.onRemovingContent(this._widget);this.
_contentProvider=null},n.prototype._tryRemoveContent=function(){var n=this._contentProvider,t;return n?(t=!n.canRemoveContent||n.canRemoveContent(),t&&this._clearContent(),t):!0},n.prototype._restoreFocus=function(){var n=this._previouslyFocusedElement;n&&n.focus()},n})();n.ContextPaneImpl=t})(o||(o={})),o}));define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter",["require","exports","f","o"],(function(n,t,i,r){"use strict";var u;return (function(n){var t={pending:"pending"},u=(function(){function n(n,t){this.deferred=i.Helpers.Deferred();this.targetId=n;this.isSource=t}return n})(),f=(function(){function n(n){this._awaitableCompositions=[];this.resolvedCompositions=[];this._trackResolvedCompositions=n}return n.prototype.await=function(n,i){var f=this,r=new u(n&&n.toString(),i),e=this.resolvedCompositions.firstIndex((function(n){return i(n)}));if(e>=0)r.deferred.resolve(this.resolvedCompositions[e]);else if(this._awaitableCompositions.push(r),n)n.onDispose((function(){var n;r.deferred.
state()===t.pending&&(r.deferred.reject(),n=f._awaitableCompositions.indexOf(r),n>=0&&f._awaitableCompositions.splice(n,1))}));return r.deferred.promise()},n.prototype.resolve=function(n){var r=this,t,i;if(this._trackResolvedCompositions){this.resolvedCompositions.push(n);n.onDispose((function(){var t=r.resolvedCompositions.indexOf(n);t>=0&&r.resolvedCompositions.splice(t,1)}))}for(t=this._awaitableCompositions.length-1;t>=0;t--)i=this._awaitableCompositions[t],i.isSource(n)&&(i.deferred.resolve(n),this._awaitableCompositions.splice(t,1))},r.defineProperty(n.prototype,"waitingCompositions",{get:function(){return this._awaitableCompositions.map((function(n){return n.targetId}))},enumerable:!0,configurable:!0}),n})();n.CompositionAwaiter=f})(u||(u={})),u}));define("MsPortalImpl/UI/Compositions/UI.Composition.DashboardFiltersManager",["require","exports","f","i","o","ko","Fx/Composition/DashboardFilters","Fx/Internal/Composition/DashboardFilters","../../Base/Languages","MsPortalFx/Globalization",
"MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function y(n,t){var r,i,u;if(!t)return!1;r=!1;switch(n){case 0:i=t;r=i.absolute&&!!i.absolute.fromDate&&!!i.absolute.toDate||i.relative&&typeof i.relative.duration=="number"&&typeof i.relative.timeUnit=="number";break;case 1:u=t;r=typeof u.operator=="number"&&(u.values||[]).length>0}return r}function g(n,t){var r=JSON.parse(t||"{}"),i,u,f;return n===0&&(i=r.absolute,i&&(u=i.fromDate,f=i.toDate,i.fromDate=new Date(u),i.toDate=new Date(f))),r}function b(n){var r=n&&n.selectedDisplayLanguage||"",u=n&&n.selectableDisplayLanguages||[],t=i.find(u,(function(n){return n.locale&&n.locale.localeCompareIgnoreCase(r)===0}));return t&&t.specificCulture||"en-us"}function p(n,t,i){if(!t)return"";switch(n){case 0:var r=i,u=r.format;switch(u){case 1:return c.Filtering.Edit.TimeRange.localTime;case 0:return c.Filtering.Edit.TimeRange.utcTime;default:return c.Filtering.timeRange}case 1:return t.displayText;default:return a.
error("Unknown filter kind: "+n),""}}function w(n,t){var i,r;switch(n){case 0:var r=t,u=r&&r.absolute,f=r&&r.relative;if(u)return c.Filtering.TimeRange.absolute.format(v.create(v.shortDatePattern).format(new Date(u.fromDate)).toString(),v.create(v.shortDatePattern).format(new Date(u.toDate)).toString());i=f.duration;switch(f.timeUnit){case 0:return c.Filtering.TimeRange.Relative.minutes.format(i);case 1:return i===1?c.Filtering.TimeRange.Relative.hour.format(i):c.Filtering.TimeRange.Relative.hours.format(i);case 2:return i===1?c.Filtering.TimeRange.Relative.day.format(i):c.Filtering.TimeRange.Relative.days.format(i);default:a.error("Unknown Time unit: "+f.timeUnit)}case 1:return r=t,r.values&&r.values.toString();default:return a.error("Unknown filter kind: "+n),""}}var k=i.Base,l=e.TimeRangeFilter,d=k.Diagnostics,a=d.createLog(n),v=h.DateTimeFormat,nt={relative:{duration:24,timeUnit:1},format:0,granularity:0},tt=(function(){function n(n){var t=this;this._filtersLocale=f.observable();this.
_children=f.observableArray([]);this._allFilterDefinitions=f.observableArray([]);this._addableFiltersDefinitions=f.observableArray([]);this._appliedFilters=f.observableArray();this._hasMoreFilters=f.observable(!0);this._queryingParts=f.observable(!1);this._hasLoaded=f.observable(!1);this._currentSessionLocale=b(s.currentLocaleContext);this._staticFilters=f.observableArray([]);this._dynamicFilters=f.observableArray([]);this._notifyStartboardSettingsChanged=i.throttle((function(){t._parent.widget&&t._parent.widget.trigger("fxstartboardsettingchanged")}),1e3);this._checkAppliedFiltersAreValid=i.debounce((function(){var r=t._allFilterDefinitions.peek(),n=t._appliedFilters.peek().filter((function(n){return!!n&&n.kind()===0})).first(),i=r.filter((function(n){return!!n&&n.kind===0})).first(),u;!n&&i&&(u={id:f.observable(null),kind:f.observable(null),model:f.observable(null),isApplicable:f.observable(!0),filterIdDisplayText:"",operator:0,filterValueDisplayText:""},t.filtersWidgetViewModel.updateFilter(
u,i.filterId,nt,!0));n&&n.isApplicable(!!i);t._hasLoaded()&&t._appliedFilters.peek().forEach((function(n){if(n.kind()!==0){var t=r.some((function(t){return t.filterId===n.id()}));n.isApplicable(t)}}))}),200);this._getDynamicFilterDefinitions=i.memoizeQ((function(n){return t._getDynamicFilters(n)}));this._getDynamicFilters=i.debounce((function(n){return t._getDashboardFilteringAPIs(n).then((function(n){var i=Q.all(n.mapMany((function(n){return n&&n.getDynamicFilterDefinitions?[n.getDynamicFilterDefinitions()]:[]}))),t={};return i.then((function(n){n.forEach((function(n){n.forEach((function(n){var i=n,r=i&&i.definition&&i.definition.filterId;r&&(t[r]=i)}))}))})),u.keys(t).map((function(n){return t[n]}))}))}));this._getStaticFilterDefinitions=i.memoizeQ((function(n){return t._getStaticFilters(n)}));this._getStaticFilters=i.debounce((function(n){return t._getDashboardFilteringAPIs(n).then((function(n){var t=n.reduce((function(n,t){var r=t&&t.staticFilters&&t.staticFilters.map((function(n){return n.filterKind===0?l.filterId:
n.filterId}));return r&&i.pushUnique(n,r,null,!0),n}),[]);return Q.all(n.mapMany((function(n){return n&&n.getFilterDefinitions?[n.getFilterDefinitions()]:[]}))).then((function(n){return t.map((function(t){var r;return t===l.filterId?r={filterId:l.filterId,displayText:c.Filtering.timeRange,kind:0}:n.some((function(n){return!!(r=i.find(n,(function(n){return n.filterId===t})))})),r}))}))}))}));this._parent=n;this._children(n.children.map((function(n){return n})));this._initializeFiltersWidgetsViewModel();f.reactor(n,[this._staticFilters,this._dynamicFilters,this._appliedFilters],(function(n,i){t._allFilterDefinitions(n.concat(i.map((function(n){return n.definition}))));t._updateState()}));f.reactor(n,this._hasLoaded,(function(){return t._updateState()}));this._children.subscribeArrayBulkChanges(this._parent,(function(){t._hasLoaded(!1);t._getStaticFilterDefinitions(t._children.peek()).then((function(n){t._staticFilters(n)}))}));n.subscribeChildren((function(){t._children(t._parent.children.map((function(n){return n})
))}))}return n.prototype.getFilters=function(){var n=this;return f.ignoreDependencies((function(){return n._appliedFilters().reduce((function(n,t){var i=t.id(),r=t.model(),u=t.kind(),f=typeof i=="string"&&y(u,r);return f&&(n[i]=r),n}),{})}))},n.prototype.updateFilters=function(n,t){var r=this,u=[],e=[],o=this._appliedFilters;return t.forEach((function(t){var s=t.filterId,h=i.find(o.peek(),(function(n){return n.id()===s})),v=i.find(r._allFilterDefinitions.peek(),(function(n){return n.filterId===s})),c,a;h?h.model(t.filterModel):(c=t.filterId===l.filterId?Q(0):n.getDashboardFiltering().then((function(n){var t=n&&i.find(n.staticFilters,(function(n){return n.filterId===s}));return t&&t.filterKind})),a=c.then((function(n){typeof n=="number"&&o.push({id:f.observable(t.filterId),kind:f.observable(n),model:f.observable(t.filterModel),isApplicable:f.observable(!0),filterIdDisplayText:p(n,v,t.filterModel),operator:r._getOperator(t.filterModel),filterValueDisplayText:w(n,t.filterModel)})})),e.push(a));u.push(s)})
),Q.all(e).then((function(){return r._notifyFiltersChanged(u,n)}))},n.prototype.loadDashboard=function(n){var e=this,t,i,r;this.dispose();this._dashboardLifetime=this._parent.createChildLifetime();this._filtersLocale(n&&n.filterlocale||this._currentSessionLocale);t=n&&n.filters||{};i=u.keys(t).map((function(n){var i=t[n],r=i.kind,u=g(r,i.model);if(y(r,u))return{id:f.observable(n),kind:f.observable(r),model:f.observable(u),isApplicable:f.observable(!0),filterIdDisplayText:i.displaycache.name,filterValueDisplayText:i.displaycache.value,operator:e._getOperator(u)}})).filter((function(n){return!!n}));(r=this._appliedFilters).push.apply(r,i)},n.prototype.cleanupState=function(){this._dashboardLifetime&&(this._dashboardLifetime.dispose(),this._dashboardLifetime=null);this._getDynamicFilterDefinitions.clear();this._getStaticFilterDefinitions.clear();this._appliedFilters([]);this._staticFilters([]);this._dynamicFilters([]);this._allFilterDefinitions([]);this._addableFiltersDefinitions([]);this._filtersLocale(
"");this._hasLoaded(!1);this._queryingParts(!1)},n.prototype.setFilters=function(n){var t=u.keys(n).map((function(t){var i=n[t];return{id:f.observable(t),kind:f.observable(i.filterKind),model:f.observable(i.filterModel),isApplicable:f.observable(!0),filterIdDisplayText:"",filterValueDisplayText:"",operator:0}}));this._appliedFilters(t)},n.prototype.toJSON=function(){var n={filterlocale:b(s.currentLocaleContext),filters:{}},t=this._appliedFilters.peek();return t.forEach((function(t){n.filters[t.id()]={model:JSON.stringify(t.model()),kind:t.kind(),displaycache:{name:t.filterIdDisplayText,value:t.filterValueDisplayText}}})),n},n.prototype._initializeFiltersWidgetsViewModel=function(){var n=this;this.filtersWidgetViewModel={sourceChanged:f.observable(!0),filterRequestInProgress:this._queryingParts,canAddFilter:this._hasMoreFilters,filters:this._appliedFilters,addableFilterDefinitions:this._addableFiltersDefinitions,updateFilter:function(t,r,u,f){var h,o,e,s;(f===void 0&&(f=!1),h=i.find(n._allFilterDefinitions.
peek(),(function(n){return r===n.filterId})),o=h.kind,y(o,u))&&(e=i.find(n._appliedFilters.peek(),(function(n){return n.id()===t.id()})),s=!1,e?(e.id()!==r&&(e.kind(o),e.id(r),s=!0),JSON.stringify(e.model())!==JSON.stringify(u)&&(e.model(u),e.filterIdDisplayText=p(o,h,u),e.operator=n._getOperator(u),e.filterValueDisplayText=w(o,u),s=!0)):(t.id(r),t.kind(o),t.model(u),t.filterIdDisplayText=p(o,h,u),t.operator=n._getOperator(u),t.filterValueDisplayText=w(o,u),s=!0,t.kind()===0?n._appliedFilters.unshift(t):n._appliedFilters.push(t)),s&&n._notifyFiltersChanged([r],null,f))},removeFilter:function(t){var i=n._appliedFilters,r=i().firstIndex((function(n){return n.id()===t}));r>=0&&(i.splice(r,1),n._notifyFiltersChanged([t]))},updateAllFilterDefinitions:function(t){if(t===void 0&&(t=!1),!t&&n._hasLoaded()||n._queryingParts())return Q();n._queryingParts(!0);var i=n._children.peek();return Q.all([n._getStaticFilterDefinitions(i),n._getDynamicFilterDefinitions(i)]).spread((function(t,i){n._staticFilters(
t);n._dynamicFilters(i)})).catch((function(n){a.error(n)})).finally((function(){n._hasLoaded(!0);n._queryingParts(!1)}))},getFilterValues:function(t,u){var f=new r.TriggerableLifetimeManager,e=n._children.peek();return Q.all(e.map((function(n){return n.getDashboardFiltering()}))).then((function(n){return Q.all(n.map((function(n){var t=n&&n.getFilterDefinitions&&n.getFilterDefinitions(),r=n&&n.getDynamicFilterDefinitions&&n.getDynamicFilterDefinitions();return t&&f.registerForDispose(t.hold()),r&&f.registerForDispose(r.hold()),Q.all([t||Q([]),r||Q([])]).spread((function(n,t){return(n||[]).concat(t.map((function(n){return n.definition})))})).then((function(n){return Q.all(n.mapMany((function(n){if(n.kind===1){var t=Q(n.getFilterValues(u||""));return[t]}return[]}))).then((function(n){return n.reduce((function(n,t){return i.pushUnique(n,t),n}),[])}))}))}))).then((function(n){return n.reduce((function(n,t){return i.pushUnique(n,t),n}),[])}))})).finally((function(){return f.dispose()}))},getFilterDefinition:function(t){
return n._allFilterDefinitions.peek().filter((function(n){return!!n&&n.filterId===t})).first()}}},n.prototype._getOperator=function(n){return n&&n.operator||0},n.prototype._updateState=function(){var n=this._appliedFilters.peek();this._addableFiltersDefinitions(this._allFilterDefinitions.peek().filter((function(t){var i=n.some((function(n){return!!t&&n.id()===t.filterId}));return!i})));this._hasMoreFilters(!this._hasLoaded()||!!this._addableFiltersDefinitions().length);this._checkAppliedFiltersAreValid()},n.prototype._notifyFiltersChanged=function(n,t,i){var u=this,r;return i===void 0&&(i=!1),r=this._children.peek(),this._updateState(),Q.all(r.map((function(n){return n.getDashboardFiltering()}))).then((function(i){var u=[],f=[];return i.forEach((function(t,i){var r;t&&(t.staticFilters||[]).some((function(t){var i=t.filterId||l.filterId;return n.indexOf(i)>=0}))&&(r=!0);u[i]=r;f[i]=!r&&t&&t.getDynamicFilterDefinitions?t.getDynamicFilterDefinitions():Q([])})),Q.all(f).then((function(t){t.forEach((function(
t,i){t.some((function(t){var i=t,r=i&&i.definition&&i.definition.filterId;return r&&n.indexOf(r)>=0}))&&(u[i]=!0)}))})).then((function(){u.forEach((function(n,i){if(n){var u=r[i];u.notifyFiltersChanged(u===t)}}))}))})).finally((function(){i||u._notifyStartboardSettingsChanged()}))},n.prototype._getDashboardFilteringAPIs=function(n){var t=this;return Q.all(n.map((function(n){return i.Base.Promises.cancelOnDispose(t._dashboardLifetime,Q(n.awaitComposed))}))).catchError(i.Errors.CanceledError,(function(){})).then((function(){return Q.all(n.map((function(n){return n.getDashboardFiltering()})))}))},n.prototype.dispose=function(){this.cleanupState()},n})();t.DashboardFiltersManager=tt}));define("_generated/Templates/WidgetsStartboard",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-startboard-loadanimation"> <div class="fxs-splashscreen-loader-container fxs-loading5dots-container"> <div><\/div><div><\/div><div><\/div><div><\/div><div><\/div> <\/div> <\/div> <div class="fxs-startboard-header"> <div class="fxs-startboard-header-item fxs-startboard-title fxs-startboard-title-next fxs-portal-border" id="startboard-title"><\/div> <div class="fxs-startboard-header-item fxs-startboard-dropdown"><\/div> <input type="text" class="fxs-startboard-header-item fxs-startboard-title-edit fxs-hide-in-normal" maxlength="200"> <div class="fxs-startboard-header-item fxs-startboard-migration" role="menubar"> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-migrate"><\/button> <\/div> <div class="fxs-startboard-header-item fxs-startboard-actions" role="menubar"> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-new"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-edit"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-share"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-fullscreen"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-clone"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-delete"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-filter"><\/button> <\/div> <\/div> <div class="fxs-startboard-filter" data-bind="stopBindings: true"><\/div> <div class="fxs-startboard-layout"><\/div> <div class="fxs-startboard-message-container"><\/div>'}
}));define("MsPortalImpl/Widgets/Widgets.StartBoard",["require","exports","f","o","ko","$","MsPortalImpl/Base/Base.BrowserDetection","../Base/Base.Events","../Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Resources/ImplScriptResources","../Interactions/Interactions.RightClick","MsPortalImpl/Base/JQueryHelper","../Base/Base.KeyboardHelper","../Generated/SvgStartupDefinitions","../Base/Telemetry","./Widgets.DropMenu","./Widgets.FlowLayout","./Widgets.LayoutBase","../../_generated/Templates/WidgetsStartboard","./Widgets.UIElementBase","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Base/Base.EventTypes","../../_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){"use strict";var gt=i.Base,ht=gt.Diagnostics,ct=ht.Telemetry,it=v.Content.SvgStartup,lt=y.Source,at=y.Action,ni=window,ti=ht.createLog(n),tt=h.Dashboard,kt,dt;t.widgetClass="fxs-startboard";t.headerButtonClass="fxs-startboard-button";var vt="fxs-theme-context-start",
yt="fxs-startboard-title-edit",ut="fxs-startboard-button-text",ft="fxs-startboard-button-icon",pt="fxs-startboard-button-filter",wt="fxs-startboard-button-browse",et="fxs-startboard-header-normal",ot="fxs-startboard-header-migration",rt="fxs-startboard-dropdown-item",st=ni.fx.environment,ii=st.features.filterdashboard==="true",bt="aria-label";t.fxstartboardtitlechanged="fxstartboardtitlechanged";t.fxmigratestartboard="fxmigratestartboard";kt=(function(n){function t(t,i,r,f){n.call(this,t);this.commands=[];this.filterButtonText=u.observable("");this.title=u.observable(h.NavBar.home);this.dashboardList=u.observableArray();this.loading=u.observable(!1);this.notFound=u.observable(!1);this.isShared=u.observable(!1);this.notFoundMessage=u.observable("");this.subscriptionsInfo=u.observable("");this.locked(!1);var e=this.flowLayoutOptions=new w.ViewModel("fxs-flowlayout-instanceid");e.allowReorder=!0;e.allowOverflow=!0;e.allowGaps=!0;e.resolutionGuides=!0;e.resolutionGuidesOffset.y=-88;e.orientation=
b.Orientation.Horizontal;e.minColumns(4);e.minRows(4);e.maxRows(4);e.locked(!1);this.headerMode=u.observable(0);this.filtersWidgetViewModel=f;this.applyViewSettings(i)}return __extends(t,n),t.prototype.getViewSettings=function(){return{NormalState:{layoutSettings:this.flowLayoutOptions.getViewSettings()}}},t.prototype.applyViewSettings=function(n){n&&n.NormalState&&n.NormalState.layoutSettings&&this.flowLayoutOptions.applyViewSettings(n.NormalState.layoutSettings)},t})(d.ViewModel);t.ViewModel=kt;dt=(function(r){function v(f,e){var l=this,o,s;r.call(this,f,e);this._layout=null;o=this.ltm;this._isSharedToArm=e.isShared;f.addClass(vt).addClass(t.widgetClass).html(k());u.reactor(o,(function(){var n=e.title();f.findByClassName("fxs-startboard-title").text(n);f.findByClassName(yt).val(n)}));u.reactor(o,(function(){var t=e.headerMode(),n=f.findByClassName("fxs-startboard-header");switch(t){case 1:n.addClass(et).removeClass(ot);break;case 2:n.removeClass(et).addClass(ot);break;case 0:default:n.removeClass(
et).removeClass(ot)}}));u.reactor(o,(function(){var n=e.notFound();f.toggleClass("fxs-startboard-notfound",n)}));u.reactor(o,(function(){var n=e.loading();f.toggleClass("fxs-startboard-loading",n)}));u.reactor(o,(function(){var n=e.title();document.title=h.Portal.windowTitleFormat.format(n,st.branding.title)}));this._layout=new w.Widget(f.findByClassName("fxs-startboard-layout"),e.flowLayoutOptions);this._initializeCommands(o,f);s=f.findByClassName("fxs-startboard-message-container");s.html('<div class="fxs-startboard-message-title">'+tt.NotFound.title+'<\/div><div class="fxs-startboard-message-body" data-bind="text: data.notFoundMessage"><\/div>');u.applyBindings({data:e},s[0]);this._attachEventHandlers(f);o.registerForDispose(c.setup(f,u.observableArray(e.commands)));i.isFeatureEnabled("dashboardfilters")&&e.filtersWidgetViewModel&&i.require("./Widgets.DashboardFilters",n).then((function(n){l._dashboardFiltersWidget=new n.Widget(l.element,e.filtersWidgetViewModel)}))}return __extends(v,r),v.prototype.
dispose=function(){this._layout.dispose();this._cleanElement(t.widgetClass,vt);r.prototype.dispose.call(this)},v.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");this._layout.addChild(n)},v.prototype.removeChild=function(n){return this._layout.removeChild(n)},v.prototype.moveChild=function(n,t,i,r){this._layout.moveChild(n,t,i,r)},v.prototype.setFocus=function(){var n,t,r;i.isFeatureEnabled("skipautofocus")||(n=void 0,this._$lastFocused&&f.contains(this.element[0],this._$lastFocused[0])&&l.isVisible(this._$lastFocused)&&(this._$lastFocused.focus(),n=!0),n||(t=this._layout.element.findFirstTabbable(),t.length===1?t.focus():(r=this._selectorMenu,r&&r.setFocus())))},v.prototype.saveViewSettings=function(){return this.options.getViewSettings()},v.prototype.discardStateOfUnusedChildren=function(){return ti.assert(!!this._layout,"FlowLayout not defined."),this._layout?this._layout.discardStateOfUnusedChildren():{stateDiscarded:!1}},v.prototype.getDomOrderedChildren=
function(){return this._layout.getDomOrderedChildren()},v.prototype._attachEventHandlers=function(n){var t=this;this.ltm.registerForDispose(n.setEvents([b.Widget.layoutUpdatedEventName,function(i){n.trigger(d.Widget.viewSettingsChanged,t.saveViewSettings());i.stopPropagation()}],[nt.default.focusout,function(n){t._$lastFocused=f(n.target)}]))},v.prototype._initializeCommands=function(n,r){var ot=this,b="aria-disabled",ui=tt.create,fi=tt.delete,ei=tt.edit,oi=tt.filter,si=this._isSharedToArm?tt.unshare:tt.share,ht=tt.fullscreen,hi=tt.clone,h=this.options,k=function(n,t){n.attr("title",t).findByClassName(ut).html(t)},ci='<div class="fxs-startboard-button-container">'+('<div class="'+ft+'"><\/div>')+('<div class="'+ut+'"><\/div>')+"<\/div>",c=function(n,t,i,u,e,o){e===void 0&&(e=!1);var s=r.findByClassName(n).html(ci);k(s,t);s.findByClassName(ft).html(g.getSvgDataWithInheritPalette(i));o=o||function(){u.execute(!1)};s.on(nt.default.click,(function(n){n.stopPropagation();f(n.currentTarget).attr(
b)!=="true"&&o(n);ot.trigger(nt.default.fxdashboardactivity)}));return s.data("commandVM",u),e&&l.hide(s),s},vt=c("fxs-startboard-button-edit",ei,it.customize,h.addPartsCommand,!1,(function(){ct.trace({source:lt.Dashboard,action:at.CustomizeModeEntered});ct.trace({source:lt.Dashboard,action:at.DashboardEditCommandClicked});h.addPartsCommand.execute(!1)})),w,y,v,d,et,kt,dt,gt;u.computed(n,(function(){var n=h.addPartsCommand,t=n&&n.enabled();t?vt.removeAttr(b):vt.attr(b,"true")}));ii||r.findByClassName(pt).remove();w=r.findByClassName(yt);w.attr(bt,tt.titleLabel);w.on(nt.default.change,(function(){h.title(w.val());r.trigger(t.fxstartboardtitlechanged)}));y=new p.ViewModel('<div class="fxs-startboard-button-container"><div class="fxs-startboard-title" data-bind="text: data.title, attr: { title: data.title }"><\/div>'+('<div class="'+ft+'">'+g.getSvgDataWithInheritPalette(it.caretDown)+"<\/div>")+"<\/div>","<div class='fx-dropmenu-dropdown'>"+('<ul class="fxs-dropmenu-list-system" role="menu" aria-label="'+
tt.recentMenuLabel+'">')+"<!-- ko ifnot: data.dashboardList -->"+("<li class='"+rt+'\' role="menuitem" tabindex="0">')+'<div class="fxs-tile-progress-transparent"><div><\/div><div><\/div><div><\/div><div><\/div><div><\/div><\/div><\/li><!-- /ko --><!-- ko if: data.dashboardList --><!-- ko ifnot: data.dashboardList().length -->'+("<li class='"+rt+'\' role="menuitem" tabindex="0">')+("<div class='fxs-dropmenu-list-content'>"+tt.emptynext+"<\/div>")+"<\/li><!-- /ko --><!-- ko foreach: data.dashboardList -->"+("<li class='"+rt+' fxs-startboard-dropdown-dashboard fxs-portal-hover msportalfx-tooltip-overflow\' role="menuitem" data-bind="attr: { \'aria-label\': $parent.func.altText(title, id) }, event: { click: $parent.func.clickHandler, keydown: $parent.func.clickHandler }" tabindex="0">')+'<div class=\'fxs-dropmenu-list-content fxs-startboard-item-container\'><div class="fxs-startboard-item-icon"><!-- ko if: id.indexOf("private") === -1 -->'+g.getSvgReferenceOrFallBackToData(it.share)+"<!-- /ko --><\/div><div class=\"fxs-startboard-item-title\" data-bind='text: title'><\/div><\/div><\/li><!-- /ko --><!-- /ko -->"+
('<li class="'+rt+' fxs-startboard-dropdown-browseall fxs-portal-hover" role="menuitem" tabindex="0">')+'<div class="fxs-startboard-dropdown-subscriptions" data-bind="text: data.subscriptionsInfo"><\/div>'+('<a href="#" class="'+wt+' fxs-portal-text-primary">'+tt.browseAll+"<\/a>")+"<\/li><\/ul><\/div>");v=r.findByClassName("fxs-startboard-dropdown");y.alignMenu=0;d=this._selectorMenu=new p.Widget(v,y);y.isMenuOpen.subscribe(n,(function(n){n&&h.refreshDashboardList?(et=new s.KeyboardNavigation(d.element),h.dashboardList(undefined),h.refreshDashboardList((function(n){h.dashboardList(n)}))):et&&et.dispose()}));u.reactor(this.ltm,(function(){v.find(".fxs-dropmenu-button").attr(bt,tt.switcherLabel.format(h.title()))}));kt=function(n,t){(t.type!==nt.default.keydown||(t.keyCode===13||t.keyCode===32)&&a.getModifierKeys(t)===0)&&(t.preventDefault(),t.stopPropagation(),r.findByClassName("fxs-startboard-title-next").text(n.title),i.isFeatureEnabled("hashinie11")||e.isIe11?h.updateDashboardUri(n):h.switchDashboard&&
h.switchDashboard(n).then((function(){var n=Math.min(Math.max(v.outerWidth()+50,400),560);v.find(".fxs-dropmenu-content").css({minWidth:n})})),y.close())};u.applyBindings({data:h,func:{clickHandler:kt,altText:function(n,t){return n+" "+(t.indexOf("private")===-1?tt.sharedStatusLabel:"")}}},d.element[0]);c("fxs-startboard-button-new",ui,it.add,h.newCommand);h.filterButtonText(oi);dt=c(pt,h.filterButtonText(),it.filter,h.filterCommand);h.filterButtonText.subscribe(n,(function(n){dt.findByClassName(ut).html(n)}));c("fxs-startboard-button-clone",hi,it.clone,h.cloneCommand);gt=c("fxs-startboard-button-share",si,it.share,h.shareCommand,st.chrome.hideDashboardShare);u.reactor(n,this._isSharedToArm,(function(n){var t=n?tt.unshare:tt.share;k(gt,t)}));c("fxs-startboard-button-delete",fi,it.trashOutline,h.deleteCommand);var li=c("fxs-startboard-button-fullscreen",ht,it.fullscreen,h.fullscreenCommand),ni=function(){var n=o.isFullscreen(),t=n?tt.exitFullscreen:ht;f(document.body).toggleClass("fxs-portal-fullscreen",
n);k(li,t)},ti=f(document),ri=o.fullscreen;ti.on(ri,ni);n.registerForDispose([function(){ti.off(ri,ni)},v.setEvents([nt.default.click,function(){return ot.trigger(nt.default.fxdashboardactivity)}])]);c("fxs-startboard-button-migrate",tt.migrate,it.clone,null,!1,(function(){r.trigger(t.fxmigratestartboard)}));r.findByClassName(wt).click((function(n){n.preventDefault();h.browseCommand.execute(!1)}))},v})(d.Widget);t.Widget=dt}));define("MsPortalImpl/UI/Compositions/UI.Composition.StartBoard",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","../../Services/Services.Settings.Schema","../../Base/Telemetry","../Commands/UI.Commands","./UI.Composition","./UI.Composition.Base","./UI.Composition.CompositionAwaiter","./UI.Composition.DashboardFiltersManager","./UI.Composition.PartSettingsManager","./UI.Composition.PropertyBinding","./UI.Composition.StartboardPart","../Commands/UI.ShellCommands","../../Widgets/Widgets.StartBoard","../../Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes"],
(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){"use strict";function rt(n){return n!==o.desktopSettingsKey&&n!==o.startBoardSettingsKey&&!i.startsWith(n,y.partIdentityStatePrefix)}function ct(n){var t=new nt(n);return t.save(),t}function lt(n,t,i){var f=r.keys(t).map((function(i){return rt(i)?w.Instance.fromJSON(n,t[i]):null})).filter((function(n){return!!n})),u=new nt(n,f,i.widgetState);return u.logChildren(),u.loadFromJson(i),u}function at(n){var t=[],i=new b.EnterOrganizeMode(n,!0);return i.text(e.Dashboard.edit),t.push(new b.ResetStartBoardCommand(n)),t.push(i),t.push(new b.ExitOrganizeMode(n)),t}var ut=i.Base,tt=ut.Diagnostics,ft=tt.Telemetry,et=i.Parts,ot=c.CompositionType,st=p.ReferenceScope,it=tt.createLog(n),ht=c.getIdMatchFunc,nt;t.fxstartboardsettingchanged="fxstartboardsettingchanged";t.isStartboardPartKey=rt;nt=(function(n){function e(t,r,f){n.call(this,"Startboard",t,null,r,f,o.startBoardSettingsKey);this._partAwaiter=new a.CompositionAwaiter(!0);this._containerAwaiter=new
a.CompositionAwaiter;this.masterContainer=null;this.detailContainers=[];this.notFound=u.observable(!1);this._store=4;i.isFeatureEnabled("dashboardfilters")&&this.registerForDispose(this.dashboardFiltersManager=new v.DashboardFiltersManager(this))}return __extends(e,n),e.prototype.getCompositionType=function(){return ot.Startboard},e.prototype.setGetDashboard=function(n){if(this._getDashboard)throw new Error("GetDashboard can only be set once by DashboardManager");this._getDashboard=n},e.prototype.removeGetDashboard=function(){this._getDashboard=null},e.prototype.getDashboard=function(){var n=this._getDashboard;return n?n():null},e.prototype.onDetailContainersChanged=function(){},e.prototype.getDeepLink=function(){return Q("")},e.fromJSON=function(n,t,i){return c.createCompositionFromJSON(i,(function(){return lt(n,t,i)}),(function(t,i){var r=new e(n);return r.unrecoverableErrorMessage=i,r}))},e.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this),r=this._getDashboard?this._getDashboard(
):null,f;return r&&(t.dashboardId=r.id,t.dashboardTitle=r.title,f=r.model,t.dashboardModel=f?{model:u.toJS(f.model),metadata:i.clone(f.metadata,!0)}:undefined),delete t.children,t},r.defineProperty(e.prototype,"eligibleForBinding",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.getInputPropertyBindings=function(){throw new Error("Unreachable code");},e.prototype.getViewModel=function(n){var r,t;if(n=i.isNullOrUndefined(n)?8:n,n===8){if(t=this._getDashboard&&this._getDashboard().model,!t)throw new Error("There is no current Dashboard.");r=t.model}return r||{}},e.prototype.getViewModelAsync=function(n){return f.Deferred().resolve(this.getViewModel(n)).promise()},e.prototype.getCompatibleSourceReferences=function(n){var u=this._getDashboard&&this._getDashboard().model,t=u&&u.metadata,i,f;return t&&(i=n.type,i)?(f=r.keys(t).filter((function(n){var r=t[n];return r===i})),f.map((function(n){return{property:n,modelType:8,scope:st.CurrentContainer,cardinality:p.ReferenceCardinality.
OneToOne}}))):null},e.prototype.logChildren=function(){this.children.forEach((function(n){var t=n&&n.widgetState(),i=t&&t.NormalState?et.InternalPartSize[t.NormalState.size]:"";ft.trace({extension:n.locator.getExtensionLocator().name,source:s.Source.StartBoardPart,action:s.Action.StartBoardPartLoaded,name:n.locator.toFriendlyString(),data:i})}))},e.prototype.getFilters=function(){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getFilters()},e.prototype.updateFilters=function(n,t){return this.dashboardFiltersManager&&this.dashboardFiltersManager.updateFilters(n,t)},e.prototype.setFilters=function(n){return this.dashboardFiltersManager&&this.dashboardFiltersManager.setFilters(n)},e.prototype._compose=function(n,r){var s=this,f=new k.ViewModel(this.id,this.widgetState(),this,this.dashboardFiltersManager&&this.dashboardFiltersManager.filtersWidgetViewModel),e=this.services,o,l;u.utils.arrayPushAll(f.commands,at(this.services));var v=f.addPartsCommand=i.find(f.commands,(function(
n){return n.commandName===b.CommandNames.EnterOrganizeMode})),y=f.newCommand=new b.NewDashboard(e),p=f.cloneCommand=new b.CloneDashboard(e),w=f.filterCommand=new b.FilterDashboard(e,this),nt=f.fullscreenCommand=new b.FullscreenDashboard(e),tt=f.deleteCommand=new b.DeleteDashboard(e),rt=f.shareCommand=new b.ShareDashboard(e),ut=f.browseCommand=new b.OpenBrowseDashboardsPane(e),a=this._getDashboard?this._getDashboard().title:null;a&&f.title(a);this.widget=new k.Widget(n.getStartBoardArea(),f);o=this.widget.element;l=function(n,t){n.bind(new h.CompositionInstanceCommandContext(o.findByClassName(t)[0],null,s))};l(v,k.widgetClass+"-title");[[y,"new"],[p,"clone"],[w,"filter"],[nt,"fullscreen"],[tt,"delete"],[rt,"share"],[ut,"browse"],].forEach((function(n){var t=n[0],i=n[1];l(t,k.headerButtonClass+"-"+i)}));o.data(c.CompositionInstanceDataName,this);o.on(d.Widget.viewSettingsChanged,this._viewSettingsUpdateHandler=function(n,i){n.stopPropagation();s.widgetState(i);o.trigger(t.fxstartboardsettingchanged)}
);o.on(g.default.fxunpin,this._tileUnpinHandler=function(n,t){var i=s.children.first(ht(t.tileId));i&&(it.warning("Part '{0}' is about to be removed due to user unpin operation.".format(i)),s.services.desktop.removeTile(i.id));setTimeout((function(){var n=s.widget;n&&n.setFocus()}),50)});r.resolve()},e.prototype.matchesLocatorAndModel=function(){return!1},e.prototype.resetLayout=function(){this.services.desktop.resetStartBoard()},e.prototype.dispose=function(){var t=this.widget.element;this._viewSettingsUpdateHandler&&t.off(d.Widget.viewSettingsChanged,this._viewSettingsUpdateHandler);this._tileUnpinHandler&&t.off(g.default.fxunpin,this._tileUnpinHandler);this._viewSettingsUpdateHandler=null;this._tileUnpinHandler=null;it.warning("UI.Composition.Startboard.dispose() has been called.");n.prototype.dispose.call(this,!0)},r.defineProperty(e.prototype,"journeyPath",{get:function(){return[]},enumerable:!0,configurable:!0}),e.prototype.getComposedParts=function(){return this._partAwaiter.resolvedCompositions}
,e.prototype.awaitComposedPart=function(n,t){return this._partAwaiter.await(n,t)},e.prototype.notifyPartComposed=function(n){this._partAwaiter.resolve(n)},e.prototype.awaitContainer=function(n,t){return this._containerAwaiter.await(n,t)},e.prototype.notifyContainer=function(n){this._containerAwaiter.resolve(n)},e.prototype.onInvocationStarted=function(){},e.prototype.getDiagnosticsData=function(){return f.extend(n.prototype.getDiagnosticsData.call(this),{detailBlades:this.detailContainers.map((function(n){return n.toString()}))})},e})(l.Instance);t.Instance=nt;t.create=ct}));define("MsPortalImpl/UI/Dashboard/DashboardRepository",["require","exports"],(function(){"use strict";var n;return (function(n){n.ArmDashboardRepository="ArmDashboardRepository";n.PrivateDashboardRepository="PrivateDashboardRepository";n.RecommendedDashboardRepository="RecommendedDashboardRepository";n.SessionDashboardRepository="SessionDashboardRepository"})(n||(n={})),n}));define("MsPortalImpl/UI/Dashboard/ArmDashboardRepository",
["require","exports","f","o","./DashboardRepository","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function c(n){try{return nt.parseResourceDescriptor(n)}catch(t){return l.error(t,0,"Failed to parse ARM dashboard id '"+n+"'."),null}}function y(n){var e=n.tags&&n.tags[a]||n.name,t=n.properties,u=t&&t.metadata,o=u&&u.model||{},i=t&&t.lenses,f=i&&i["0"]&&i["0"].parts||{};return{title:e,model:o,parts:r.keys(f).map((function(n){return f[n]}))}}function e(n){var t=n.substr(h.length);return i.ensurePrefix(t,"/")}function p(n){return n.startsWith("/")&&(n=n.substr(1)),""+h+n}function w(n){return i.startsWith(n,h)}function it(n,t){return t.length?n.filter((function(n){if(!w(n.id))return!0;var r=e(n.id),i=c(r);return i?t.indexOf(i.subscription)>-1:!1})):n}function k(n,t){var r={};return r[a]=n,i.extend2(t,r)}var s=i.Base,d=s.Diagnostics,g=s.Promises.cancelOnDispose,o=s.Constants.DefaultCloudName,nt=i.ViewModels.Services.ResourceTypes,tt="Dashboard$DashboardViewModel",
l=d.createLog(n),h="arm/",a="hidden-title",v=f.Dashboard.NotFound,b;t.normalizedDashboard=y;t.getArmDashboardId=e;t.buildDashboardId=p;t.filterDashboards=it;b=(function(){function n(n,t,i,r){var u=this;this._lifetime=n;this._extensionManager=t;this._permissionsManager=i;this._compressor=r;this._isDisposed=!1;n.registerForDispose((function(){u._dispose()}))}return n.prototype.getTypeName=function(){return u.ArmDashboardRepository},n.prototype.createDashboard=function(n){var t=this;return this._connect().then((function(){var r=t._compressor.compress({id:"",title:"",settings:n.settings}),u={name:i.getUniqueId(),model:r.model,parts:r.parts,subscriptionId:n.extras.subscriptionId,resourceGroupName:n.extras.resourceGroupName,tags:k(n.title)};return t._provider.createDashboard(u,o)})).then((function(n){return t._convertToDashboard(n)}))},n.prototype.readDashboard=function(n){var t=this;return this._connect().then((function(){var i=e(n);return t._provider.readDashboard(i,o)})).then((function(n){return t.
_convertToDashboard(n)}))},n.prototype.updateDashboard=function(n,t){var i=this,r=e(n);return this._connect().then((function(){return t.title?i._provider.readDashboard(r,o).then((function(n){return n.tags})):Q()})).then((function(n){var u=i._compressor.compress({id:"",title:"",settings:t.settings}),f={model:u.model,parts:u.parts,tags:!t.title?undefined:k(t.title,n)};return i._provider.updateDashboard(r,f,o)})).then((function(n){return i._convertToDashboard(n)}))},n.prototype.deleteDashboard=function(n){var t=this;return this._connect().then((function(){var i=e(n);return t._provider.deleteDashboard(i,o)}))},n.prototype.readDashboards=function(){var n=this;return this._connect().then((function(){return n._provider.readDashboards(o)})).then((function(t){return t.map((function(t){return n._convertToDashboard(t)}))}))},n.prototype.isDashboardWritable=function(n){return this._permissionsManager.hasPermission(e(n),["Microsoft.Portal/dashboards/write"],o)},n.prototype.identifyDashboard=function(n){return w(n)}
,n.prototype.getDashboardProperties=function(n){var t=n.id,u=n.title,i=e(t),r=c(i)||{subscription:"",resourceGroup:""};return{id:t,title:u,originalId:i,subscription:r.subscription,resourceGroup:r.resourceGroup}},n.prototype.getNotFoundMessage=function(n){var r=n.id,i=n.title,u=e(r),t=c(u);return t?v.armMessageFormat.format(i,t.resourceGroup,t.subscription):v.defaultMessageFormat.format(i)},n.prototype._dispose=function(){this._isDisposed||(this._isDisposed=!0,this._isConnected=null,i.disposeViewModelProperties(this._viewModel),this._extension&&this._viewModel&&this._extension.releaseViewModel(this._viewModel),this._extension=null,this._viewModel=null)},n.prototype._connect=function(){var n=this;return this._isConnected||(this._isConnected=g(this._lifetime,(function(){return n._extensionManager.getHubsExtension().then((function(t){return n._extension=t,Q(t.getViewModel(tt))})).then((function(t){n._viewModel=t;n._provider=t.content})).catch((function(t){return n._isConnected=null,l.error(t,0,"Failed to connect ARM dashboard repository to its data provider from hubs extension."),
Q.reject(t)}))})))},n.prototype._convertToDashboard=function(n){var t=p(n.id);return this._compressor.uncompress(t,y(n))},n})();t.ArmDashboardRepository=b})(e||(e={})),e}));define("MsPortalImpl/UI/Dashboard/DashboardCompressor",["require","exports","f","i","o","ko","../../Extension/Extension.Definition.Locator","../Compositions/UI.Composition","../Compositions/UI.Composition.Base","../Compositions/UI.Composition.PropertyBinding","../Compositions/UI.Composition.Part","./../Compositions/UI.Composition.StartBoard","../Compositions/UI.Composition.PartSettingsManager","./../Compositions/UI.Composition.PartSize","../../Services/Services.Settings.Schema","../../Widgets/Widgets.FlowLayout"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";function et(n,t){var y=t[k],p=y.widgetState,d=p.NormalState.layoutSettings.positions,r=d.first((function(t){return t.id===n})),v,u;if(!r)return w.warning("Cannot compress part '"+n+"', because it does not have position in startboard."),null;var i=t[n],g=i.adapterBindings||
i.bindings,s=f.toJS(it(i.containerModel)),nt=f.toJS(it(i.overridesModel)),l=(g||[]).map((function(n){var t=n.source,f=t&&t.property,e=n.targetProperty,r=t&&t.modelType,u,i,l,a;if(c.isDynamicBindingWithNonLocalSource(n))if(r===8)u={name:e,binding:f};else return w.error("For binding for property '{0}', encountered unsupported reference type '{1}'.".format(e,o.referenceTypeMap[r]||r)),null;else i=void 0,l=h.getModelValue(nt,f),l.exists?i=tt(l.value):r===5?i=t.constantValue:(a=h.getModelValue(s,f),a.exists&&(i=tt(a.value))),u={name:e,value:i};return!n.optional||(u.isOptional=!0),u}));if(l.firstIndex((function(n){return!n}))>=0)return null;v=s[o.PartContainerModelIdProperty];u={};u[o.PartContainerModelIdProperty]=v;var rt=e.Locator.fromJSON(i.locator),ut=a.buildIdentitySettingKey(rt,u),ft=t[ut]||undefined,et=st(i.locator),ot=ct(i.partState),ht=at(i.assetInstanceDefinition);return{position:{x:r.position.col,y:r.position.row,colSpan:b(r.colSpan),rowSpan:b(r.rowSpan)},metadata:{inputs:l,type:et,settings:
ft,isAdapter:i.adapterBindings?!0:undefined,viewState:ot,asset:ht,defaultMenuItemId:i.defaultMenuItemId}}}function ot(n,t,i,u){var h=n.metadata,p=ht(h.type),nt=lt(h.viewState),tt=vt(h.asset),w=v.getDefaultSize().name,it={NormalState:{size:w}},c={},k;c[o.PartContainerModelIdProperty]=f.observable(t);var b=e.Locator.fromJSON(p),rt=s.createIdentifier(ut.StartboardPart,b,i),l={locator:p,partState:nt,assetInstanceDefinition:tt,initialSize:w,widgetState:it,id:rt,bindingsInitialized:!0,dontSetupWidget:!1,defaultMenuItemId:h.defaultMenuItemId,childSettings:{},children:[],containerModel:r.toSerializableObject(c),overridesModel:undefined,editScopeId:undefined,bindings:undefined,adapterBindings:undefined,errorMessage:undefined,originalPartLocator:undefined},y=[];return h.inputs.forEach((function(n){var r=n.name,t,i=n.binding,u;i?t={property:i,modelType:8,cardinality:d.OneToOne,scope:g.CurrentContainer}:(u=n.value,t={property:r,constantValue:u,modelType:5,cardinality:d.OneToOne,scope:g.CurrentContainer});
y.push({source:t,targetProperty:r,optional:!!n.isOptional,isDynamicBinding:i?!0:undefined})})),h.isAdapter?l.adapterBindings=y:l.bindings=y,h.settings&&(k=a.buildIdentitySettingKey(b,c),u(k,h.settings)),l}function st(n){var r=encodeURIComponent,f=[],t=n,i,u,o;do i=r(e.LocatorType[t.type]),u=t.cloudName?r(t.cloudName):undefined,u&&(i=i+"["+u+"]"),o=[i,r(t.name)],f.unshift(o.join("/")),t=t.parent;while(t);return f.join("/")}function ht(n){var i=decodeURIComponent,u=[],r=[],t;return n.split("/").forEach((function(n,t){r.push(n);t%2==1&&(u.push(r),r=[])})),u.forEach((function(n){var s=i(n.pop()),r=n.pop(),f,o=r.match(/\[(.*?)\]/),u;o&&(r=r.substring(0,r.lastIndexOf(o[0])),f=i(o[1]));r=i(r);u={name:s,type:e.LocatorType[r]};f&&(u.cloudName=f);t&&(u.parent=t);t=u})),t}function ct(n){n=r.isSerializedObject(n)?r.fromSerializableObject(n):n;var f=u.keys(n).filter((function(n){return n!=="container"&&n!=="internal"})),t={};return i.shallowCopyFromObject(t,n,f),nt(t)?undefined:t}function lt(n){return r.toSerializableObject(
n||{})}function at(n){return nt(n)?undefined:{idInputName:n.assetIdInputProperty,type:n.assetType}}function vt(n){return n?{assetIdInputProperty:n.idInputName,assetType:n.type}:{}}function yt(n){if(!n)return undefined;var t=n.model,r=n.metadata,i={};return u.keys(t).forEach((function(n){i[n]={value:t[n],type:r[n]}})),i}function pt(n){if(!n)return undefined;var t={},i={};return u.keys(n).forEach((function(r){var u=n[r];t[r]=u.value;i[r]=u.type})),{model:t,metadata:i}}var rt=i.Base.Diagnostics,d=h.ReferenceCardinality,g=h.ReferenceScope,ut=o.CompositionType,nt=i.isEmpty,tt=f.unwrap,w=rt.createLog(n),b=function(n){return Math.min(Math.max(n,1),25)},it=c.createContainerModel,k=y.startBoardSettingsKey,ft=(function(){function n(){}return n.prototype.compress=function(n){var t=n.settings,i=n.title,r=t[k],f=yt(r.dashboardModel),e=u.keys(t).filter((function(n){return l.isStartboardPartKey(n)})).map((function(n){return et(n,t)})).filter((function(n){return!!n}));return{title:i,model:f,parts:e}},n.prototype.
uncompress=function(n,t,r,u){var f={},e=[],h;t.parts.forEach((function(n,t){var c=r?r(t):i.getUniqueId(),l=u?u(t):undefined,s=ot(n,c,l,(function(n,t){f[n]=t})),o,h;f[s.id]=s;o=n.position;h={id:s.id,colSpan:b(o.colSpan),rowSpan:b(o.rowSpan),position:{col:o.x,row:o.y}};e.push(h)}));try{var o=p.validateGrid(e),c=o.success,s=o.result;c||(h=s.overlappedParts.join(", "),w.warning("Part '"+s.misplacedPart+"' is misplaced and overlaps with '"+h+"'."))}catch(l){w.error(l,1)}var a={NormalState:{layoutSettings:{positions:e}}},v=pt(t.model),y={id:k,childSettings:{},locator:null,errorMessage:undefined,widgetState:a,dashboardId:n,dashboardTitle:t.title,dashboardModel:v};return f[k]=y,{id:n,title:t.title,settings:f}},n})();t.DashboardCompressor=ft}));define("MsPortalImpl/UI/Dashboard/PrivateDashboardRepository",["require","exports","f","o","./DashboardRepository","MsPortalImpl/Resources/ImplScriptResources","../../Services/Services.Settings","../../Services/Services.Settings.Schema"],(function(n,t,i,r,u,f,e,
o){"use strict";var s;return (function(t){function v(n){var i=r.keys(n);if(i.length>=100)throw new Error("There are no more dashboard stores available.");for(var f=i.map((function(t){return n[t].storeName})),u=0,t=w(u);f.indexOf(t)>-1;)t=w(++u);return t}function b(n){for(var f=r.keys(n).map((function(t){return n[t].title.toLowerCase()})),e=function(n){return f.indexOf(n.toLowerCase())>=0},i=function(n){return n<=1?a:a+" ("+n+")"},u=1,t=i(u);e(t);)t=i(++u);return t}function k(n,t,i,r){var u=r.settings[o.startBoardSettingsKey];u.dashboardId=i;n.setSetting(h(t),i,r);n.setSetting(s,i,{storeName:t,id:r.id,title:r.title});n.flushSettings()}function d(){var n=i.getUniqueId();return""+y+n}function g(n,t){return n[t]&&n[t].storeName}function nt(n){return!!h(n)}function tt(n){return n.queryStore(s).then((function(n){return n||{}}))}var rt=i.Base,ut=rt.Diagnostics,c=f.Dashboard,ft=ut.createLog(n),y="private/",l="recentDashboards",p=10,s=11,a=c.defaultTitle,w=e.getDashboardStoreName,h=e.getDashboardStoreId,
et=i.forEachKey,it;t.buildNextStoreName=v;t.createDashboardTitle=b;it=(function(){function n(n){this._settingsManager=n}return n.prototype.getTypeName=function(){return u.PrivateDashboardRepository},n.prototype.createDashboard=function(n){var r=this,t=n.extras&&n.extras.id||d(),i={id:t,title:n.title,settings:n.settings};return this._getDashboards().then((function(n){return k(r._settingsManager,v(n),t,i),i}))},n.prototype.readDashboard=function(n){var t=this;return this._getDashboards().then((function(i){var r=g(i,n);if(r)return t._settingsManager.querySetting(h(r),n)}))},n.prototype.updateDashboard=function(n,t){var r=this;return this.readDashboard(n).then((function(u){if(u){var f={};return i.shallowCopyFromObject(f,u),i.shallowCopyFromObject(f,t),r._getDashboards().then((function(t){var i=g(t,n)||v(t);return k(r._settingsManager,i,n,f),f}))}return r.createDashboard({title:t.title,settings:t.settings,extras:{id:n}})}))},n.prototype.deleteDashboard=function(n){var t=this._settingsManager;return tt(
t).then((function(i){var f=i[n],u,e,o;u=f?f.storeName:r.keys(i).filter(nt).first((function(t){return(i[t]||{}).id===n}));u&&t.deleteSettings({store:h(u),keys:[n]});e=u&&i[u]&&i[u].id===n;o=e?[u,n]:[n];t.deleteSettings({store:s,keys:o});t.flushSettings()}))},n.prototype.readDashboards=function(){return this._getDashboards().then((function(n){return r.keys(n).map((function(t){return n[t]}))}))},n.prototype.identifyDashboard=function(n){return i.startsWith(n,y)},n.prototype.isDashboardWritable=function(){return Q(!0)},n.prototype.getNotFoundMessage=function(n){return c.NotFound.privateMessageFormat.format(n.title)},n.prototype.canCreateNewDashboard=function(){return this._getDashboards().then((function(n){return r.keys(n).length<100}))},n.prototype.cloneDashboard=function(n,t){return this.createDashboard({settings:n,title:c.cloneTitleFormat.format(t)})},n.prototype.getRecentDashboards=function(){return this._settingsManager.querySetting(s,l).then((function(n){var t=(n||[]).slice(0,p).filter((function(
n){return!!n.id}));return i.unique(t,(function(n,t){return n.id.toLowerCase()===t.id.toLowerCase()}))}))},n.prototype.addToRecent=function(n){var t=this;return this.getRecentDashboards().then((function(r){var u=i.findIndex(r,(function(t){return t.id.toLowerCase()===n.id.toLowerCase()}));return u===0?r:(u>0&&r.splice(u,1),r.unshift({id:n.id,title:n.title}),r=r.slice(0,p),t._settingsManager.setSetting(s,l,r),r)}))},n.prototype.removeFromRecent=function(n){var t=this;return this.getRecentDashboards().then((function(r){var u=i.findIndex(r,(function(t){return t.id.toLowerCase()===n.toLowerCase()}));return u>=0&&(r.splice(u,1),t._settingsManager.setSetting(s,l,r)),r}))},n.prototype.createDefaultDashboard=function(n){var t;return t=n?Q(n):this._getDashboards().then((function(n){return b(n)})).catch((function(n){return ft.error(n,0,"Failed to generate a dashboard title with index."),a})),t.then((function(n){var t=d();return{id:t,title:n}}))},n.prototype._getDashboards=function(){var n=this;return tt(this._settingsManager).
then((function(t){var i={};return et(t,(function(t,r){if(r){var u;n.identifyDashboard(t)?(u=r,i[u.id]=u):nt(t)&&(u=r,i[u.id]||(i[u.id]=u))}})),i}))},n})();t.PrivateDashboardRepository=it})(s||(s={})),s}));define("MsPortalImpl/UI/Dashboard/DashboardClient",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function u(n){return new t(new r(n))}var r=(function(){function n(n){this._extensionManager=n}return n.prototype.connect=function(n,t,r,u){var f,e;return this._extensionManager.getExtensionByName(n,t).then((function(n){return f=n,Q(f.getViewModel(r(f)))})).then((function(n){return e=n,Q(u(n.content))})).finally((function(){i.disposeViewModelProperties(e);f&&e&&f.releaseViewModel(e)}))},n})(),t;n.ViewModelConnectorImpl=r;n.create=u;t=(function(){function n(n){this._connector=n}return n.prototype.getDashboard=function(n,t,i){return this._connector.connect(t,i,(function(n){return n.definition.dashboardProvider.viewModel}),(function(t){return t.getDashboard(n)}))},n})();n.DashboardClientImpl=
t})(r||(r={})),r}));define("MsPortalImpl/UI/Dashboard/RecommendedDashboardRepository",["require","exports","f","i","./DashboardRepository","FxHubs/CloudNameCommon"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function e(n){var i=n.substr(t.length),u=f.getCloudNameFromId(i),r;return i=f.removeCloudNameFromId(i),r=i.split("/"),{cloudName:u,dashboardParam:r.slice(1).join("/"),extensionName:r[0]}}var t="recommended/",o;n.parseDashboardId=e;o=(function(){function n(n,t){this._dashboardClient=n;this._compressor=t}return n.prototype.createDashboard=function(){return r.QReject("Cannot create a recommended dashboard")},n.prototype.readDashboard=function(n){var i=this,t=e(n);return this._dashboardClient.getDashboard(t.dashboardParam,t.extensionName,t.cloudName).then((function(t){return i._compressor.uncompress(n,t)}))},n.prototype.updateDashboard=function(){return r.QReject("Cannot update a recommended dashboard")},n.prototype.deleteDashboard=function(){return Q()},n.prototype.readDashboards=
function(){return Q([])},n.prototype.getTypeName=function(){return u.RecommendedDashboardRepository},n.prototype.identifyDashboard=function(n){return i.startsWith(n,t)},n.prototype.isDashboardWritable=function(){return Q(!1)},n})();n.RecommendedDashboardRepository=o})(e||(e={})),e}));define("_generated/Templates/WidgetsAvatarMenu",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-avatarmenu-dropdown"> <ul class="fxs-avatarmenu-list-system" role="presentation"> <li class="fxs-portal-hover" role="presentation"> <a href="" class="fxs-avatarmenu-signout" role="menuitem" data-bind=\'attr: { title: text.signOutLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: text.signOutLabel"><\/div> <div class="fxs-dropmenu-image fxs-fill-error" data-bind="image: data.icons.signout"><\/div> <\/a> <\/li> <\/ul> <div class="fxs-avatarmenu-scrollviewer"> <div class="fxs-avatarmenu-list-system"> <ul role="presentation"> <li class="fxs-portal-hover" data-bind="visible: changePasswordLink" role="presentation"> <a class="fxs-avatarmenu-changepassword" role="menuitem" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: changePasswordLink, title: text.changePasswordLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: text.changePasswordLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.launchCurrent"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: !!data.links.accessDetails" role="presentation"> <a class="fxs-avatarmenu-myaccess" role="menuitem" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: data.links.accessDetails, title: data.text.myAccessLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.myAccessLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.person"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: !!data.links.giveFeedback" role="presentation"> <a class="fxs-avatarmenu-feedback" role="menuitem" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: data.links.giveFeedback, title: data.text.feedbackLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.feedbackLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.feedback"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: data.links.accountPortal" role="presentation"> <a class="fxs-avatarmenu-billing" role="menuitem" href="" rel="noopener noreferrer"> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.billingLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="visible: data.links.accountPortal && data.links.accountPortal.startsWith(\'#\')"><\/div> <\/a> <\/li> <\/ul> <\/div> <div class="fxs-avatarmenu-list-tenant fxs-portal-border fxs-dropmenu-line-separator" data-bind="visible: listOfTenants().length" role="presentation"> <!-- ko if: listOfTenants().length --> <div class="fxs-avatarmenu-dropdown-title" id="avatarMenuTenantListId" data-bind="text: text.tenant" role="presentation"><\/div> <ul data-bind="foreach: listOfTenants" aria-labelledby="avatarMenuTenantListId" role="group"> <li class="fxs-portal-hover" role="presentation"> <a role="menuitemradio" data-bind="css: { \'fxs-avatarmenu-current-tenant fxs-portal-selected fxs-portal-activated\': $index() === 0 }, attr: { href: $index() === 0 ? \'#\' : \'\', \'aria-checked\': $index() === 0 }"> <div class="fxs-avatarmenu-tenant-name fxs-portal-text" data-bind="text: displayName, attr: { title: displayName }"><\/div> <div data-bind="text: domainName, attr: { title: domainName }" class="fxs-avatarmenu-tenant-uri"><\/div> <\/a> <\/li> <\/ul> <!-- /ko --> <\/div> <\/div> <\/div>'}
}));define("_generated/Templates/WidgetsAvatarMenuButton",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-avatarmenu-header fxs-trim-hover" data-bind="attr: { title: tooltip }"> <div class="fxs-avatarmenu-tenant-container"> <div class="fxs-avatarmenu-username" data-bind="text: displayName"><\/div> <div class="fxs-avatarmenu-tenant" data-bind="text: currentTenantDisplayName"><\/div> <\/div> <img class="fxs-avatarmenu-tenant-image" data-bind="attr: { src: avatarUri }" alt=""/> <\/div>'}}));define("MsPortalImpl/Widgets/Widgets.AvatarMenu",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","../Base/Telemetry","../../_generated/Templates/WidgetsAvatarMenu","../../_generated/Templates/WidgetsAvatarMenuButton","./Widgets.WidgetBase","./Widgets.DropMenu","MsPortalImpl/Base/Base.EventTypes","../../_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function v(n){return(n||
"").toLowerCase()}function y(n,t,i){var r=n.element.findByClassName(t);if(i)r.on(a.default.click,i);return r}function dt(n){var t=n.userIdentity(),i=t&&(t.displayName||gt(t));return i||n.text.defaultDisplayName}function gt(n){var t=n.firstName||"",i=n.lastName||"";return!t&&!i?"":tt.test(t)&&tt.test(i)?"":e.AvatarMenu.displayNameFormat.format(t,i)}function ni(n,t){return t().first((function(t){return n().tenantId===t.id}))}function ti(n,t){return u.pureComputed((function(){var u=n(),r=u&&v(u.tenantId),i=t();return i.length===1&&i[0]&&v(i[0].id)===r?[]:i.sort((function(n,t){var e=v(n.id),f,i,u;return e===r?-1:(f=v(t.id),f===r)?1:(i=n.displayName,u=t.displayName,i<u?-1:i>u?1:0)}))}))}var it=i.Base,at=it.Diagnostics.Telemetry,w=it.Images,vt=MsPortalImpl.Resources.Images,yt=window,b=yt.fx.environment.links,k=o.Source.TopBar,d=o.Action,g=at.trace,pt=vt.getAvatarMenu().defaultAvatarSmall,rt="fxs-avatarmenu",wt="fxs-avatarmenu-header",ut="fxs-avatarmenu-list-tenant",nt="fxs-avatarmenu-signout",ft="fxs-avatarmenu-billing",
et="fxs-avatarmenu-feedback",ot="fxs-avatarmenu-myaccess",bt="fxs-menu-account",st="signOut",ht="switchedTenant",ct="showDiagnostics",p=a.default.click,kt=(function(n){function t(){n.apply(this,arguments);this.dropMenu=new l.ViewModel(h(),s());this.userIdentity=u.observable();this.userInfo=u.observable();this.hideTenant=u.observable();this.listOfTenants=u.observableArray();this.showDiagnostics=null;this.openMenu=null;this.signOut=null;this.signedOut=null;this.switchTenant=null;this.switchedTenant=null;this.text=e.AvatarMenu;this.links=b;this.icons={feedback:w.Feedback(),signout:w.Signout({isLogo:!0}),person:w.Person({palette:99}),launchCurrent:w.LaunchCurrent()};this.avatarImage=u.observable();this.showDiagnosticsDelay=3e3}return __extends(t,n),t})(c.ViewModel),tt,lt;t.ViewModel=kt;tt=/^(f(irst)?|l(ast)?)\s?name$/i;lt=(function(n){function t(t,i){var a=this,h,r;n.call(this,t,i);this._lastTouchMillis=0;var f=this.element,o=this.ltm,s=i.dropMenu;f.addClass(rt);h=u.pureComputed((function(){return dt(
i)}));r=u.pureComputed((function(){var n=i.userInfo();return i.hideTenant()||!n?"":n.uniqueDirectoryName}));s.buttonClass=bt;u.computed(o,(function(){var n=e.AvatarMenu.label+" "+i.text.userLabel.format(h());r()&&(n=e.AvatarMenu.label+" "+i.text.userWithTenantLabel.format(r()));s.buttonLabel(n)}));this._dropMenuWidget=new l.Widget(f,s);var p=u.pureComputed((function(){var n=i.userIdentity(),r,f,e,o;if(!n)return"";var u=i.text.Tooltip,s=u.tenant,t=[];return(n.firstName||n.lastName)&&t.push(u.name.format(n.firstName||"",n.lastName||"")),n.displayName&&t.push(u.email.format(n.displayName)),r=ni(i.userIdentity,i.listOfTenants),r&&!i.hideTenant()&&(t.push(s.format(r.displayName,r.id)),f=r.domainName||"",e=n.tenantDomain,t.push(e&&v(f)!==v(e)?s.format(f,e):u.domain.format(f))),o=t.join("\n"),a._dropMenuWidget.options.buttonTooltip(o),o})),c=u.observable(pt),y=u.observable();u.reactor(o,(function(){var n=i.userIdentity(),t;n&&(y(n.changePasswordUri),n.isAnonymous||(c(n.defaultAvatarUri),t=i.avatarImage(
),t&&t.then((function(n){c(n)}))))}));u.applyBindingsToDescendants({data:i,func:this,displayName:h,listOfTenants:ti(i.userIdentity,i.listOfTenants),text:i.text,currentTenantDisplayName:r,tooltip:p,avatarUri:c,changePasswordLink:y},f[0]);u.reactor(o,i.dropMenu.isMenuOpen,(function(n){n&&a._reactToMenuOpen()}));this._attachEventHandlers()}return __extends(t,n),t.prototype.dispose=function(){this._dropMenuWidget.dispose();this._cleanElement(rt);n.prototype.dispose.call(this)},t.prototype._signOut=function(n){var t=f.Event(st),i=this.trigger(st,t,{completed:!!n});(g({source:k,action:d.AvatarMenuSignOut}),i)&&this.trigger("signedOut")},t.prototype._switchTenant=function(n){var t=this.options.userIdentity(),i=t&&v(t.tenantId);if(v(n.id)!==i){var r=f.Event(ht),u=this.trigger("switchTenant"),e={tenant:n};if(g({source:k,action:d.AvatarMenuSwitchTenant}),!u)return;this.trigger(ht,r,e)}},t.prototype._attachEventHandlers=function(){var n=this,i=this.options,t=this.element,r;this._holdStartHandler=function(
){n._lastTouchMillis=Date.now()};this._holdEndHandler=function(t){var r,u;n._lastTouchMillis&&(r=Math.abs(Date.now()-n._lastTouchMillis),n._lastTouchMillis=0,r>i.showDiagnosticsDelay&&(u=f.Event(ct),n.trigger(ct,u),t.preventDefault()))};this._accountPortalHandler=function(n){i.openAccountPortal();b.accountPortal.startsWith("#")&&n.preventDefault()};this._feedbackHandler=function(n){i.giveFeedback();b.giveFeedback.startsWith("#")&&n.preventDefault()};r=y(this,wt);r.on([a.default.touchstart,a.default.mousedown].join(" "),this._holdStartHandler);r.on([a.default.touchend,a.default.mouseup].join(" "),this._holdEndHandler);y(this,ft,this._accountPortalHandler);y(this,et,this._feedbackHandler);this.ltm.registerForDispose((function(){t.off(p,nt,n._signOutHandler);t.off(p,ft,n._accountPortalHandler);t.off(p,et,n._feedbackHandler);t.off(p,ut,n._tenantHandler);t.off(p,ot,n._myAccessHandler)}))},t.prototype._reactToMenuOpen=function(){var n=this,t=y(this,nt);if(t[0].focus(),g({source:k,action:d.AvatarMenuOpen}),
this._signOutHandler||y(this,nt,this._signOutHandler=function(t){n._signOut(!1);t.preventDefault()}),!this._tenantHandler)y(this,ut).on(a.default.click,"a",this._tenantHandler=function(t){t.preventDefault();n._switchTenant(u.dataFor(t.target))});this._myAccessHandler||y(this,ot,this._myAccessHandler=function(t){b.accessDetails.startsWith("#")&&t.preventDefault();n.options.showMyAccessBlade()})},t})(c.Widget);t.Widget=lt}));define("_generated/Templates/WidgetsTopBar",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-topbar-exit-customize"> <div class="fxs-topbar-exit-customize-message" data-bind="text: data.text.exitCustomizeText"><\/div> <button type="button" class="fxs-topbar-exit-customize-button fxs-button fxs-portal-button-primary" data-bind="text: data.text.exitCustomizeButton"><\/button> <\/div> <div class="fxs-topbar-content fxs-hide-in-customize" role="banner" aria-labelledby="bannerlabel"> <div class="fxs-topbar-internal fxs-bg-warning" data-bind="visible:data.showPreview, text: data.text.internalText"><\/div> <a href="#" id="bannerlabel" class="fxs-topbar-home fxs-trim-text-primary fxs-trim-hover" data-bind="text: data.productName, attr: { title: data.dashboardTooltip }"><\/a> <div class="fxs-breadcrumb" data-bind="stopBindings: true" role="presentation"><\/div> <!-- ko if: data.inDevMode --> <a class="fxs-topbar-exitdevmode fxs-trim-hover fxs-bg-warning" href="#" role="button" data-bind="text: data.text.exitDevModeLinkText, click: func._exitDevMode"><\/a> <!-- /ko --> <!-- ko if: data.canReportBug --> <a href="#" class="fxs-topbar-reportbug fxs-trim-hover fxs-bg-warning" role="button" data-bind="text: data.text.reportBug, click: func._reportBug, attr: { title: data.text.reportBugTitle, \'aria-label\': data.text.reportBug }"><\/a> <!-- /ko --> <div class="fxs-topbar-search" data-bind="stopBindings: true" role="presentation"><\/div> <div class="fxs-topbar-notifications fxs-trim-hover"> <a href="#" class="fxs-trim-svg fxs-topbar-button" role="button" data-bind="image: data.icons.notifications, attr: { title: data.text.notifications, \'aria-label\': data.text.notifications }"><\/a> <div class=\'fxs-notificationspane-progressbar fxs-display-none\'><div><\/div><\/div> <\/div> <div class="fxs-topbar-toast" role="presentation"><\/div> <a href="#" role="button" class="fxs-topbar-console fxs-topbar-button fxs-trim-hover fxs-trim-svg" data-bind="attr: { title: data.text.console }, image: data.icons.console"><\/a> <a href="#" class="fxs-topbar-settings fxs-menu-settings fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.settings }, image: data.icons.settings"><\/a> <!-- ko if: data.showFeedbackButton --> <a href="#" class="fxs-topbar-feedback fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.feedback }, image: data.icons.feedback"><\/a> <!-- /ko --> <a href="#" class="fxs-topbar-helpmenu fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.help }, image: data.icons.help"><\/a> <a href="#" class="fxs-topbar-peekmode fxs-topbar-button fxs-trim-hover fxs-trim-svg fxs-display-none" role="button" data-bind="attr: { title: data.text.peek }, image: peekModeIcon"><\/a> <div class="fxs-topbar-avatarmenu" data-bind="stopBindings: true"><\/div> <\/div> <div class="fxs-topbar-dashboard"> <div class="fxs-topbar-dashboard-message" data-bind="text: data.dashboardMessage"><\/div> <button type="button" class="fxs-button fxs-topbar-dashboard-done-customize" data-bind="text: data.text.exitCustomizeButton"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-view" data-bind="text: data.text.viewDashboardButton"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-save" data-bind="text: data.dashboardSaveButtonText"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-discard" data-bind="text: data.text.discardDashboardButton"><\/button> <\/div> <div class="fxs-loading5dots-container fxs-blade-progress-translucent" data-bind="visible: loading"> <div><\/div> <div><\/div> <div><\/div> <div><\/div> <div><\/div> <\/div>'}
}));define("MsPortalImpl/Widgets/Widgets.TopBar",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","../Base/Telemetry","./Widgets.AvatarMenu","./Widgets.BreadCrumbViewModel","./Widgets.BreadCrumb","./Widgets.WidgetBase","../../_generated/Templates/WidgetsTopBar","MsPortalImpl/Base/Base.EventTypes","../../_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";var p;return (function(n){var k=i.Base,t=k.Images,d=o.findByClassName,g=window.fx.environment,w=g.features,nt="fxs-topbar",tt="fxs-topbar-notifications",it="fxs-topbar-dashboard-done-customize",rt="fxs-topbar-console",r=s.Action,p=e.TopBar,b=y.default.fxexitorganizemode,ut,ft;n.fxfinishdashboardedit="fxfinishdashboardedit";ut=(function(n){function r(){n.apply(this,arguments);this.breadCrumb=new c.ViewModel;this.avatarMenu=new h.ViewModel;this.productName=i.encodeHtml(g.branding.productName);this.showPreview=u.observable(
i.isNullOrUndefined(w.internalonly)||w.internalonly==="true");this.text=e.TopBar;this.dashboardTooltip=e.KeyboardShortcuts.GoTo.dashboard;this.canReportBug=u.observable(!1);this.reportBug=f.noop;this.showFeedbackButton=w.feedback==="true";this.inDevMode=u.observable(!1);this.exitDevMode=f.noop;this.icons={settings:t.Settings({isLogo:!0}),help:t.Help({isLogo:!0}),console:t.Console({isLogo:!0}),notifications:t.Notifications({isLogo:!0}),feedback:t.SmileyHappy({isLogo:!0})};this.dashboardMessage=u.observable("");this.dashboardSaveButtonText=u.observable("");this.dashboardChanged=u.observable(!1);this.dashboardWritable=u.observable(!1);this.dashboardVisible=u.observable(!1);this.isInOrganizeMode=u.observable(!1);this.peekMode=u.observable(!1)}return __extends(r,n),r})(a.ViewModel);n.ViewModel=ut;ft=(function(e){function c(n,r,s){var w=this,a,c,b,k;e.call(this,n,r);this._loadingIdList=u.observableArray([]);a=this.ltm;n.addClass(nt).attr("role","presentation").html(v());i.isFeatureEnabled("movebreadcrumb")||
a.registerForDispose(new l.Widget(n.findByClassName("fxs-breadcrumb"),this.options.breadCrumb));a.registerForDispose(new h.Widget(n.findByClassName("fxs-topbar-avatarmenu"),this.options.avatarMenu));c=this.ltm;u.reactor(c,(function(){n.toggleClass("fxs-topbar-devmode",!!r.inDevMode()).toggleClass("fxs-bg-warning",!!r.inDevMode())}));u.reactor(c,(function(){var n=r.dashboardWritable(),i=n?p.saveDashboardButton:p.saveDashboardCopyButton,t;r.dashboardSaveButtonText(i);t=n?p.saveMessage:p.saveCopyMessage;r.dashboardMessage(t)}));var g=d(n,it),ut=d(n,"fxs-topbar-dashboard"),ft=f(".fxs-portal-main").add(n);if(u.reactor(c,(function(){ft.toggleClass("fxs-topbar-dashboard-changed",!!r.dashboardChanged());n.toggleClass("fxs-topbar-dashboard-visible",!!r.dashboardVisible());o.toggle(g,!!r.isInOrganizeMode());var i="fxs-portal-button-primary",u="fxs-button-default",f=ut.findByClassName("fxs-button"),t=f.filter(o.getUnhideSelector());t&&t.length&&(t.slice(1).removeClass(i).addClass(u),t.first().removeClass(
u).addClass(i))})),b=u.observable(),this._bindDescendants({loading:u.computed(this.ltm,(function(){return w._loadingIdList().length>0})),peekModeIcon:b}),this._attachEventHandlers(n),i.isFeatureEnabled("azureconsole")){k=i.memoizeQ((function(){var t;return i.require("MsPortalImpl/Widgets/Widgets.Console").then((function(n){return t=n})).then((function(){return w.options.getConsoleViewModel()})).then((function(i){return i.isVisible.subscribeAndRun(c,(function(t){n.findByClassName(rt).attr("aria-expanded",t)})),new t.Widget(s,i)}))}));n.findByClassName(rt).css("display","flex").attr({"aria-controls":s.attr("id"),"aria-expanded":"false"}).on(y.default.click,(function(n){n.preventDefault();n.stopPropagation();k().then((function(n){return n.toggle()}))}))}n.findByClassName("fxs-topbar-feedback").on(y.default.click,(function(n){n.preventDefault();r.feedbackButtonClick&&r.feedbackButtonClick()}));n.findByClassName("fxs-topbar-helpmenu").on(y.default.click,(function(n){n.preventDefault();r.helpButtonClick&&r.helpButtonClick(
)}));n.findByClassName(tt).on(y.default.click,(function(){r.notificationButtonClick&&r.notificationButtonClick()}));i.isFeatureEnabled("peekblades")&&i.isFeatureEnabled("nohozscroll")&&(o.unhide(n.findByClassName("fxs-topbar-peekmode").on(y.default.click,(function(n){w.trigger(y.default.fxpeekmode);n.preventDefault()}))),this.options.peekMode.subscribeAndRun(a,(function(n){b((n?t.Shell.ExitPeekMode:t.Shell.PeekMode)({isLogo:!0}))})))}return __extends(c,e),c.prototype.loadingHint=function(n,t){t?this._loadingIdList.push(n):this._loadingIdList(this._loadingIdList().filter((function(t){return t!==n})))},c.prototype.dispose=function(){this._cleanElement(nt);e.prototype.dispose.call(this)},c.prototype._reportBug=function(n,t){t.preventDefault();n.data.reportBug()},c.prototype._exitDevMode=function(n,t){t.preventDefault();n.data.exitDevMode()},c.prototype._attachEventHandlers=function(t){function u(n,i){var r=i&&{action:i}||undefined;t.trigger(n,r)}function i(n,i){t.on(y.default.click,n,i)}function f(
n,t){k.Diagnostics.Telemetry.trace({source:s.Source.TopBar,action:n,data:t})}function e(n,t,i){return function(r){r.preventDefault();t&&f(t,i);u(n)}}var o=this.options;i(".fxs-topbar-exit-customize-button, ."+it,e(b,r.CustomizeModeExited,{dashboardChanged:!!o.dashboardChanged(),onDashboard:!!o.dashboardVisible()}));i(".fxs-topbar-home",e(y.default.fxhomebuttonclick,r.HomeButtonClicked));i("."+tt,(function(n){n.preventDefault()}));i(".fxs-topbar-settings",e(y.default.fxsettingsbuttonclick));i(".fxs-topbar-dashboard-save",(function(){var t=o.dashboardWritable(),i=t?1:2,e=t?r.DashboardPublish:r.DashboardSaveACopy;f(e);u(n.fxfinishdashboardedit,i);i===1&&u(b)}));i(".fxs-topbar-dashboard-discard",(function(){f(r.DashboardDiscard);u(n.fxfinishdashboardedit,3);u(b)}));i(".fxs-topbar-dashboard-view",(function(){f(r.DashboardView);u(y.default.fxhomebuttonclick)}))},c})(a.Widget);n.Widget=ft})(p||(p={})),p}));define("MsPortalImpl/UI/Dashboard/DashboardManager",["require","exports","f","i","o","ko","$","./../../Base/Base.Router",
"./ArmDashboardRepository","./DashboardCompressor","./DashboardRepository","../../Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","./PrivateDashboardRepository","../../Services/Services.SelectedSubscriptions","../../Services/Services.Settings.Schema","../../Base/Telemetry","../Compositions/UI.Composition","../Compositions/UI.Composition.Base","../Compositions/UI.Composition.CompositionBinder","../Compositions/UI.Composition.Part","../Compositions/UI.Composition.PartSettingsManager","../Compositions/UI.Composition.StartBoard","../Compositions/UI.Composition.StartboardPart","./DashboardClient","./RecommendedDashboardRepository","../UI.DesktopManager","../../Widgets/Widgets.Common","../../Widgets/Widgets.StartBoard","../../Widgets/Widgets.TopBar"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st){"use strict";function wi(n){var r=n||{},u=r.model,f=r.metadata;return{model:i.extend2(t.defaultDashboardModelJson.model,u),metadata:
i.extend2(t.defaultDashboardModelJson.metadata,f)}}function lt(n,t,i){return new ui(n,t||new Error,i)}function sr(n){var t=n.services,e=new nr(t.settings),o=new ei(t),i=new h.DashboardCompressor,r=new oi(e,n.services.desktop.portalWidget.getTopBarWidget(),n.lifetime,o,i,n.services.storageService),c=new s.ArmDashboardRepository(n.lifetime,t.extensionManager,t.permissionsManager,i),u,f;return r.addRepository(c),u=rt.create(t.extensionManager),f=new ut.RecommendedDashboardRepository(u,i),r.addRepository(f),r}function bi(n){return n.id.toLowerCase().replace(/\/\/+/g,"/")}function wt(n,t){return bi(n)===bi(t)}function fi(n){return Q(n)}function gt(n,t){return nt.buildIdentitySettingKey(n,t)}function ni(n){return yt.start({source:li.Dashboard,action:n,actionModifier:rr.Start})}function ki(n,t,i,r){var u=i.id;return Q.allSettled(r.children.map((function(n){return Q(n.awaitComposed()).then((function(){return n.awaitOnInputsSetComplete()})).then((function(){return n}),(function(){return n}))}))).then((function(
i){yt.completeTrace(n,{success:!0,dashboardId:u,parts:i.map((function(n){var t=n.value;return{name:t.locator.toFriendlyString(),visible:et.isElementFullyInViewport(t.widget.element[0]).fullyVisible}})),interactionSource:t})}))}function di(n){var t=n&&n.widgetState||{};return t.NormalState&&t.NormalState.layoutSettings||{}}function hr(n){var t={},r=n[bt],e=di(r),o=[];return u.keys(n).filter((function(n){return tt.isStartboardPartKey(n)})).forEach((function(r){var u=n[r],a=l.Locator.fromJSON(u.locator),v=ai(u.containerModel),nt=gt(a,v),w=f.toJS(v),y,s,p,b,d,h,c;w[ii]=i.getUniqueId();y=ri(w);u.containerModel=g.getSerializableContainerModel(y,!1);s=k.createIdentifier(ci.StartboardPart,a);u.id=s;t[s]=u;p=n[nt];p&&(b=gt(a,y),t[b]=p);u.flags&2&&(d=l.Locator.fromJSON(u.originalPartLocator),h=gt(d,v),n[h]&&(t[h]=n[h]));c=(e.positions||[]).first((function(n){return n.id===r}));c&&(c.id=s,o.push(c))})),e.positions=o,t[bt]=r,JSON.parse(JSON.stringify(t))}function cr(n){var r=n&&n.relative,f=n&&n.absolute,t=
"",i,u;if(r){i=r.duration;u=r.timeUnit;switch(u){case 3:i===1&&(t=kt.pastWeek);break;case 1:i===1?t=kt.pastHour:i===24&&(t=kt.past24Hours)}}else f&&(t=kt.custom);return t}function lr(n){var t=n&&n.model&&n.model.model;return t&&t.timeRange}function vt(n,t){n&&o.updateDashboardUri(n.id,t)}function ht(n,t){n._startboard.widget.options.loading(t)}var si=i.Base,hi=si.Diagnostics,gi=i.Hubs.Notifications.NotificationStatus,nr=v.PrivateDashboardRepository,ci=b.CompositionType,tr=i.Composition.Configuration,ir=d.CompositionBinder,yt=hi.Telemetry,li=w.Source,ti=w.Action,rr=yt.ActionModifier,ur=window,pt=ur.fx,ct=hi.createLog(n),bt=p.startBoardSettingsKey,fr=10,ii=b.PartContainerModelIdProperty,er=nt.partIdentityStatePrefix,at=a.Dashboard,kt=a.Filter.Option,or=a.NavBar.home,dt=si.Constants.DefaultCloudName,ri=ir.createObservableModel,ai=g.createContainerModel,vi="create",yi="clone",pi="unpublish",ui,ei,oi;t.defaultDashboardModelJson={model:{timeRange:{relative:{duration:24,timeUnit:1}}},metadata:
{timeRange:tr.TimeRangeValueType}};t.backfillDashboardModel=wi;ui=(function(n){function t(t,i,r){n.call(this,{code:t,data:r||{},message:i.message,stack:i.stack,innerErrors:i})}return __extends(t,n),t.TypeName="MsPortalImpl.UI.DashBoardError",t})(i.Errors.Error);t.create=sr;t.isSameDashboard=wt;t.startTrace=ni;ei=(function(){function n(n){this._desktopManager=n.desktop;this._settingsManager=n.settings;this._notificationManager=n.notificationManager}return n.prototype.collectDashboardSettings=function(n){var h=this,u={},f=n.toJSON(),o=n.dashboardFiltersManager&&n.dashboardFiltersManager.toJSON(),t=n.children.filter((function(n){return!n.dontSetupWidget&&!n.isDisposed()})),s=n.widget.getDomOrderedChildren(),r;return t.length!==s.length&&ct.error("There should be the same number of composed parts to save ("+t.length+") as the number of positioned elements in the layout ("+s.length+"). The settings will be incorrect."),r=[],s.forEach((function(n){var u=i.remove(t,(function(t){return t.id===n}));if(
u.length!==1){ct.error("There should be a composed part with ID '"+n+"' yet none was found. The saved content will be incorrect. The settings will be incorrect.");return}r.push(h.getPartSettings(u[0]))})),t.length>0&&t.forEach((function(n){ct.error("Part '"+n.id+"' should have a position defined in the layout, yet none was found. The settings will be incorrect.");r.push(h.getPartSettings(n))})),Q.allSettled(r).then((function(n){return n.forEach((function(n){e.extend(u,n.value)})),o&&(f.dashboardModel.model.filterlocale=o.filterlocale,f.dashboardModel.model.filters=o.filters),u[bt]=f,JSON.parse(JSON.stringify(u))}))},n.prototype.getPartSettings=function(n){var t=this;return Q(n.awaitComposed()).then((function(){var o;if(n.isDisposed())return{};var s={},r=n.toJSON(),u=n.containerModel;return u[ii]||(o=f.toJS(ai(r.containerModel)),o[ii]=i.getUniqueId(),u=ri(o),r.containerModel=g.getSerializableContainerModel(u,!1)),s[r.id]=r,t.getPartIdentitySettings(n,u).then((function(n){return e.extend(s,n)}))})).
catch((function(t){return ct.error(t,8,"part: '"+n.id+"'."),{}}))},n.prototype.getPartIdentitySettings=function(n,t){var r=n.partDefinition,i;return!r||!r.partState?Q({}):(i=gt(n.locator,t),n.getPartSettingsManager().getStartboardPartIdentitySettings().then((function(n){if(!n)return{};var t={};return t[i]=n,t})).catch((function(t){return ct.error(t,9,"Failed to get part '"+n.id+"' identify settings for key '"+i+"'."),{}})))},n.prototype.clearStartboard=function(n,t){var i=this._desktopManager;n.children.filter((function(n){return!n.dontSetupWidget})).forEach((function(n){return i.removeTile(n.id,{force:!0,skipSave:t})}))},n.prototype.renderStartboard=function(n,t,r){var o=r.delayRendering,f=u.keys(t),h=function(n,t){var r={};return i.shallowCopyFromObject(r,n,t),r},c=f.filter((function(n){return i.startsWith(n,er)})),s,e;return this._settingsManager.setSettings({store:13,settings:h(t,c)}),s=t[bt],n.widget.options.applyViewSettings(s.widgetState),f=f.filter((function(n){return tt.isStartboardPartKey(
n)})),e=[],f.forEach((function(i){var u=t[i],r,f,o;try{r=l.Locator.fromJSON(u.locator)}catch(s){ct.error("Error derialization locator for part setting.\r\nError:'"+s+"'\r\nKey:'"+i+"'\r\nJSON:'"+u+"'")}r&&(f=r.getExtensionLocator(),(r.type===l.LocatorType.PartType||r.type===l.LocatorType.PartInstance&&r.parent&&r.parent.type===l.LocatorType.Lens&&r.parent.parent&&r.parent.parent.type===l.LocatorType.Blade)&&(o=n.services.extensionManager.getManifestByName(f.name,f.cloudName).then((function(){var o=l.Locator.forExtensionManifest(f.name,f.cloudName),s=r.type===l.LocatorType.PartType?o.withPartTypeRedirect(r.name):o.withPartInstanceRedirect(r.name,r.parent.parent.name,r.parent.name),t={},i,e;n.services.finder.tryLocate(s,t)&&(i=t.value,f=i.toExtension?l.Locator.forExtension(i.toExtension,f.cloudName):f,e=f.withPartType(t.value.toPart),u.originalPartLocator=u.locator,u.flags||(u.flags=0),u.flags|=2,u.locator=e.toJSON(),yt.trace({source:li.Dashboard,action:ti.Redirect,name:r.toFriendlyString(),
data:{to:e.toFriendlyString()}}))})).catch((function(n){ct.error("Error locating or applying part redirect.\r\nError:'"+n+"'\r\nKey:'"+i+"'\r\nJSON:'"+u+"'")})),e.push(o)))})),Q.all(e).then((function(){var i=[];f.forEach((function(u){var o=t[u],f=it.Instance.fromJSON(n.services,o),e=f.locator.getExtensionLocator(),s=n.services.extensionManager.getExtension(e.name,e.cloudName);(s||!r.isDefault)&&i.push(f)}));i.length&&(n.addChildren(i),o||i.forEach((function(t){t.compose(n.widget);t.save()})));o||(n.discardWidgetStateOfUnusedChildren(),n.save())}))},n.prototype.readDashboardsOfMaxCount=function(n,t,i,r){n=n.slice();i=i.slice();var u=[],e=i.map((function(n){return n.id.toLowerCase()})),f=function(){var i=n.shift();return i.readDashboards().then((function(n){return r(n,i.getTypeName()),n.filter((function(n){return e.indexOf(n.id.toLowerCase())<0})).slice(0,t-u.length)})).catch((function(n){var t=i.getTypeName();return ct.error(n,10,"Failed to read dashboards from '"+t+"' repository."),[]})).then((function(i)
{return u.push.apply(u,i),u.length>=t||!n.length?Q():f()}))};return f().then((function(){return u}))},n.prototype.enterOrganizeMode=function(n){var t=this._desktopManager;t.mode(1);n&&t.portalWidget.options.sideBar.isCollapsed(!n)},n.prototype.isStartboardReady=function(){return this._desktopManager.startBoardPartsLoaded()},n.prototype.getStartboardReadyPromise=function(){return this._desktopManager.getStartboardPartsLoadedPromise()},n.prototype.popNotification=function(n,t,i){i===void 0&&(i=gi.Error);this._notificationManager.addClientNotification({title:n,description:t,cloudName:dt,status:i,timestamp:new Date})},n})();t.DashboardHelperImpl=ei;oi=(function(){function n(n,t,r,u,e,o){var s=this;this.currentDashboardId=f.observable("");this._notifyDashboardChanged=i.throttle((function(){if(!s._startboard.notFound()){var n=s._privateRepo.identifyDashboard(s._curDashboard.id);n?s.saveCurrentDashboard():s._topbarWidget.options.dashboardChanged(!0)}}));this._privateRepo=n;this._topbarWidget=t;this.
_lifetime=r;this._helper=u;this._compressor=e;this._storage=o;this._otherRepos=[];this._isStartboardChanging=!1;this._isMigrated=!1;this._armDashboardCache=[];this._isStartboardShared=f.observable(!1)}return n.prototype.resetLayout=function(n){var t=this._helper,i=s.normalizedDashboard(pt.environment.defaultDashboard||{}),r=this._compressor.uncompress(at.defaultTitle,i);t.clearStartboard(n);t.renderStartboard(n,r.settings,{delayRendering:!1,isDefault:!0,isCurrentDashboardShared:this.isCurrentDashboardShared()})},n.prototype.isCurrentDashboardShared=function(){var n=this._curDashboard&&this._findOwningRepo(this._curDashboard.id);return n&&n.getTypeName()===c.ArmDashboardRepository},n.prototype.isCurrentDashboardWritable=function(){return this._isWritable(this._curDashboard.id)},n.prototype.getCurrentDashboardProperties=function(){var n=this._curDashboard,t=this._findOwningRepo(n.id);return t&&t.getDashboardProperties?t.getDashboardProperties(n):{id:n.id,title:n.title}},n.prototype.initialize=
function(n,t,r,u,f){var e=this,h,s;return this._startboard=n,this._registerEventHandlers(this._lifetime),h=i.isFeatureEnabled("addsessiondashboardrepository")?i.require("MsPortalImpl/UI/Dashboard/SessionDashboardRepository").then((function(n){var t=new n.SessionDashboardRepository(e._storage);e.addRepository(t)})):Q(),s=h.then((function(){return t?(e._isMigrated=!0,e._initDashboard(t,f)):e._migrateStartboard().then((function(){return f.dashboardMigration=pt.getTimestamp(),r?e.switchDashboard({id:r,title:r},"DeepLinkAfterMigration"):Q()}))})).then((function(){f.dashboardInitialized=pt.getTimestamp();(o.isDashboardRoute()||o.isDashboardUri()&&!t)&&vt(e._curDashboard,!0)})).catch((function(n){e._handleError(n,"initializeDashboard")})).finally((function(){ki(u,"PortalLoad",e._curDashboard,e._startboard).then((function(){f.dashboardRevealed=pt.getTimestamp()}))})),s.finally((function(){e._preloading()})),s},n.prototype.addRepository=function(n){this._otherRepos.push(n)},n.prototype.readDashboardsForType=function(
n){return this._getRepositoryByType(n).readDashboards()},n.prototype.startNewDashboard=function(){var n=this;return this._privateRepo.canCreateNewDashboard().then((function(n){if(n)return Q();throw lt(6,null,{action:vi});})).then((function(){return ht(n,!0),n._addToRecent(n._curDashboard)})).then((function(){return n._privateRepo.createDefaultDashboard()})).then((function(t){return n._setCurDashboard(t,!0),vt(t),n._isStartboardChanging=!0,n._helper.clearStartboard(n._startboard),n._isStartboardChanging=!1,n._startboard.save(),n._saveDashboard(n._curDashboard)})).then((function(){n._helper.enterOrganizeMode(!0)})).catch((function(t){n._handleError(t,"startNewDashboard")})).finally((function(){ht(n,!1)}))},n.prototype.saveCurrentDashboard=function(){var n=this;return this._saveDashboard(this._curDashboard).catch((function(t){n._handleError(t,"saveCurrentDashboard")}))},n.prototype.cloneCurrentDashboard=function(n){var t=this;return n===void 0&&(n=!0),this._privateRepo.canCreateNewDashboard().then((function(
n){if(n)return Q();throw lt(6,null,{action:yi});})).then((function(){return t._isStartboardChanging=!0,ht(t,!0),t._collectDashboardSettings(n,!0)})).then((function(n){return t._addToRecent(t._curDashboard).then((function(){return n}))})).then((function(n){return t._privateRepo.cloneDashboard(n,t._curDashboard.title)})).then((function(n){return vt(n),t._loadDashboard(n,!1,!0)})).then((function(){t._helper.enterOrganizeMode()})).catch((function(n){t._handleError(n,"cloneCurrentDashboard")})).finally((function(){t._isStartboardChanging=!1;ht(t,!1)}))},n.prototype.deleteCurrentDashboard=function(n){var t=this,i="deleteCurrentDashboard";return this._isStartboardChanging=!0,ht(this,!0),this._readNextDashboards(1).then((function(n){if(n.length<=0)throw lt(2);return n[0]})).then((function(r){return t._deleteDashboard(t._curDashboard,n).catch((function(n){return t._handleError(n,i)})).then((function(){return r}))})).then((function(n){return vt(n,!0),t._loadDashboard(n)})).catch((function(n){t._handleError(n,i)})).finally((function(
){t._isStartboardChanging=!1;ht(t,!1)}))},n.prototype.restoreCurrentDashboard=function(){var n=this;return this._isStartboardChanging=!0,ht(this,!0),this._loadDashboard(this._curDashboard).catch((function(t){n._handleError(t,"restoreCurrentDashboard")})).finally((function(){n._isStartboardChanging=!1;ht(n,!1)}))},n.prototype.switchDashboard=function(n,t){var i=this,r=wt(this._curDashboard,n),u;return(vt(n,r),r)?Q():(u=ni("DashboardRevealed"),ht(this,!0),Q(this._switchDashboard(n,!1)).finally((function(){ht(i,!1);ki(u,t,i._curDashboard,i._startboard)})))},n.prototype.populateQuickDashboards=function(n){var t=this;return this._readNextDashboards(fr,(function(i){i=t._curDashboard.id?[t._curDashboard].concat(i):i;n(i)}))},n.prototype.shareCurrentDashboard=function(n,t,i){var r=this,u=this._curDashboard;return ht(this,!0),this.shareCurrentDashboardToArm(n,t,i).then((function(n){return vt(n,!0),r._switchDashboard(n,!0)})).then((function(){return r._deleteDashboard(u,2)})).finally((function(){ht(r,!1)}))},n.
prototype.unshareCurrentDashboard=function(){var n=this,i="unshareCurrentDashboard",t=this._curDashboard;return this._privateRepo.canCreateNewDashboard().then((function(t){if(t)return Q();var r=lt(6,null,{action:pi});n._handleError(r,i);throw r;})).then((function(){return ht(n,!0),n._shareCurrentDashboard(c.PrivateDashboardRepository,t.title)})).then((function(t){return vt(t,!0),n._switchDashboard(t)})).then((function(){return n._deleteDashboard(t,3)})).finally((function(){ht(n,!1)}))},n.prototype.shareCurrentDashboardToArm=function(n,t,i){var r=this,u=ni(ti.DashboardPublishNew);return this._shareCurrentDashboard(c.ArmDashboardRepository,n,{subscriptionId:t,resourceGroupName:i}).then((function(n){return yt.completeTrace(u,{success:!0,dashboardId:n.id}),n})).catch((function(f){yt.completeTrace(u,{success:!1});var e=lt(7,f,{dashboardId:r._curDashboard.id,dashboardTitle:n,subscriptionId:t,resourceGroupName:i});r._handleError(e,"shareCurrentDashboardToArm");throw e;}))},n.prototype.shareCurrentDashboardToSession=
function(n){var t=this;return this._shareCurrentDashboard(c.SessionDashboardRepository,n).catch((function(i){var r=lt(7,i,{dashboardId:t._curDashboard.id,dashboardTitle:n});t._handleError(r,"shareCurrentDashboardToSession");throw r;}))},n.prototype._registerEventHandlers=function(n){var t=this,e=this._startboard,c=this._topbarWidget.element,s=this._topbarWidget.options,o=e.widget,l=o.element;e.setGetDashboard((function(){return i.clone(t._curDashboard)}));f.reactor(n,(function(){var n,i,r;t.currentDashboardId();n=lr(t._curDashboard);i=cr(n&&n());i&&(r=at.filterButtonTextFormat.format(i),o.options.filterButtonText(r))}));var a=function(n){n.stopPropagation();t._isMigrated&&t._helper.isStartboardReady()&&!t._isStartboardChanging&&t._notifyDashboardChanged()},v=function(n){n.stopPropagation();t._isMigrated&&t._helper.isStartboardReady()&&!t._isStartboardChanging&&t._notifyDashboardChanged()},h=function(n,i){var r,u,f;n.stopPropagation();r=i.part;r.getCompositionType()===ci.StartboardPart&&(u=r.
getViewModel(),u&&!u.container.operations.inProgress.peek()&&(f=t._privateRepo.identifyDashboard(t._curDashboard.id),(s.dashboardVisible()||f)&&t._notifyDashboardChanged()))},p=function(n){n.stopPropagation();var i=o.options;i.title().length===0&&(e.services.desktop.mode(1),i.title(at.untitled));t._notifyDashboardChanged()},w=function(n,i){if(n.stopPropagation(),s.dashboardChanged(!1),!e.notFound())switch(i.action){case 1:t.saveCurrentDashboard();break;case 2:t.cloneCurrentDashboard(!1);break;case 3:t.restoreCurrentDashboard()}},k=function(n){n.stopPropagation();t._migrateStartboard()},u=o.options;u.refreshDashboardList=function(n){return t.populateQuickDashboards(n)};u.updateDashboardUri=vt;u.switchDashboard=function(n){return t.switchDashboard(n,"RecentList")};u.title.subscribe(n,(function(n){t._curDashboard.title=n}));e.notFound.subscribe(n,(function(n){u.notFound(n)}));u.isShared(this.isCurrentDashboardShared());this._isStartboardShared.subscribe(n,u.isShared,(function(n){u.isShared(n)})
);y.selectedSubsUpdateTriggered.subscribe(n,(function(){var n=r.Azure.getAllSubscriptions(r.Rpc.client,dt),t=y.getSelectedSubscriptions(dt);Q.all([n,t]).spread((function(n,t){var i=n.length,r=t.length;u.subscriptionsInfo(r>=i?at.browseForAllSubs.format(i):at.browseForSelectedSubs.format(r,i))}))})).callback(null);n.registerForDispose([function(){e.removeGetDashboard()},l.setEvents([tt.fxstartboardsettingchanged,a],[b.fxreplacedpartcomposing,v],[nt.fxpartsettingchanged,h],[g.fxpartinputchanged,h],[ot.fxstartboardtitlechanged,p],[ot.fxmigratestartboard,k]),c.setEvents([st.fxfinishdashboardedit,w])])},n.prototype._setCurDashboard=function(n,t,i){var r,u,f,e;i===void 0&&(i=!1);n=n||{id:"",title:or};n&&(u=n.settings,f=u&&u[bt],r=f&&f.dashboardModel);r=wi(r);e={model:ri(r.model),metadata:r.metadata};this._curDashboard={id:n.id,title:n.title,isWritable:t,model:e};this._startboard.widget.options.title(n.title);this._topbarWidget.options.dashboardWritable(t);this.currentDashboardId(n.id);this._startboard.
notFound(i);this._isStartboardShared(this.isCurrentDashboardShared());this._startboard.dashboardFiltersManager&&this._startboard.dashboardFiltersManager.loadDashboard(r&&r.model)},n.prototype._switchDashboard=function(n,t){var i=this;return this._isStartboardChanging=!0,this._addToRecent(this._curDashboard).then((function(){return i._loadDashboard(n,!1,t)})).catch((function(n){i._handleError(n,"switchDashboard")})).finally((function(){i._isStartboardChanging=!1}))},n.prototype._findOwningRepo=function(n){var t=[this._privateRepo];return t.concat(this._otherRepos).first((function(t){return t.identifyDashboard(n)}))},n.prototype._getRepositoryByType=function(n){var t=[this._privateRepo];return t.concat(this._otherRepos).first((function(t){return t.getTypeName()===n}))},n.prototype._readDashboard=function(n){var i=this,t=n.id;return fi(this._findOwningRepo(t)).then((function(n){return n.readDashboard(t)})).then((function(n){if(!n)throw new Error("It succeeded in reading dashboard '"+t+"'. But the result is "+
n+".");return n})).catch((function(r){throw lt(1,r,{dashboardId:t,dashboardTitle:n.title,initDashboardIdFromStore:i.initDashboardIdFromStore});}))},n.prototype._collectDashboardSettings=function(n,t){var r=this,u=n?this._readDashboard(this._curDashboard):Q(null);return Q(u).catch(i.noop).then((function(n){return n?n.settings:r._helper.collectDashboardSettings(r._startboard)})).then((function(n){return t?hr(n):n}))},n.prototype._saveDashboard=function(n){var u=this,t=n.id,r=n.title,f=i.getCurrentCallStack(!0);return this._collectDashboardSettings().then((function(n){return fi(u._findOwningRepo(t)).then((function(i){var e=n&&n.Startboard,u=di(e),o=u.positions&&u.positions.length;return o||ct.warning("Saving empty dashboard.",0,f),i.updateDashboard(t,{settings:n,title:r})}))})).catch((function(t){throw lt(5,t,{dashboardId:n.id,dashboardTitle:r});}))},n.prototype._deleteDashboard=function(n,t){var e=this,r=n.id,f,u;return i.remove(this._armDashboardCache,(function(n){return n.id.toLowerCase()===r.toLowerCase(
)})),f=ni(ti.DashboardDelete),u=!0,this._removeFromRecent(r).then((function(){var n=e._findOwningRepo(r);return n.deleteDashboard(r)})).catch((function(t){u=!1;throw lt(4,t,{dashboardId:r,dashboardTitle:n.title});})).finally((function(){yt.completeTrace(f,{success:u,dashboardId:r,reason:t})}))},n.prototype._readNextDashboards=function(n,t){var r=this;t||(t=i.noop);var u=function(t,i){return t=i?s.filterDashboards(t,i):t,t.filter((function(n){return!wt(n,r._curDashboard)})).slice(0,n)},f=y.getSelectedSubscriptions(dt).catch((function(){return[]})),e=this._privateRepo.getRecentDashboards().catch((function(){return[]}));return Q.all([f,e]).spread((function(f,e){var o=f.map((function(n){return n.subscriptionId}));return(e=u(e,o),e.length>=n)?(t(e),Q(e)):r._privateRepo.readDashboards().catch((function(){return[]})).then((function(f){var s=i.union(e,f,wt);return(s=u(s),s.length>=n)?(t(s),s):(s=i.union(s,r._armDashboardCache,wt),s=u(s,o),t(s),s.length>=n)?s:r._helper.readDashboardsOfMaxCount(r._otherRepos,n-s.length,
s,(function(n,f){f===c.ArmDashboardRepository&&(r._armDashboardCache=n);s=i.union(s,n,wt);s=u(s);t(s)})).then((function(){return s}))}))}))},n.prototype._preloading=function(){var n=this;return this.readDashboardsForType(c.ArmDashboardRepository).then((function(t){n._armDashboardCache=t}))},n.prototype._isWritable=function(n){return fi(this._findOwningRepo(n)).then((function(t){return t.isDashboardWritable(n)})).catch((function(){return!0}))},n.prototype._addToRecent=function(n){return this._startboard.notFound()?Q():this._privateRepo.addToRecent(n).catch(e.noop)},n.prototype._removeFromRecent=function(n){return this._privateRepo.removeFromRecent(n).catch(e.noop)},n.prototype._loadDashboard=function(n,t,i,r){var u=this,f=n.id,o=i?Q(n):this._readDashboard(n),e=this._helper;return r=r||{},Q.all([this._removeFromRecent(f).then((function(){r.dashboardRemoveFromRecent=pt.getTimestamp()})),this._isWritable(f).then((function(n){return r.dashboardIsWritable=pt.getTimestamp(),n})),Q(o).then((function(n){return r.
dashboardRead=pt.getTimestamp(),n}))]).spread((function(n,i,r){return u._setCurDashboard(r,i),e.clearStartboard(u._startboard),e.renderStartboard(u._startboard,r.settings,{delayRendering:t,isCurrentDashboardShared:u.isCurrentDashboardShared()})})).catch((function(t){u._setCurDashboard(n,!0,!0);u._startboard.notFound()||u._startboard.save();throw t;}))},n.prototype._migrateStartboard=function(){var n=this,t=this._startboard.widget.options,i=a.NavBar.home;return this._helper.getStartboardReadyPromise().then((function(){return n._privateRepo.createDefaultDashboard(i)})).then((function(t){return n._setCurDashboard(null,!0),n._startboard.save(),n._saveDashboard(t).then((function(){return t}))})).then((function(i){t.headerMode(1);n._setCurDashboard(i,!0);n._startboard.save();n._isMigrated=!0})).catch((function(n){throw lt(3,n);}))},n.prototype._initDashboard=function(n,t){var i=this,r=this._startboard.widget.options;return r.headerMode(1),this._loadDashboard(n,!0,!1,t).then((function(){i._startboard.logChildren(
)}))},n.prototype._shareCurrentDashboard=function(n,t,i){var r=this._getRepositoryByType(n);return this._collectDashboardSettings(!0,!0).then((function(n){return r.createDashboard({title:t,settings:n,extras:i})}))},n.prototype._handleError=function(n,t){var o=this,e=this._startboard.widget.options,r=this._helper,u=at.Notification.errorTitle,i=at.Error,f=function(n,i){ct.error(n,n.code,t+": "+i)},s=function(n){var u=n.data,i=u.dashboardId,f=u.dashboardTitle;ct.warning(n,n.code,t+": Failed to find dashboard '"+i);var r=o._findOwningRepo(i),s={id:i,title:f},h=r&&r.getNotFoundMessage?r.getNotFoundMessage(s):at.NotFound.defaultMessageFormat.format(f);e.notFoundMessage(h)},h=function(){r.popNotification(u,i.cannotDelete)},c=function(n){f(n,"Failed to migrate startboard.");e.headerMode(2)},l=function(n){var t=n.data;f(n,"Failed to delete dashboard '"+t.dashboardId+"'");r.popNotification(u,i.failToDeleteFormat.format(t.dashboardTitle,n.message))},a=function(n){var t=n.data;f(n,"Failed to save dashboard '"+
t.dashboardId+"'.");r.popNotification(u,i.failToSaveFormat.format(t.dashboardTitle))},v=function(n){var f=n.data.action,t="";switch(f){case vi:t=i.cannotCreate;break;case yi:t=i.cannotClone;break;case pi:t=i.cannotUnpublish}r.popNotification(u,t)},y=function(n){var t=n.data,e=t.dashboardId,o=t.dashboardTitle,s=t.resourceGroupName,h=t.subscriptionId;f(n,"Failed to publish dashboard '"+e+"'");r.popNotification(u,i.failToPublishFormat.format(o,s,h,n.message))},p=function(){ct.error(n,0,t);r.popNotification(u,i.unknown)};if(n instanceof ui)switch(n.code){case 1:s(n);break;case 2:h();break;case 3:c(n);break;case 4:l(n);break;case 5:a(n);break;case 6:v(n);break;case 7:y(n)}else p()},n})();t.DashboardManagerImpl=oi}));define("MsPortalImpl/UI/UI.DesktopManagerView",["require","exports","f","i","o","ko","../Extension/Extension.Definition.Locator","../Base/Telemetry","./UI.DesktopManager","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(t){function v(
n,t){s.isTraceEnabled&&w.verbose("[DesktopManager] {0}\n  {1}\n  Model: {2}.".format(n,t.toString(),f.toJSON(t.getInputsOnlyViewModel())))}function b(n,t){return new c(n,t)}var y=r.Extension,l=i.Base.Diagnostics,p=l.Telemetry,a=window,w=l.createLog(n),c;t.showConfirmDialog=a.confirm.bind(a);c=(function(){function n(n,t){var i=this;this._portalWidget=n;this._panoramaWidget=n.getPanorama();this._contextPane=t;this._portalWidget.element.on(h.default.fxautosettings,(function(n,t){i._autoOpenedBy=t}))}return u.defineProperty(n.prototype,"portalWidget",{get:function(){return this._portalWidget},enumerable:!0,configurable:!0}),n.prototype.composeJourney=function(n){n&&(n.compose(this._panoramaWidget),n.isStartedWithContextBlade()||this._portalWidget.showJourney())},n.prototype.composeStartBoard=function(n){n&&n.compose(this._panoramaWidget)},n.prototype.addPartToStartBoard=function(n){n.compose(this._panoramaWidget.getStartBoardWidget())},n.prototype.addBlade=function(n,t){var f,r,u;return(v("Adding blade to desktop.",
n),f=n.parent,r=f.blades,p.trace({action:"JourneyLength",source:o.Source.Desktop,data:{count:r.length,blades:r.map((function(n){var t=n.locator;return{bladeName:t.name,extension:y.getWindowId(t.getExtensionLocator())}}))}}),n.flags&1)?this._contextPane.tryOpen(n).then(i.noop):(this._autoOpenedBy&&(u=n.masterContainer,u&&u.instanceId===this._autoOpenedBy.masterBladeId&&(t||(t={}),t.autoOpenedByBlade=this._autoOpenedBy.masterBladeId,t.autoOpenedByPart=this._autoOpenedBy.masterPartId),this._autoOpenedBy=null),n.compose(this._panoramaWidget.getJourneyWidget(),t),t&&t.focus&&n.awaitWidgetReadyToDisplay().done((function(){var i=n.containerWidget;i.element.trigger(h.default.fxensureviewportvisible,{widget:i,alignStart:t.alignToStart})})),Q())},n.prototype.removeBlade=function(n){v("Removing blade from desktop.",n);var t=this._contextPane;t.hasContent(n)?t.close(!0):this._panoramaWidget.removeChild(n.id)},n.prototype.removeAllBlades=function(n){var t=this._panoramaWidget.getJourneyWidget();t&&t.removeChildren(
n);var i=this._contextPane,r=i.getContent(),u=r&&r.locator;u&&u.type===e.LocatorType.Blade&&i.close(!0)},n.prototype.showConfirmDialog=function(n){return!!t.showConfirmDialog(n)},n})();t.DesktopManagerViewImpl=c;t.create=b})(c||(c={})),c}));define("MsPortalImpl/UI/UI.DesktopManagerImpl",["require","exports","f","i","o","ko","$","../Base/Base.Events","../Base/Base.Router","../Extension/DefinitionPreprocessor","../Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.Settings.Schema","../Services/Services.EditScopeManagement","../Base/Telemetry","./Compositions/UI.Composition","./Compositions/UI.Composition.Base","./Compositions/UI.Composition.Part","./Compositions/UI.Composition.StartBoard","./Compositions/UI.Composition.StartboardPart","./Dashboard/DashboardManager","./UI.DesktopManager","./UI.DesktopManagerView","../Extension/ViewModelManager","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,
it,rt){"use strict";function ii(n,t,i,r){return ct.startTrace({source:n,action:t,name:i,assetType:r})}function ri(){return wt("MsPortalImpl/UI/UI.Desktop.Actions")}function lr(n,t){var i=tt.create(n,t.contextPane);return new fi(i,t)}function ar(){return null}function vr(n,t){var i=[],r={},u=rr[p.CompositionType.StartboardPart];return er(n,(function(n,t){var f=k.isStartboardPartKey(n),e=ti(n,u+"-"+kt)||ti(n,u+"-"+dt);!f||e?r[n]=t:i.push(n)})),i.length&&t.deleteSettings({store:4,keys:i}),r}function yr(n){var t=n[a.startBoardSettingsKey]||{},i=t.dashboardId;return!i?null:{id:i,title:t.dashboardTitle||l.NavBar.home}}function yi(n,t){if(!t)return n;if(n){var i=t.toLowerCase(),r=(n.id||"").toLowerCase()===i;return r?n:{id:i,title:i}}return null}function ui(n,t,i){n.removeChild(t,!1,!i&&!t.dontSetupWidget)}function pi(n){return n&&n.locator&&n.locator.toFriendlyString()}function pr(t){var r=di.composePartViewModel,u=it.registerWithState,f=n.normalize("./UI.BladeLauncher"),i;u("Shell$BladeLauncherViewModel",
f,(function(n,t){return r((function(i){return new n.BladeLauncher(i,t)}),{initialState:t,createSelectable:!0,logArea:f})}));i=n.normalize("./UI.AssetBladeLauncher");u("Shell$AssetBladeLauncherViewModel",i,(function(n,u){return r((function(i){return new n.AssetBladeLauncher(i,u,t)}),{initialState:u,createSelectable:!0,logArea:i})}))}function wr(n,t,i,r){var u,f="Unable to replace part '"+(n&&n.toString())+"', ";return n&&t?n.isDisposed()?u=f+"it has already been disposed.":n.getPartsContainer()?n.widget&&n.parent&&n.parent.widget||(u=f+"the part or its parent have not been composed."):u=f+"it is not a child of a PartsContainerComposition.":u="Replace part requires a part and a new locator.",u&&r&&r(u),!!u==!1}var wi=c.Locator,lt=c.LocatorType,at=r.Extension,bi=at.CloudName,ki=r.TriggerableLifetimeManager,di=r.ViewModels.Part,ot=i,ei=ot.Base,gi=ei.Constants,nr=gi.ExtensionNames,bt=nr.Hubs,oi=ei.Diagnostics,tr=oi.Telemetry,ir=ot.Parts,rr=p.CompositionType,et=nt.DesktopManagerEvents,st=ot.Helpers,
ur=c.DefinitionFinderImpl,si=i.deepEquals,hi=i.getUniqueId,ht=i.tryImmediateResolve,kt="AssetBladeLauncher",dt="BladeLauncher",gt=window,ut=oi.createLog(n),vt=y.Source.Desktop,yt=y.Action,pt=l.Desktop,ft={noActiveJourney:"Desktop has no active journey.",noBladeInJourney:"Blade '{0}' does not exist in the current journey.",noTileInDesktop:"Tile with id '{0}' was not found on the desktop."},ni=a.desktopSettingsKey,ct=tr,br=gt.fx.environment,ci=8,fr=4,er=ot.forEachKey,ti=ot.startsWith,wt=ot.require,li=wi.forExtension,or=et.journeyDeactivated,sr=et.journeyDiscarded,ai=et.journeyCreated,hr=et.settingsLoaded,cr="./Compositions/UI.Composition.Journey",vi="./Compositions/UI.Composition.Blade",fi;t.organizeModeModules={dragDrop:"MsPortalImpl/UI/UI.DragDropCompositionManager"};t.createDesktopManager=lr;t.getCurrent=ar;t.resolveInitialDashboard=yi;fi=(function(){function r(n,t){this._previousActiveJourney="";this._startboardPartsLoadedDeferred=Q.defer();this._loadedStartBoardPartIds={};this._mode=
f.observable(0);this._lifetime=new ki;this._hubsCloudName=at.getHubsCloudName();this._dashboardMgrDeferred=Q.defer();this.activeJourney=f.observable(null);this.commandsEnabled=f.observable(!0);this._loadingJourneyGuid=null;this._view=n;this._services=t;this._initDeferred=st.Deferred();this._sharedSettings=t.settings;this._portalServices=t;pr(this._services.assetTypeService)}return r.prototype.startBoardPartsLoaded=function(){return Q.isFulfilled(this.getStartboardPartsLoadedPromise())},r.prototype.getStartboardPartsLoadedPromise=function(){return this._startboardPartsLoadedDeferred.promise},u.defineProperty(r.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0}),u.defineProperty(r.prototype,"isJourneyLoading",{get:function(){return this._loadingJourneyGuid!==null},enumerable:!0,configurable:!0}),r.prototype.initialize=function(n,i,r){var u=this;this._setupOrganizeModeComponents(t.organizeModeModules);this._extensionsMetadata=n;this._services.assetManager.onAssetDeleted(
(function(n,t,i,r){ri().then((function(f){f.handleAssetDeleted(u,n,t,i,r)}))}));var o=g.startTrace("DashboardRevealed"),e=s.getDashboardIdFromUri(),f=this._dashboardMgr=g.create({services:this._services,lifetime:this._lifetime});return i.then((function(n){r.startboardSettingsLoaded=gt.fx.getTimestamp();var t,h=n&&n[ci]||{},i=n&&n[fr]||{},s=yr(i);return(r.dayZero=!i[ni])?(u._startBoard=k.create(u._createCompositionServices()),u._view.composeStartBoard(u._startBoard),u._populateStartBoardFromManifests().then((function(){u._startboardPartsLoadedDeferred.resolve()})),u._initDeferred.resolve()):(t=yi(s,e),u.load(h,i,t&&t.id)),f.initDashboardIdFromStore=s?s.id:"",f.initialize(u._startBoard,t,e,o,r).finally((function(){r.dashboardManagerInitialized=gt.fx.getTimestamp();u._dashboardMgrDeferred.resolve(f);u._initDeferred.resolve()}))})),Q(this._initDeferred.promise())},r.prototype.resetStartBoard=function(n){var t=this,i;return i=n?Q(6):this._services.getService("DialogManager").then((function(n){return n.
showModalDialog({title:l.Startboard.resetConfirmationTitle,description:l.Startboard.resetConfirmationText,buttons:4})})),i.then((function(n){var r,i;if(n===6){for(r=t.startBoard.children,i=r.length-1;i>=0;i--)t.removeTile(r[i].id,{force:!0});t._populateStartBoardFromManifests()}}))},r.prototype._populateStartBoardFromManifests=function(){var n=this,t;return this._dashboardMgr.resetLayout(this._startBoard),this.save(),t=this._services.extensionManager.getExtensions().map((function(t){var r=n._extensionsMetadata.first((function(n){return at.isEqualDescriptor(n,t)})),i=r.startBoardParts;if(r.isTestExtension||i&&i.length)return t.getManifestAsync().then((function(t){n._addStartBoardPartsFromManifest(t,i);n.save()}))})).filter((function(n){return!!n})),Q.allSettled(t)},r.prototype._getExtensionEmailAddress=function(n){var t=this._extensionsMetadata.first((function(t){return t.name===n}));return t&&t.feedbackEmail},r.prototype.getCurrentBladeInfo=function(){var n=this._getBreadCrumb(),i=this._getExtensionEmailAddress(
bt),r=n[n.length-1],t=r&&r.extensionName||"",u=t?this._getExtensionEmailAddress(t):i;return{extensionName:t,feedbackTo:u,feedbackCC:i,breadcrumb:n.map((function(n){return n.title})).join(" > ")}},r.prototype._getBreadCrumb=function(){var t=this.getActiveJourney(),n;return t?(n=t.children,!n||!n.length)?[]:n.map((function(n){return{title:n.isDefaultTitle()?n.id:n.title(),extensionName:n.locator.getExtensionLocator().name,id:n.id}})):[]},r.prototype.createJourney=function(t,i,r){var u=this,s=this._startBoard.children.first((function(n){return n.id===t})),o;return s?(o=st.Deferred(),r||(r=hi(),this._loadingJourneyGuid=r,this._createNewJourneyPromise=o.promise()),o.promise().finally((function(){u._loadingJourneyGuid===r&&(u._loadingJourneyGuid=null,u._createNewJourneyPromise=null)})),ht(Q(s.awaitComposed()),(function(){if(u.tryDeactivateJourney(r)){e(u).trigger(et.journeyCreating,i);var t=u._createCompositionServices(),f=ii(vt,yt.JourneyOpened,pi(s));ht(wt(cr,n),(function(r){return u.setActiveJourney(
r.create(t,s)),ht(wt(vi,n),(function(n){var r=n.create(t,i,u._startBoard),s=u._activeJourney;s.addChild(r);u._view.composeJourney(s);u._startBoard.detailContainers=[r];u._view.addBlade(r,{assetType:i.originAssetType,focus:!0,reusableWidget:i.reusableWidget}).catch((function(n){ut.error(n)}));u._triggerActiveJourneyChanged();u.save();o.resolve(s);e(u).trigger(ai);ct.completeTrace(f);Q.nextTick((function(){u.save()}))}))})).catch((function(n){o.reject(n)}))}else o.reject("tryDeactivateJourney returned false")})),o.promise()):(ut.error(ft.noTileInDesktop.format(t)),ut.verbose(f.toJSON(this.getDiagnosticsData(),null,2)),st.Deferred().reject())},r.prototype.createJourneyForBlade=function(n,t){return this._createJourneyWithHiddenPart(bt,dt,n,t,dt,this._hubsCloudName,n.cloudName,n.defaultMenuItemId)},r.prototype.createJourneyForAsset=function(n,t,i){return this._createJourneyWithHiddenPart(bt,kt,{extensionName:n.extension,assetType:n.assetType,assetId:i},t,kt,this._hubsCloudName,n.cloudName,n.defaultMenuItemId,
n.assetType)},r.prototype._createJourneyWithHiddenPart=function(n,t,r,u,f,o,s,h,c){var l=this,y,p,a,v;return this._loadingJourneyGuid!==u?Q():(y=ii(vt,yt.JourneyOpened,f,c),bi.addToModel(s,r),p=li(n,o).withPartType(t),a=this.addPartToStartBoard({originPartLocator:p,model:r,defaultMenuItemId:h,reuseExistingPart:!1,dontSetupWidget:!0}),a.isComposed&&a.isSelected()&&this._activeJourney&&this._activeJourney.originTile===a?(this.portalWidget.showJourney(),v=Q()):v=a.selectOnReady((function(){return l._loadingJourneyGuid!==u?!1:!a.isSelected()&&l.tryDeactivateJourney(u)}),{timeoutInMilliseconds:9e4}).then((function(n){n&&(l.save(),e(l).trigger(ai),ct.completeTrace(y))})),i.tryImmediateFinally(v,(function(){l._loadingJourneyGuid===u&&(l._loadingJourneyGuid=null)})))},r.prototype.openSingleBlade=function(n,t){return this._openBlade(n,t,(function(n,i){return i===0&&n.locator.equals(t.locator)}))},r.prototype.openMultipleBlades=function(n,t){var u=this,i=st.Deferred(),r;return t&&t.length!==0?(r=t.map((function(
t){return u._openBlade(n,t,(function(n){return n.locator.equals(t.locator)&&t.model&&n.getViewModel()&&p.deepSubset(n.getViewModel(),t.model)}))})),e.when.apply(e,r).done((function(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];i.resolve(t)})).fail((function(){i.reject()}))):i.resolve([]),i.promise()},r.prototype.confirmBladesCanClose=function(n){var t=this,o=(n||[]).first((function(n){return!t.canCloseBlade(n)})),r,u,f,e;return o?(r=this.activeJourney(),u=[],n.forEach((function(n){var i=t._findFirstItemIndex(r.children,n,ft.noBladeInJourney.format(n));u.push(r.children[i])})),f=[],i.pushUnique(f,i.mapMany(u,(function(n){return t._getAlertMessageRecursive(n)}))),e=f.join("\n"),this._view.showConfirmDialog(e||pt.confirmEditScopeDiscard)):!0},r.prototype.forceCloseBlade=function(n,t,i){var e,r,u=this._activeJourney,f,o,s;if(!u)throw new Error(ft.noActiveJourney);e=this._findFirstItemIndex(u.children,n,ft.noBladeInJourney.format(n));r=u.children[e];this._startBoard.detailContainers.length===
1&&this._startBoard.detailContainers[0].id===r.id?this.forceDiscardJourney(u.id,t):(f=r.masterContainer,f&&(o=f.detailContainers,s=o.indexOf(r),s>=0&&(o.splice(s,1),i&&i.openBlade||f.onDetailContainersChanged())),this._closeBladeRecursive(r,e,t));this._triggerActiveJourneyChanged();this.save()},r.prototype.tryCloseBlade=function(n,t){var i=this.confirmBladesCanClose([n]);return i&&this.forceCloseBlade(n,t),i},r.prototype.closeChildBlades=function(n){var i=this.discardEditsOfBlade(n,{includeSelf:!1,includeDescendants:!0}),t;if(i.successful)for(t=n.detailContainers.length-1;t>=0;t--)this.forceCloseBlade(n.detailContainers[t].id,1);return i},r.prototype.discardEditsOfPart=function(n,t){var r=n.getPartsContainer();return this._discardEditsOfContainer(r,t.force,(function(u){var s=u.path,l=n.journeyPath,e=r.journeyPath,h=si(s,l),c=!1,f,o;if(!h&&s.length>e.length){f=void 0;try{f=i.parseSortedString(u.path[e.length])}catch(a){ut.error("Failed to parse journey path segment for blade '{0)'. Path: '{1}'. Error: '{2}'.".
format(r.toString(),JSON.stringify(e),a.message))}c=f&&f.master&&f.master.part===n.id}return o=u.value,o&&o.editScope&&(t.includeSelf&&h||t.includeDescendants&&c)}))},r.prototype.discardEditsOfBlade=function(n,t){return this._discardEditsOfContainer(n,t.force,(function(i){var r=i.value,u=i.path,f=n.journeyPath,e=si(u,f),o=!e&&(r.type===lt.Blade||u.length>=f.length+2);return r&&r.editScope&&(t.includeSelf&&e||t.includeDescendants&&o)}))},r.prototype._discardEditsOfContainer=function(n,t,i){var o=this,u=[],s=n,h=n instanceof k.Instance||s.isInitialized,r={confirmationRequired:!1,successful:!1},e=this._activeJourney,f;if(!e)throw new Error(ft.noActiveJourney);return f=e.ambientSettings,h&&(u=f.getItemsInPath(n.journeyPath).filter(i)),r.confirmationRequired=!t&&u.filter((function(n){var t=n.value.editScope;return t.dirty&&!t.saving})).length>0,(!r.confirmationRequired||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(r.successful=!0,u.forEach((function(n){f.removeItem(n.path);o._services.
editScopeManager.onEditScopeDisposed(n.value.editScope.editScopeId)}))),r},r.prototype.canCloseBlade=function(n){var t=this._activeJourney,r=this._findFirstItemIndex(t.children,n,ft.noBladeInJourney.format(n)),u=t.children[r],i=function(n){if(n.shouldAlertOnClose()||n.isInitialized&&!n.children.some((function(n){return n.children.some((function(n){return n.suppressAlert()}))}))&&t.ambientSettings.getItemsInPath(n.journeyPath).some((function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving})))return!0;var r=n.detailContainers;return!r||r.length===0?!1:(r||[]).some((function(n){return i(n)}))};return!i(u)},r.prototype.addPartToStartBoard=function(n){var i,t,r,u,f;if(!n){ut.error("options should be specified for adding a part to the startboard.");return}if(!n.originPartLocator){ut.error("options.originPartLocator should be specified for adding a part to the startboard.");return}return i=this._createCompositionServices(),r=n.model,n.reuseExistingPart!==!1&&(t=this._startBoard.children.
first((function(t){return t.matchesLocatorAndModel(i.finder,n.originPartLocator,r,n.defaultMenuItemId)}))),t||(t=d.create(i,n.originPartLocator,r,{modelContainsSensitiveData:n.modelContainsSensitiveData}),t.dontSetupWidget=!!n.dontSetupWidget,u=n.defaultMenuItemId,u&&(t.defaultMenuItemId=u),ir.InternalPartSize[n.initialSize]&&(t.initialSize=n.initialSize,n.initialSize===99&&(t.initialHeight=n.initialHeight,t.initialWidth=n.initialWidth)),f=t.id,this._isStartBoardPartLoaded(f)||(this._isStartBoardPartLoaded(f,!0),this._startBoard.addChild(t,undefined,!t.dontSetupWidget),this._view.addPartToStartBoard(t),t.save(),this.save())),t},r.prototype.pinMultipleParts=function(n,t,i,r){var u=this,f=this._createCompositionServices();return ri().then((function(e){return e.pinMultipleParts(u,f.finder,n,t,i,r)}))},r.prototype.removeTile=function(n,t){var e=this._startBoard,i=e.children.first((function(t){return t.id===n})),r,u;if(i){r=void 0;u=this._activeJourney;u&&u.originTile===i&&(r=u.id);var f=i.editScopeId(
)&&this._services.editScopeManager.getStateObservable(i.editScopeId()),s=!f||f()===v.EditScopeState.NotDirty||f()===v.EditScopeState.DirtyAndSaving,h=!r||this._canDiscardJourney(r),o=t&&t.force||s&&h;(o||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(r&&this.forceDiscardJourney(r),i.clearIdentitySettings(),ui(e,i,t&&t.skipSave),o||i.dontSetupWidget||ut.warning("Part '{0}' is removed from the start board.".format(i)),this.save())}},r.prototype.replacePart=function(n,t,i){var o=this,f=n&&n.id,r,s=this._createCompositionServices(),u=st.Deferred(),h=!0,c,l,e;return i=i||{},wr(n,t,i.newPartContainerModel,(function(n){l=n}))?(n instanceof d.Instance?(r=d.create(s,t,i.newPartContainerModel,{id:f,doNotSaveSettings:i.doNotSaveSettings,overridesModel:i.newPartOverridesModel}),e=n,r.dontSetupWidget=e.dontSetupWidget,h=!e.dontSetupWidget):r=b.create(s,t,f,i.newPartContainerModel,i.newPartOverridesModel),r.previousLocator=n.previousLocator||n.locator,r.flags|=4,c=n.getPartsContainer(),n.
dispose(!0),n.parent.replaceChild(n,r),r instanceof d.Instance&&this._activeJourney&&this._activeJourney.originTile===n?this.tryDiscardJourney(this._activeJourney.id):c.getPartsContainer().detailContainers.slice(0).reverse().forEach((function(n){n.masterPartId===f&&o.tryCloseBlade(n.id,1)})),r.widgetState(n.widgetState()),r.save(),h?(r.widget=n.widget,r.recompose(n.parent.widget)):r.compose(n.parent.widget),r.widget.element.trigger(p.fxreplacedpartcomposing,{part:r}),r.awaitComposed().then((function(){!i.preventNewPartActivation&&r.partDefinition.details&&r.partDefinition.details.length>0?r.selectOnReady((function(){return!o._activeJourney}),{timeoutInMilliseconds:15e3}).then((function(){u.resolve(r)})).catch((function(n){u.reject(n&&n.message||"part.selectOnReady failed")})):u.resolve(r)}),(function(){u.reject("Unable to compose the mutated part.")}))):u.reject(l),u.promise()},u.defineProperty(r.prototype,"portalWidget",{get:function(){return this._view.portalWidget},enumerable:!0,configurable:!0}),
r.prototype.getDashboardManager=function(){return this._dashboardMgrDeferred.promise},r.prototype.getSettingCollections=function(){var i={},r={},n=this._activeJourney,t=[];return i[ni]=JSON.parse(JSON.stringify(this)),t.push({store:4,settings:i}),n&&n.children&&(r[n.id]=JSON.parse(JSON.stringify(n)),t.push({store:ci,settings:r})),t},r.prototype.dispose=function(){this._lifetime&&(this._lifetime.dispose(),this._lifetime=null)},r.prototype.save=function(){var n=this;this._initDeferred.promise().finally((function(){n.getSettingCollections().forEach((function(t){n._services.settings.setSettings(t)}))}))},r.prototype.load=function(n,t,r){var u=this,s=this._createCompositionServices(),f=t[ni],o=!1,h,c;f&&f.startBoardId&&t[f.startBoardId]?(h=t[f.startBoardId],o=!!r,o&&(t=vr(t,this._sharedSettings)),this._startBoard=k.Instance.fromJSON(s,t,h)):(ut.error("Unable to load StartBoard state from user settings, setting does not exist. Creating a default StartBoard."),this._startBoard=k.create(s));this._removeOrphanedStartboardParts(
);this._view.composeStartBoard(this._startBoard);o||this._initDeferred.resolve();c=this._view.portalWidget.element;c.one(rt.default.fxshowstartboard,(function(){var n=u._startBoard.children.slice();n.forEach((function(n){u._displayPartOnStartBoardIfAvailable(n)}));u._startBoard.discardWidgetStateOfUnusedChildren();u._startboardPartsLoadedDeferred.resolve();i.isFeatureEnabled("nohozscroll")||(u._loadingJourneyGuid=null)}));e(this).trigger(hr)},r.prototype._removeOrphanedStartboardParts=function(){var n=this.startBoard;n.children.slice(0).forEach((function(t){t.dontSetupWidget&&ui(n,t)}))},u.defineProperty(r.prototype,"startBoard",{get:function(){return this._startBoard},enumerable:!0,configurable:!0}),r.prototype.getActiveJourney=function(){return this._activeJourney},r.prototype.setActiveJourney=function(n){this.activeJourney(n);this._activeJourney=n;this.portalWidget.hasActiveJourney=!!n;n&&o.isFullscreen()&&o.exitFullscreen()},r.prototype.generateLoadingJourneyGuid=function(){return this._loadingJourneyGuid=
hi(),this._loadingJourneyGuid},r.prototype.tryDeactivateJourney=function(n){var t=this._activeJourney,r,i,u;if(t){if(!this.confirmBladesCanClose(t.children.map((function(n){return n.id}))))return!1;for(r=t.children.filter((function(n){return!n.isRestorable()})),i=r.length-1;i>=0;i--)this.forceCloseBlade(r[i].id);u=ii(vt,yt.JourneyDeactivated,pi(t.originTile));t.save();this._closeActiveJourney(!0);this.save();e(this).trigger(or);ct.completeTrace(u)}else this._startBoard&&(this._startBoard.detailContainers=[]);return this._loadingJourneyGuid=n||null,!0},r.prototype.tryDiscardJourney=function(n){var t=!1;return(this._canDiscardJourney(n)||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(this.forceDiscardJourney(n),t=!0),t},r.prototype._triggerActiveJourneyChanged=function(){var n=this._activeJourney,t=n?JSON.stringify(n):"";this._previousActiveJourney!==t&&(e(this).trigger(et.activeJourneyChanged),this._previousActiveJourney=t)},r.prototype._canDiscardJourney=function(n){var t=this.
_activeJourney&&this._activeJourney.id===n&&this._activeJourney,i=t&&t.ambientSettings.getObservable().peek().some((function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving&&t.disposeOnJourneyDiscard}));return!t||!i},r.prototype.forceDiscardJourney=function(n,t){var i=!1;this._deleteJourneySettings(n);this._activeJourney&&this._activeJourney.id===n&&(this.isJourneyLoading||this.portalWidget.showStartBoard(),this._closeActiveJourney(!1,t),i=!0);i&&(this._triggerActiveJourneyChanged(),this.save(),e(this).trigger(sr))},r.prototype._deleteJourneySettings=function(n){this._sharedSettings.deleteSettings({store:8,keys:[n]})},r.prototype.toJSON=function(){return{startBoardId:this._startBoard?this._startBoard.id:null}},r.prototype._addStartBoardPartsFromManifest=function(n,t){var r=this,i=n.startBoardParts,u=li(n.name,n.cloudName);t||(t=i.map((function(n){return n.name})));i&&i.length&&t.forEach((function(n){var t=i.first((function(t){return t.name===n})),f;t&&(f=u.withStartboardPartInstance(
t.name),r.addPartToStartBoard({originPartLocator:f,initialSize:t.initialSize}))}))},r.prototype._createCompositionServices=function(n){return n?i.extend2(this._services,{finder:n,desktop:this,sharedSettings:this._sharedSettings}):this._thisCompositionServices||(this._thisCompositionServices=i.extend2(this._services,{finder:new ur(this._services.extensionManager),desktop:this,sharedSettings:this._sharedSettings}))},r.prototype._findPartContainer=function(n){var t,i=this._startBoard;if(i&&i.id===n)t=i;else if(this._activeJourney)t=this._findFirstItem(this._activeJourney.children,n,ft.noBladeInJourney.format(n));else throw new Error(ft.noActiveJourney);return t},r.prototype._openBlade=function(t,i,r){var s=this,o=this._findPartContainer(t),v=o instanceof k.Instance,h=st.Deferred(),u,c,y=this._createCompositionServices(),l,a;return o?((o.detailContainers||[]).forEach((function(n,t){n.locator.equals(i.locator)&&n.masterPartId===i.masterPartId&&n.masterInvocationProperty===i.masterInvocationProperty&&
r(n,t)&&(u=n,h.resolve(u))})),u?(a=u.containerWidget,a&&a.setFocus(),nt.isTraceEnabled&&ut.verbose("[DesktopManager] Found a previously opened detail blade."+"\n  Existing blade: {0}. Model: {1}.".format(u.toString(),f.toJSON(u.getInputsOnlyViewModel()))+"\n  Requested Descriptor: {0}.".format(f.toJSON(i)))):(e(this).trigger(et.bladeOpening,{masterContainerId:t,bladeDescriptor:i}),l=function(){v&&o.detailContainers.length===0?s.createJourney(i.masterPartId,i).finally((function(n){n&&n.children&&n.children.length>0?h.resolve(n.children[0]):h.reject()})):ht(wt(vi,n),(function(n){return ht(Q(),(function(){u=n.create(y,i,o);o.detailContainers.unshift(u);o.onDetailContainersChanged();c=v?0:1+s._findFirstItemIndex(s._activeJourney.children,o.id,ft.noBladeInJourney.format(o.id));s._activeJourney.addChild(u,c);s._view.addBlade(u,{assetType:i.originAssetType,alignToStart:!!(i.flags&8),index:c,reusableWidget:i.reusableWidget,focus:!i.reusableWidget}).catch((function(n){ut.error(n)}));s._triggerActiveJourneyChanged(
);s.save();h.resolve(u)}))})).catch((function(n){h.reject(n)}))},this._createNewJourneyPromise?this._createNewJourneyPromise.always((function(){l()})):l())):h.reject(),h.promise()},r.prototype._closeBladeRecursive=function(n,t,i,r){this._removeBladesFromUIRecursive(n);this._disposeBladesRecursive(n,t,r);r||n.parent.save();r||e(this).trigger(et.bladeClosed,{id:n.id,reason:i})},r.prototype._getAlertMessageRecursive=function(n){var t=function(n){var t=n.detailContainers,r;return t&&t.length!==0?(r=i.mapMany(t,(function(n){return n.getAlertOnCloseMessages()})),i.union(n.getAlertOnCloseMessages(),r)):n.getAlertOnCloseMessages()};return t(n)},r.prototype._removeBladesFromUIRecursive=function(n){for(var i=n.detailContainers,t=i.length-1;t>=0;t--)this._removeBladesFromUIRecursive(i[t]);this._view.removeBlade(n)},r.prototype._disposeBladesRecursive=function(n,t,i){var f=this,r=n.parent,u=r.children.indexOf(n,t);i?n.dispose(!0):r.removeChildAt(u,undefined);n.detailContainers.forEach((function(n){f._disposeBladesRecursive(
n,u,i)}))},r.prototype._closeActiveJourney=function(n,t){var u=this,i=this._activeJourney,r;this.setActiveJourney(null);this._startBoard.detailContainers=[];i&&(i.children.slice(0).forEach((function(i){i.isDisposed()||u._closeBladeRecursive(i,0,t,n)})),r=i.originTile,r&&r.dontSetupWidget&&!n&&this.removeTile(r.id),i.dispose(n));this._view.removeAllBlades((function(n){ut.error("DesktopManager: Found un-tracked blade '{0}' in view after closing active journey. It will be forcefully removed.".format(n))}))},r.prototype._findFirstItem=function(n,t,i){var r=this._findFirstItemIndex(n,t,i);return n[r]},r.prototype._findFirstItemIndex=function(n,t,i){var r=n.firstIndex((function(n){return n.id===t}));if(r===-1){ut.verbose(f.toJSON(this.getDiagnosticsData(),null,2));throw new Error(i);}return r},r.prototype.pinPartComposition=function(n){this._startBoard.addChild(n);this._view.addPartToStartBoard(n);ct.trace({source:vt,action:yt.DashboardPinPart,data:"Part pinned to dashboard: "+(n.extension&&n.extension.
name)+"_"+n.id});n.save();this.save()},r.prototype._isStartBoardPartLoaded=function(n,t){return typeof t=="boolean"?this._loadedStartBoardPartIds[n]=t:!!this._loadedStartBoardPartIds[n]},r.prototype._displayPartOnStartBoardIfAvailable=function(n){var r=this;if(!this._isStartBoardPartLoaded(n.id)){this._isStartBoardPartLoaded(n.id,!0);var t=n.locator,i=t.getExtensionLocator(),u=function(t,i){if(ut.warning(t.format(n)),i){var u=r._startBoard;ui(u,n);u.removeChildWidget(n.id)}},f=function(t,i){var f=!1;return t===0?(i||r._view.addPartToStartBoard(n),f=!0):t===1&&(u("[Definition Change] Part '{0}' is not working because it no longer exists in pre-loaded extension definition"),f=!0),f},e=function(i,f){(i.startBoardParts||[]).some((function(n){return n.name===t.name}))?f||r._view.addPartToStartBoard(n):u("[Definition Change] Part '{0}' is not working because it no longer exists in force-loaded extension definition.")};this._extensionsMetadata.some((function(n){return at.isEqualDescriptor(n,i)}))?
f(n.definitionExists(),n.isComposed||n.dontSetupWidget)||(this._view.addPartToStartBoard(n),t.type===lt.StartboardPartInstance?this._services.extensionManager.getManifestByName(i.name,i.cloudName).then((function(n){e(n,!0)})):this._services.extensionManager.getExtensionByName(i.name,i.cloudName).then((function(n){var r=h.PinPrefix,u=t.name,f,i;if(ti(u,r))return f=u.substr(r.length),n.getBladeDefinition(f);for(i=t;i;i=i.parent)if(i.type===lt.Blade)return n.getBladeDefinition(i.name);if(t.type===lt.PartType)return n.getPartDefinition(t.name)})).then((function(){f(n.definitionExists(!0),!0)}))):u("[Definition Change] Part '{0}' will be removed because the extension it belongs to is no longer known by the portal.",!0)}},r.prototype.getDiagnosticsData=function(){var n=this._startBoard,t=this._activeJourney;return{startboard:n&&n.getDiagnosticsData(),activeJourney:t&&t.getDiagnosticsData()}},r.prototype.getAssetDiagnosticsData=function(){var n=this._activeJourney;return n?ri().then((function(t){return t.
dumpCompositionAssets(n)})):Q.resolve("No journey")},r.prototype._setupOrganizeModeComponents=function(n){var t=this,i=this._lifetime,r=i.createChildLifetime();this.mode.subscribe(r,(function(u){u===1&&ot.require(n.dragDrop).then((function(n){n.create(i,t,t.portalWidget.element);r.dispose()}))}))},r})();t.DesktopManagerImpl=fi}));define("MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop",["require","exports","f","o","$","../Interactions/Interactions.DismissHandler","MsPortalImpl/Base/JQueryHelper","../Widgets/Widgets.WidgetBase","../Widgets/Widgets.FlowLayout","../Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){function yt(n,i){var o=n.target,r=u(o),h;l&&l.htmlTarget!==o||(l={htmlTarget:o,elementObject:r,width:r.outerWidth(!1),height:r.outerHeight(!1)},l&&l.htmlTarget!==o)||(v=p=t=nt(r.closest(it),s.Widget),b.appendTo(r.parent()),h=b.parent(),i.helper.css({position:"fixed",top:i.offset.top,left:i.
offset.left,marginTop:0-h.scrollTop(),marginLeft:0-h.scrollLeft(),pointerEvents:"none"}),e.hide(r),k=a=g(i.helper),f.register(ot,!0))}function pt(n,i){var r=l.elementObject,u=r.draggable("option","revert");f.unregister(ot);u&&r.draggable({revert:!1});rt();u?ht():st(i.helper);e.unhide(r);t?t===p?gt(i.helper):ni(i.helper):dt();b.remove();ct()}function wt(){l.elementObject.draggable({revert:!0}).trigger(c.default.mouseup)}function bt(n,i){var r;(st(i.helper),t)&&(r=g(i.helper),r.col!==a.col||r.row!==a.row)&&(rt(),a=r,(v!==t||t.dropPlaceholder===null)&&(v&&v.disposeDropPlaceholder(),t.createDropPlaceholder(l.width,l.height),v=t),t.moveDropPlaceholder(r),w=ut.setTimeout((function(){w=null;e.unhide(l.elementObject);t.moveChild(l.elementObject,a.col,a.row,!1);e.hide(l.elementObject)}),at))}function rt(){w&&(ut.clearTimeout(w),w=null)}function st(n){var i=kt(n);t&&t!==i&&ht();t=i}function ht(){t&&(rt(),t.refreshLayout())}function kt(n){var t=n.offset(),i=b.parent(),r=i.scrollTop(),f=i.scrollLeft(
),e=t.left-f+Math.floor(d*y.GridSpacingWidth),o=t.top-r+Math.floor(d*y.GridSpacingHeight),h=u(document.elementFromPoint(e,o)),c=h.closest(it);return nt(c,s.Widget)}function g(n){var i=t.element,r=i.offset(),u=n.offset(),f=u.left-r.left+i.scrollLeft(),e=u.top-r.top+i.scrollTop(),o=Math.floor((f+d*y.GridSpacingWidth)/y.GridSpacingWidth),s=Math.floor((e+d*y.GridSpacingHeight)/y.GridSpacingHeight);return{col:o,row:s}}function dt(){p.moveChild(l.elementObject,k.col,k.row,!0)}function gt(n){a=g(n);p.moveChild(l.elementObject,a.col,a.row,!0)}function ni(n){t.refreshLayout();a=g(n);var i=h.Widget.getId,r=i(l.elementObject),u=p.element.closest(et),f=t.element.closest(et),e=i(u),o=i(f);t.element.trigger(c.default.fxrearrange,{partId:r,sourceId:e,targetId:o,col:a.col,row:a.row})}function ct(){v&&v.disposeDropPlaceholder();p=null;t=null;k=null;a=null;v=null;l=null}function lt(){var t=u(it),n=[];return t.each((function(t,i){var r=nt(u(i),s.Widget),f=r.options;f.allowReorder&&!f.locked()&&n.push(r.element.
findByClassName("fxs-flowlayout-childcontainer"))})),n}var y=i.Widgets.AzureGrid,ut=window,nt=o.Widget.getWidget,ft="fxs-drag-disableTouchAction",tt=".fxs-tile:not(.fxs-tilesize-herowidefitheight):not(.fxs-tilesize-fullwidthfitheight):not(.fxs-tilesize-fittocontainer)",it=".fxs-flowlayout",et=".fxs-lens",ot={dismissFn:function(){wt()},shouldDismissOnMouseDownFn:u.noop,shouldDismissOnMouseWheelFn:u.noop,logName:"flowlayoutdragdrop"},l,p,t,v,k,a,w,at=250,d=.33,b=u("<div class='fxs-drag-surface'><\/div>"),vt={start:yt,drag:bt,stop:pt,cursor:"move",helper:"clone",appendTo:b,opacity:.65,distance:3,cancel:"input,textarea,button,select,option,.fxs-tile-actionbar-contextmenu"},ti=(function(){function n(){if(n._singleton)throw new Error("FlowLayoutDragDrop operates as a singleton.");n._singleton=this}return n.prototype.dispose=function(){this.disableDragDropTargets();ct();n._singleton=null},r.defineProperty(n,"Instance",{get:function(){return n._singleton||(n._singleton=new n),n._singleton},enumerable:
!0,configurable:!0}),n.prototype.enableDragDropOnSingleTarget=function(n){n.draggable("instance")||n.filter(tt).addClass(ft).draggable(vt)},n.prototype.enableDragDropTargets=function(){var n=this;lt().forEach((function(t){t.on(c.default.mouseenter,tt,(function(t){var i=u(t.currentTarget);if(i.draggable("instance")){i.draggable("option","handle",!1);return}n.enableDragDropOnSingleTarget(i)}))}))},n.prototype.disableDragDropTargets=function(){lt().forEach((function(n){n.off(c.default.mouseenter,tt)}));u(".ui-draggable:not(.ui-draggable-dragging)").removeClass(ft).draggable("destroy")},n})();n.FlowLayoutDragDrop=ti})(l||(l={})),l}));define("_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-desktop-organize .fxs-tile .fxs-tile-content{z-index:0}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay{display:block;-ms-touch-action:none;touch-action:none}.fxs-desktop-normal .fxs-hide-in-normal,.fxs-desktop-normal .fxs-portal-contextpane-left,.fxs-desktop-organize .fxs-contextpane .fxs-tile .fxs-tile-overlay,.fxs-desktop-organize .fxs-sidebar,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-actions,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-dropdown,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-migration{display:none}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay:hover{border-width:1px;border-style:solid;box-sizing:border-box}.fxs-desktop-organize .fxs-tile.fxs-tilesize-hero.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herotall.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herowide.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-large.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-mini.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-normal.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-small.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-tall.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-wide.fxs-tile-selected .fxs-tile-overlay{cursor:move}.fxs-desktop-organize .fxs-blade-locked .fxs-tile .fxs-tile-overlay:hover{border:none}.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-context .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-contextaction .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-help .fxs-tile div.fxs-tile-overlay{background-color:transparent}.fxs-desktop-organize .fxs-hide-in-customize{visibility:hidden}.fxs-desktop-organize .fxs-startboard-layout>.fxs-flowlayout-childcontainer{min-height:2155px;min-width:3865px}.fxs-desktop-organize .fxc-hotspot-customclick{z-index:1}")})
);define("MsPortalImpl/UI/UI.DesktopModeManager",["require","exports","f","o","$","../Base/Base.Events","../Interactions/Interactions.DismissHandler","../Interactions/Interactions.FlowLayoutDragDrop","../Widgets/Widgets.WidgetBase","../Widgets/Widgets.Tile","MsPortalImpl/Base/Base.EventTypes","../../_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){function g(n,r,f){var e=n.desktop,a=new l(e,r,n,f),p=function(n){var t=u(n.target).closest(b);return s.Widget.getWidget(t,h.Widget)},d=r.element,v=r.getPanorama().getStartBoardArea();d.on(c.default.fxexitorganizemode,(function(){e.mode(0);var n=e.startBoard.widget.element.findByClassName("fxs-startboard-button-edit");n.length?n.focus():r.showStartBoard()}));v.on(c.default.fxenterorganizemode,(function(n,t){n.stopPropagation();var r=p(n);t=u.extend({},t);i.isNullOrUndefined(t.trigger)&&(t.trigger=r?0:1);a.startPartManagment(t);r&&(r.options.selected(!0),a.updateTileSelection(
r),r.showTileManagementContextMenu())}));v.on(c.default.click,w,(function(n){var i=p(n),t=i&&i.options;t&&!t.locked()&&(t.selected(!t.selected()),a.updateTileSelection(i))}));v.on(c.default.click,t,(function(n){if(e.mode()===1){var i=p(n),t=i&&i.options;!t||t.locked()||t.selected()||(t.selected(!0),a.updateTileSelection(i))}}));v.on(c.default.mouseenter,t,(function(n){var r,u,i;if(e.mode()!==1&&(r=p(n),u=r&&r.options,u&&!u.locked()&&!u.selected())){i=r.element;o.FlowLayoutDragDrop.Instance.enableDragDropOnSingleTarget(i);i.hasClass(y)&&i.draggable("option","handle",t);i.one(c.default.mouseleave,(function(){e.mode()!==1&&o.FlowLayoutDragDrop.Instance.disableDragDropTargets()}))}}));v.on(c.default.dragstart,k,(function(n){e.mode()!==1&&(e.mode(1),u(n.target).draggable("option","handle",!1));var t=p(n),i=t&&t.options;i&&!i.selected()&&(i.selected(!0),a.updateTileSelection(t))}));v.on(c.default.fxpartcreated,(function(n,t){n.stopPropagation();var i=t.widget;i.options.selected(!0);a.updateTileSelection(
i)}));return a}var p=MsPortalImpl.Resources.Images,a=s.Widget.widgetRemoveEvent,w="."+h.overlayClassName,b="."+h.widgetClassName,t="."+h.actionBarContainerClassName,v="fxs-desktop-normal",y="ui-draggable",k="."+y,d="fxs-partgallery-container",l;(function(){var t=p.getFlowLayout().gridShadow,i=".fxs-desktop-organize .fxs-flowlayout-childcontainer {"+("background: url("+t+");")+"}",n=document.createElement("style");n.setAttribute("type","text/css");n.appendChild(document.createTextNode(i));document.head.appendChild(n)})();n.organizeModeClassName="fxs-desktop-organize";n.createDesktopModeManager=g;l=(function(){function t(n,t,i,r){var f=this;this._wasContextPaneCollapsed=!1;this._dismissHandle={dismissFn:function(){f._desktop.mode(0)},shouldDismissOnMouseDownFn:u.noop,shouldDismissOnMouseWheelFn:u.noop,logName:"desktopmodemanager"};this._desktop=n;this._portalWidget=t;this._services=i;this._lifetime=r;this._userSettingsManager=i.settings;this._contextPane=i.leftContextPane;this._partMgmtStarted=
!1;this._selectedTile=null;this._handleModeChange(n,r)}return r.defineProperty(t.prototype,"selectedTile",{get:function(){return this._selectedTile},enumerable:!0,configurable:!0}),t.prototype.updateTileSelection=function(n){var t=this;if(this._deselectCurrentTile(),n.options.selected()&&(this._selectedTile=n),this._selectedTile)this._selectedTile.element.on(a,this._tileRemoveHandler=function(n){n.target===t._selectedTile.element[0]&&t._deselectCurrentTile()})},t.prototype.startPartManagment=function(n){var t=this,r;return this._partMgmtStarted?Q():(this._partMgmtStarted=!0,this._desktop.mode(1),r=this._contextPane,Q.all([i.require("MsPortalImpl/UI/UI.PartGalleryManager"),r.tryOpen(this)]).spread((function(i){var u=t._partGalleryManager,f=t._partGallery;u||(u=t._partGalleryManager=i.createPartGalleryManager(t._lifetime.createChildLifetime(),t._services,f),u.load(5,n));f.setFocus();n.expandTileGallery&&r.collapsed(!1)})))},t.prototype.onAddingContent=function(n){var t=this;return i.require(
"MsPortalImpl/Widgets/Widgets.PartGallery").then((function(i){t._partGallery||(t._partGallery=i.create(u("<div class='"+d+"'><\/div>")),n.addChild(t._partGallery.element))}))},t.prototype.onRemovingContent=function(){this._partMgmtStarted=!1},t.prototype._enterOrganizeMode=function(){var i=this._portalWidget,r=i.element,t;return(r.addClass(n.organizeModeClassName),r.removeClass(v),t=i.getTopBarWidget(),t&&t.options.isInOrganizeMode(!0),e.register(this._dismissHandle),o.FlowLayoutDragDrop.Instance.enableDragDropTargets(),this._wasContextPaneCollapsed=this._contextPane.collapsed(),!this._partMgmtStarted)?this.startPartManagment({}):Q()},t.prototype._exitOrganizeMode=function(){var r=this._portalWidget,u=r.element,t,i;o.FlowLayoutDragDrop.Instance.disableDragDropTargets();u.removeClass(n.organizeModeClassName);u.addClass(v);t=r.getTopBarWidget();t&&t.options.isInOrganizeMode(!1);i=this._contextPane;i.close(!0);i.collapsed(this._wasContextPaneCollapsed);this._deselectCurrentTile();this._userSettingsManager.
flushSettings();e.unregister(this._dismissHandle)},t.prototype._handleModeChange=function(n,t){var i=this;n.mode.subscribe(t,(function(n){switch(n){case 1:i._services.getService("DialogManager").then((function(n){n.dismissOpenDialog()}));i._enterOrganizeMode();f.isFullscreen()&&f.exitFullscreen();break;case 0:default:i._exitOrganizeMode()}}))},t.prototype._deselectCurrentTile=function(){this._selectedTile&&(this._selectedTile.element.off(a,this._tileRemoveHandler),this._tileRemoveHandler=null,this._selectedTile.options.selected(!1),this._selectedTile=null)},t})();n.DesktopModeManagerImpl=l})(l||(l={})),l}));define("MsPortalImpl/UI/Compositions/UI.Composition.Services",["require","exports","f","i","../../Base/Base.Router","../../Services/Services.AssetManagement","../../Services/Services.AssetTypes","../../Services/Services.Permissions","../../Base/Themes","../Hubs/UI.BrowseManager","../Commands/UI.CommandManager","../UI.ContextPane","../UI.DesktopManagerImpl","../UI.DesktopModeManager","../Hubs/UI.NotificationManager",
"../../Widgets/Widgets.WidgetBase","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";var b;return (function(t){function g(t,g,nt,tt,it,rt,ut){var st=r.Rpc.client,et=g.extensionManager,ot=e.createAssetTypeService(et),vt=f.createAssetManager(et,g.settings,ot),ht=o.createPermissionsManager(et,ot);i.isFeatureEnabled("whatsnew")&&nt.whatsNewEnabledKey()&&w.WhatsNew.showWhatsNewModal.register(st,[k],(function(n){i.require("MsPortalImpl/Widgets/Widgets.WhatsNew").then((function(t){var i=n.items.map((function(n){var t=!n.published?"":new Date(n.published).toLocaleString();return n.description+="\r\n"+t,n}));new t.Widget($("<div />"),new p.ViewModel,i,it.element)}))}));var yt=h.createBrowseManager(et,ot,ht,tt),ct=s.createManager(t,d,nt["fxs-theme"],nt.highContrastKey),lt=l.create(it.getRightContextPane(),t),pt=l.create(it.getLeftContextPane(),t),wt=it.getToastVM(),ft={rpcClient:st,storageService:g.storageService,themeManager:ct,redirect:rt,settings:g.settings,editScopeManager:
g.editScopeManager,extensionManager:et,hubsMetadata:g.hubsMetadata,openWindow:g.openWindow,assetManager:vt,permissionsManager:ht,assetTypeService:ot,browseManager:yt,desktop:null,modeManager:null,portalFormTarget:null,contextPane:lt,leftContextPane:pt,getService:null,router:null,notificationManager:null},at=ft.desktop=a.createDesktopManager(it,ft),bt=ft.getService=i.memoizeQ((function(t){switch(t){case"DialogManager":return ut();case"ResourceMapManager":return b("../Hubs/UI.ResourceMapManager",n).then((function(n){return n.createResourceMapManager(et,ot)}));case"FeedbackPane":return b("../../Widgets/Widgets.FeedbackPane",n).then((function(n){return{amdModule:n,widget:new n.FeedbackPane(lt,wt,function(){return at.getCurrentBladeInfo()})}}));case"ThemeManager":return Q(ct)}throw new Error("Invalid service type '{0}' specified.".format(t));})),kt=ft.portalFormTarget=c.createCommandManager(ft.desktop).startListeningForEvents();return ft.notificationManager=y.createNotificationManager(ft),ft.router=
u.createRouter(ft),ft.modeManager=v.createDesktopModeManager(ft,it,t),t.registerForDispose([at,kt,ft.router,bt,]),ft}function nt(){return b("MsPortalImpl/UI/UI.DialogManager")}var k=r.Extension.getHubsWindowId(),b=i.require,d=$("body,head");t.initialize=g;t.getDialogManagerModule=nt})(b||(b={})),b}));define("MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadManager",["require","exports","f","a","./CodeComponentSideLoadModels","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.Storage","../UI/Compositions/UI.Composition.Services"],(function(n,t,i,r,u,f,e,o){"use strict";var y=i.Base,p=y.Diagnostics,h=p.createLog(n),s=f.Shell.Dialogs,c=0,a=1,v=0,w=1,b=2,l=s.loadOnlySafeExtensionsButtonText,k=(function(){function n(n,t,i,r,u,f,e,o,s,h,c,l){this._temporaryTestCodeComponents=[];this._trustedCodeComponents=n;this._settingsManager=t;this._storageService=i;this._getDialogManager=r;this._dialogContainer=u;this._canModifyCodeComponents=f;this._acceptWithoutPrompt=e;this._storageServiceKey=
o;this._hashQueryStringKey=s;this._createFunction=h;this._componentType=c;this._settingsKey=l}return n.prototype.getCodeComponentsMetadata=function(){var n=this,t;return Q().then((function(){var i=JSON.parse(JSON.stringify(n._trustedCodeComponents));return t=i.map((function(t){return n._createFunction(t)})),n.loadFromServer(t)})).then((function(i){return typeof i=="string"?i:(i.length>0&&n._merge(t,i),n._loadUntrustedCodeComponentsIfAllowed().then((function(i){if(i.length>0){var r=function(n){n.logUsageWarning()};n._merge(t,i,r)}return t.filter((function(n){return n.isValid()}))})))}))},n.prototype.loadFromServer=function(){},n.prototype.listTestCodeComponents=function(){var t=this,n=this._temporaryTestCodeComponents.slice(0);return this._settingsManager.querySetting(c,this._settingsKey).then((function(i){return i=i&&i.map((function(n){return t._createFunction(n)})),r.isArray(i)&&(n=n.concatUnique(i,(function(n,t){return n.isEqual(t)}))),n.filter((function(n){return n.isValid()}))})).then(null,(function(
n){return h.error("Error listing code components",2,n),[]}))},n.prototype.registerTestCodeComponent=function(n,t){var r=this,u;return n.isValid()?t?(this._addOrUpdateCodeComponent(this._temporaryTestCodeComponents,n),Q.resolve(null)):this.listTestCodeComponents().then((function(t){return r._addOrUpdateCodeComponent(t,n),r._settingsManager.setSetting(c,r._settingsKey,t),r._settingsManager.flushSettings()})).catch((function(t){h.error("Error registering code component",4,{codeComponent:n,error:t})})):(u=new i.Errors.Error("Invalid codeComponent"),u.data=n,Q.reject(u))},n.prototype.unregisterTestCodeComponent=function(n){var t=this;return this._removeCodeComponent(this._temporaryTestCodeComponents,n),this.listTestCodeComponents().then((function(i){if(t._removeCodeComponent(i,n))return t._settingsManager.setSetting(c,t._settingsKey,i),t._settingsManager.flushSettings()})).catch((function(n){h.error("Error unregistering code component.",6,{name:name,error:n})}))},n.prototype.unregisterAll=function()
{this.clearTemporaryTestCodeComponents();var n=this._settingsManager;return n.deleteSettings({store:c,keys:[this._settingsKey]}),n.flushSettings().catch((function(n){h.error("Error registering all code components",5,n)}))},n.prototype.clearTemporaryTestCodeComponents=function(){var n=this._temporaryTestCodeComponents;n.splice(0,n.length)},n.prototype._loadUntrustedCodeComponentsIfAllowed=function(){var n=this,t=this._canModifyCodeComponents;return t?this.listTestCodeComponents().then((function(i){return i.length===0?(t&&h.verbose("No untrusted code components were found. Will load the portal in normal mode.",3),[]):n.prompt().then((function(t){return t?(i.forEach((function(t){n._componentType===v&&t.markAsTestExtension()})),i):[]}))})):Q([])},n.prototype.prompt=function(){var f=this,i=e.ComponentName.ExtensionManager,r=this._storageServiceKey,u=this._storageService,h=u.getValue(i,r,a),n,t;if(h||this._acceptWithoutPrompt)return Q(!0);switch(this._componentType){case v:n=s.untrustedExtensionsTitle;
t=s.untrustedExtensionsDescriptionFmt.format(l);break;case w:n=s.untrustedGalleryPackageTitle;t=s.untrustedGalleryPackageDescriptionFmt.format(l);break;case b:n=s.untrustedPatchTitle;t=s.untrustedExtensionsDescriptionFmt.format(l);break;default:throw new Error("Unsupported componentType");}return o.getDialogManagerModule().then((function(e){var o=$("<div />"),h=new e.MessageBox(n,t,2);return f._dialogContainer.prepend(o),h.defaultButtonText=l,h.cancelButtonText=s.loadUnsafeExtensionsButtonText,f._getDialogManager().then((function(n){return n.showDialog(o,h,null,"sideload").then((function(t){var f=t===1;return n.dismissOpenDialog(),o.remove(),f?u.setValue(i,r,"true",a):u.clearValue(i,r,a),f}))}))}))},n.prototype._registerTestCodeComponentFromUri=function(n){return n.isValid()?this.registerTestCodeComponent(n,!0):null},n.prototype._removeCodeComponent=function(n,t){var i=-1;return(i=n.firstIndex((function(n){return n.isEqual(t)})),i>=0)?(n.splice(i,1),!0):!1},n.prototype._merge=function(n,t,i){var
r=this;n!==null&&t!==null&&t.forEach((function(t){i&&i(t);r._addOrUpdateCodeComponent(n,t)}))},n.prototype._addOrUpdateCodeComponent=function(n,t){var i=n.first((function(n){return n.isEqual(t)}));i?i.updateWith(t):n.push(t)},n})();t.CodeComponentSideLoadManagerImpl=k}));define("MsPortalImpl/Services/Services.FileUploadInitialization",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function f(r){t||(t=!0,n.uploadSettingsManager=r,Q(r.querySettings({store:12})).then((function(n){i.isEmpty(n)||u().then((function(n){return n.init(r)}))})))}var r="MsPortalImpl/Services/Services.FileUploadSettings",u=i.memoizeQ((function(){return i.require(r).then((function(n){return n.fileUploadResumableTrackerInstance()}))})),t=!1;n.init=f})(r||(r={})),r}));define("MsPortalImpl/Extension/ExtensionMetadataSource",["require","exports","f","i","o","../CodeComponentSideLoad/CodeComponentSideLoadManager","../CodeComponentSideLoad/CodeComponentSideLoadModels","../Services/Services.Settings.Schema",
"../Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(t){function rt(n,t,i,r,u){var f=new l(n,t,i,r,u,w,y.isDevelopmentMode);return MsPortalImpl.Extension=f,f}var a=i.Base,k=a.Diagnostics,h=e.ExtensionMetadataExt,v=r.Extension,d=window,g=k.createLog(n),y=d.fx.environment,p="testExtensions",nt="loadUntrustedExtensions",tt=o.testExtensionsKey,it=5e3,w=e.canModifyExtensions,b="Reload the portal with the query parameter ?feature.canmodifyextensions=true to load the test extension.",c=h.create,l;t.initializeTestExtension=rt;l=(function(n){function t(t,i,r,u,f,e,o){n.call(this,t,i,r,u,f,e,o,nt,p,c,0,tt)}return __extends(t,n),t.prototype.registerTestExtension=function(n,t){var i=c(n);return this.registerTestCodeComponent(i,t).then((function(){console.log(b)}))},t.prototype.registerTestExtensionsFromUri=function(n,t){var o=this,l=new s.Uri(n),c=l.getHashQueryStringValue(p),r,f;return c?(r=JSON.parse(decodeURIComponent(c)),f=u.keys(r),!w&&f.length&&console.warn(b),
Q.allSettled(f.map((function(n){var u=new h,c,f,s,l;return u.name=n,u.cloudName=t,c=v.getWindowId(u),f=i.find(o._trustedCodeComponents,(function(n){return v.getWindowId(n)===c})),f&&(u.obsoleteBundlesBitmask=f.obsoleteBundlesBitmask),s=u.uri=r[n],e.isLocalhostUri(s)?o._registerTestCodeComponentFromUri(u):(l="Invalid extension: '{0}', only allowed on 'localhost'.".format(s),g.error(l,1),null)})))):Q(null)},t.prototype.unregisterTestExtension=function(n,t){var i=new h;return i.name=n,i.cloudName=t,i.normalizeCloudName(),this.unregisterTestCodeComponent(i)},t.prototype.listTestExtensions=function(){return this.listTestCodeComponents()},t.prototype.clearTemporaryTestExtensions=function(){this.clearTemporaryTestCodeComponents()},t.prototype.loadFromServer=function(n){var t=y.extensionsUri,i;return t?(i=a.Net2.postJSON({uri:t},n).timeout(it),i.then((function(n){return n.map((function(n){return c(n)}))}),(function(n){var t=n&&n.jqXHR&&n.jqXHR.responseJSON&&n.jqXHR.responseJSON.reason;return t==="notSignedUp"?
"/UE_NotSignedUp":"/UE_NoExtensions"}))):Q([])},t})(f.CodeComponentSideLoadManagerImpl);t.ExtensionMetadataSourceImpl=l})(h||(h={})),h}));define("MsPortalImpl/GalleryPackage/GalleryPackageLoader",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function o(n){return new t(n)}var f=i.Base,r=f.Constants,u=r.ExtensionNames,e=i.Services.Rpc,t;n.initialize=o;t=(function(){function n(n){this._extensionManager=n}return n.prototype.loadGalleryPackages=function(n){if(n&&n.length>0)return this._extensionManager.getExtensionByName(u.Marketplace,r.DefaultCloudName).then((function(){e.invokeCallback(u.Marketplace,"loadGalleryPackages",n)}))},n})();n.GalleryPackageLoaderImpl=t})(r||(r={})),r}));define("_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-keyboardshortcuts{padding:0 25px;width:355px}.fxs-keyboardshortcuts-category{margin-top:20px}.fxs-keyboardshortcuts-shortcut{display:-webkit-flex;display:flex}.fxs-keyboardshortcuts-key{-webkit-flex:0 0 auto;flex:0 0 auto;width:98px}")})
);define("MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler",["require","exports","f","$","MsPortalImpl/Resources/ImplScriptResources","../Base/Base.KeyboardHelper","../Base/Telemetry","MsPortalImpl/Base/Base.EventTypes","../../_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function it(n){var t=n.isJourneyVisible()&&n.getPanorama();return t&&t.getJourneyWidget()}function a(n){var t=it(n),r=t&&t.getFocusedBlade();return r?r:t&&i.last(t.getBlades())}function rt(n,t,i,r,u){return new v(n,t,i,r,u)}var c=i.Base.Diagnostics,y=c.Telemetry,p=window,l="#blade/HubsExtension/Resources",w=l+"/resourceType/",b="fxs-sidebar-collapse-button",k="fxs-topbar-home",s=u.KeyboardShortcuts,h=s.GoTo,d=c.createLog(n),g=y.trace,nt=[49,50,51,52,53,54,55,56,57,48],tt=[97,98,99,100,101,102,103,104,105,96],v;t.setup=rt;v=(function(){function n(n,t,i,r,u){this._disposables=[];this._keyShortcuts={};this.
_goToShortcuts={};this._errorLoggingFunc=u||function(n){d.error(n)};this._addKeyShortcuts(n);this._addGoToShortcuts(t.router,n);this._registerSpecialShortcut(s.showDiagnostics,i,65);this._registerSpecialShortcut(s.showDebugHelper,r,68);this._registerShortcut(s.moveFavoritesUp,(function(){n.getSideBarWidget().reorderFavorites(38)}),38,5);this._registerShortcut(s.moveFavoritesDown,(function(){n.getSideBarWidget().reorderFavorites(40)}),40,5);this._attachEventHandlers()}return n.prototype.dispose=function(){this._removeEventHandlers()},n.prototype._attachEventHandlers=function(){var t=this,n;this._removeEventHandlers();n=!1;this._disposables.push(r(p.document).setEvents([o.default.keydown,function(i){var u,s=f.getModifierKeys(i),h,o;if(i.keyCode===71&&s===0){n=!0;return}(h=n?t._goToShortcuts[i.keyCode]:t._keyShortcuts[i.keyCode],o=h&&h[s],o)&&((u=r(document.activeElement),u.length>0&&s===0&&(u.is("input")||u.is("textarea")||["azc-editableControl","fxc-editor","fxc-console","fxc-consolev2"].some(
(function(n){return u.closest("."+n).length>0}))))||(o.handler(),g({source:e.Source.KeyboardShortcuts,action:e.Action.KeyboardShortcutExecuted,name:o.id}),i.preventDefault()))}],[o.default.keyup,function(t){var i=f.getModifierKeys(t);t.keyCode===71&&i===0&&(n=!1)}]))},n.prototype._removeEventHandlers=function(){i.disposeDisposable(this._disposables);this._disposables=[]},n.prototype._registerShortcut=function(n,t,i,r){r===void 0&&(r=0);var u=this._keyShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r),e={description:n,handler:t,id:f};u?u[r]&&this._errorLoggingFunc("Duplicate shortcut: "+f):this._keyShortcuts[i]=[];this._keyShortcuts[i][r]=e},n.prototype._addKeyShortcuts=function(n){this._registerGotoShortcut(s.toggleFocusSideAndTopBar,(function(){var n=r(document).findByClassName(k)[0];r(document.activeElement)[0]===n?r(document).findByClassName(b)[0].focus():n.focus()}),190);this._registerGotoShortcut(s.moveFocusToCommandBar,(function(){var t=a(n),i=t&&t.getContentWidget();i&&i.setFocusOnCommandBar(
)}),188);this._registerShortcut(s.bladeSearch,(function(){var t=a(n);t&&t.focusSearchBox()}),191,8)},n.prototype._registerGotoShortcut=function(n,t,i){var r=0,u=this._goToShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r,!0),e={description:n,handler:t,id:f};u?u[r]&&this._errorLoggingFunc("Duplicate goto shortcut: "+f):this._goToShortcuts[i]=[];this._goToShortcuts[i][r]=e},n.prototype._registerSpecialShortcut=function(n,t,i){r.isFunction(t)&&this._registerShortcut(n,t,i,9)},n.prototype._addGoToShortcuts=function(n,t){var r=this,i;this._registerGotoShortcut(s.browse,(function(){t.getSideBarWidget().toggleFlyout()}),66);this._registerGotoShortcut(s.new,(function(){t.getSideBarWidget().openCreate()}),78);this._registerGotoShortcut(s.search,(function(){t.getSearchWidget().setFocus()}),191);[[h.allResources,l,65],[h.resourceGroups,w+"Microsoft.Resources%2Fsubscriptions%2FresourceGroups",82],].forEach((function(t){r._registerGotoShortcut(t[0],(function(){n.route(t[1])}),t[2])}));this._registerGotoShortcut(
h.dashboard,(function(){t.handleStartButtonClick()}),68);i=function(n,i){var u=i+1;r._registerGotoShortcut(h.sideBarItem+u,(function(){t.options.sideBar.openFavorite(i)}),n)};nt.forEach(i);tt.forEach(i)},n.prototype._generateIdForKeyboardShortcut=function(n,t,i){i===void 0&&(i=!1);var r=i?"G+":"";return t>15&&this._errorLoggingFunc("Not allowed modifier!"),t&8&&(r+="CTRL+"),t&1&&(r+="ALT+"),t&2&&(r+="WIN/CMD+"),r+f.mapKeyCodeToString((t&4)==4,n)},n.prototype.getShortcuts=function(){return{key:this._keyShortcuts,goTo:this._goToShortcuts}},n})()})(s||(s={})),s}));define("MsPortalImpl/Services/Services.AzureStorage",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function e(){u.register(r.Rpc.client,[r.Extension.getWindowId({name:"Microsoft_Azure_Scheduler",cloudName:t.Constants.DefaultCloudName})],o)}function o(n){var i={isBackgroundTask:!1,uri:f};return t.Net2.postJSON(i,n).then((function(n){return n.data}))}var t=i.Base,u=r.InternalAzure.getSasUriForQueueEndPoint,
f=t.Resources.getAppRelativeUri("api/Storage/getsasuriforqueue");n.registerSasEndPoint=e})(u||(u={})),u}));define("MsPortalImpl/Services/Services.BrowseCuration",["require","exports","f","i","MsPortalImpl/Resources/ImplScriptResources","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f){"use strict";function y(n){if(n&&!k.test(n)){l.warning("Invalid curation file name: <"+n+">, skipping this curation file.");return}return n}function nt(n,t,i){return{base:e(n,!1),associated:o.apply(o,t),infoTextOverride:i}}function e(n,t){var i,r;if(n&&!(n.length<2)&&n[0].length&&n[1].length)return i={extensionName:n[0],assetType:n[1]},t||n[n.length-1]===!1&&(i.isHidden=!0),n.length>2&&(r=n[2],r&&typeof r=="string"&&(i.kind=r)),i}function o(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];return t.map((function(n){return e(n)})).filter((function(n){return!!n}))}function tt(){f.Curation.getSharedCurationEndpoint.register(w.client,[r.Extension.getHubsWindowId()],(function(){return t.getSharedCuration()}))}var
s=i.Base,w=r.Rpc,h=i.Hubs.Notifications,b=window,c=b.fx.environment,l=s.Diagnostics.createLog(n),k=/^[a-z\_]+[a-z\d\-\_]*$/i,a=u.BrowseCuration,v=i.lowerCaseAllStrings,d=y(i.getFeatureValue("browsecuration")),g=y(c.browseCuration),p=d||g||"default";t.getMergedAssetType=nt;t.getAssetType=e;t.getAssetTypes=o;t.getBrowseCuration=i.memoizeQ((function(){return i.require("MsPortalImpl/Services/BrowseCuration/"+p).then((function(n){return n.getCuration()})).catch((function(n){var i="Failed to get the browse curation file <"+p+">",t=i;return n&&n.statusText?t+=": "+(n.status||"")+" ("+n.statusText+")":n&&n.message&&(t+=": "+n.message),l.warning(t),h.ClientNotification.publish({title:a.noCurationTitle,description:a.noCuration,status:h.NotificationStatus.Warning}),{}}))}));t.getSharedCuration=i.memoizeQ((function(){var n=u.SearchTypeDisplayText,r=u.SearchTypeKeywords,f=u.SearchTypeSubText;return t.getBrowseCuration().then((function(t){var u=(t&&t.search||[]).map((function(t){var i=(t.id||"").toLowerCase(
),u=i&&n[i];if(u)return{id:t.id,displayName:u,subText:f[i],keywords:(r[i]||"").split(","),icon:typeof t.icon=="string"?s.Images.ImageUri(t.icon):t.icon,link:(t.link||"").format({accountPortal:c.links.accountPortal})}})).filter(i.identity);return{searchCuration:u,resourceTypesExcludedFromBrowse:v(t&&t.resourceTypesExcludedFromBrowse),mergedAssetTypes:v(t&&t.mergedAssetTypes)}}))}));t.testReset=i.noop;t.initializeRpc=tt}));define("MsPortalImpl/Services/Services.Controller",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function r(n){var i=[n?n.flushSettings():Q(),t.Telemetry.flush(),t.Upload.flush()],r=i.every((function(n){return!Q.isPending(n)}));return r?Q():Q.all(i)}var t=i.Base.Diagnostics;n.flush=r})(r||(r={})),r}));define("MsPortalImpl/Services/Services.FileUploadEndpointRegistration",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function s(){e||(e=!0,u.uploadActionEndPoint.register(t.client,null,(function(n){return f(
).then((function(t){return t.invokeUploadAction(n.uploadKey,n.action,n.context)}))})),u.getUploadInfosEndPoint.registerObjectFactory(t.client,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){return f().then((function(t){return t.getUploadInfos(n.uploadKeys,n.category,n.resumable)}))}}))}var t=r.Rpc,u=r.FileUpload,o="MsPortalImpl/Services/Services.FileUploadManager",f=i.memoizeQ((function(){return i.require(o).then((function(n){return n.fileUploadManagerInstance()}))})),e=!1;n.registerFileUploadEndpoints=s})(u||(u={})),u}));define("MsPortalImpl/Services/Services.GalleryEndpoints",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){var t=r.Extension,e=i.Base,o=e.Constants.ExtensionNames,s=window,u=s.fx.environment,f=u.features,h=(function(){function n(n,i,r){var e=this;this._registeredEndpoints=[];this._extensionManager=i;this._extensionMetadataSource=r;t.getLocalGalleryPackagesEndpointsDefinition.register(n,null,(function(n,i){var r=t.getDescriptor(i.srcWindowId).
name.toLowerCase();return r===o.Marketplace.toLowerCase()?e._ensureAllTestExtensionsAreLoaded().then((function(){return e._registeredEndpoints.slice(0)})):null}));t.registerLocalGalleryPackagesEndpointDefinition.register(n,null,(function(n){if(u.isDevelopmentMode||f&&f.canmodifyextensions){var t=e._registeredEndpoints;t.indexOf(n)<0&&t.push(n)}}))}return n.prototype._ensureAllTestExtensionsAreLoaded=function(){var n=this;return this._extensionMetadataSource.listTestExtensions().then((function(t){return Q.allSettled(t.map((function(t){return n._extensionManager.getExtensionByName(t.name,t.cloudName)})))}))},n})();n.GalleryEndpointsService=h})(u||(u={})),u}));define("MsPortalImpl/Services/Services.FavoritesSettings",["require","exports","ko","./Services.SettingsProcessor"],(function(n,t,i,r){"use strict";var u;return (function(n){function o(i){if(u&&!e.isTestMode)throw new Error(t+" has already been called.");u=!0;n.processor.init(i,n.settings,f,t,!0)}var f=10,t="InitializeFavoritesSettingsInternal",e=
window.fx.environment,u=!1;n.processor=new r.SettingsProcessor;n.settings={favorites:i.observable(""),version:i.observable(0)};n.init=o})(u||(u={})),u}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-commandBar-form{padding:0}.fxs-messagebox,.fxs-progressbox{font-size:14px;box-sizing:border-box;box-shadow:0 5px 15px 2px rgba(0,0,0,.3);border:1px solid}.fxs-messagebox h2,.fxs-progressbox h2{font-size:110%;padding:24px 27px 7px;margin:0;line-height:14px;border-bottom:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-messagebox .fxs-messagebox-html,.fxs-messagebox .fxs-messagebox-text,.fxs-messagebox .fxs-progressbox-text,.fxs-progressbox .fxs-messagebox-html,.fxs-progressbox .fxs-messagebox-text,.fxs-progressbox .fxs-progressbox-text{padding:0 27px;word-wrap:break-word}.fxs-messagebox .fxs-progressbox-progressbar,.fxs-progressbox .fxs-progressbox-progressbar{padding:7px 27px 24px}.fxs-messagebox .fxs-messagebox-buttons,.fxs-progressbox .fxs-messagebox-buttons{border-top-width:1px;border-top-style:solid}.fxs-messagebox .fxs-messagebox-buttons .fxs-button,.fxs-progressbox .fxs-messagebox-buttons .fxs-button{margin-right:5px}.fxs-messagebox .msportalfx-form,.fxs-progressbox .msportalfx-form{padding:0;margin:27px 0 0}.fxs-messagebox .msportalfx-form>div,.fxs-progressbox .msportalfx-form>div{padding:15px 27px}.fxs-messagebox-confirmation{padding:10px 27px 0;display:block}")})
);define("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","../../Interactions/Interactions.DismissHandler","../../Interactions/Interactions.KeyboardNavigation","../Widgets.WidgetBase","../Widgets.Common","../../../_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css","../../../MsPortalImpl.Controls/Controls/SimpleButton"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(t){function rt(n){var i=n.closest("."+v),t;i.length>0&&(t=h.Widget.getWidget(i,y),t.cancelBtn&&t.cancelBtn.onClick.call(this))}function d(n,t){var r=n.closest("."+v),i;for(r.length>0&&c.waitForBindings(r[0]).then((function(){var n=h.Widget.getWidget(r,y);n.options.confirmationRequired?n.element.find(".azc-checkBox").focus():n.element.find(".fxs-portal-button-primary").focus()})),i=t||document.activeElement;i&&typeof i.focus!="function";)i=f(i).closest("[tabindex]")[0];w=i}var nt=i.Base.Diagnostics,tt=i.ViewModels.Controls.
SimpleButton.ViewModel,a=nt.createLog(n),b=i.newGuid,l=e.Dialogs.ButtonText,k="fxs-portal-bg-txt-br",v="fxs-messagebox",p="fxs-messagebox-text",it='<h2 data-bind="text: data.title" class="fxs-messagebox-title msportalfx-tooltip-overflow"><\/h2><!-- ko if: data.modal -->'+('<div data-bind="sanitizedHtml: data.text" class="'+p+'"><\/div>')+"<!-- /ko --><!-- ko ifnot: data.modal --><!-- ko ifnot: data.template -->"+('<div data-bind="text: data.text" class="'+p+'"><\/div>')+'<!-- /ko --><!-- ko if: data.template --><div class=\'msportalfx-padding\' data-bind="untrustedHtml: { html: data.template, data: data.templateViewModel, isolated: true }"><\/div><!-- /ko --><!-- /ko --><!-- ko if: data.confirmationRequired --><div data-bind="pcControl: func.checkboxVm" class="fxs-messagebox-confirmation"><\/div><!-- /ko --><div class="msportalfx-form fxs-messagebox-buttons fxs-portal-border"><div data-bind="foreach: func.buttonVms"><div data-bind="pcControl: $data.vm, attr: { \'data-result\': $data.result }"><\/div><\/div><\/div>',
w=document.activeElement,g,y;t.cancelMessageBox=rt;t.setFocusOnMessageBox=d;g=(function(n){function t(){n.apply(this,arguments);this.title=u.observable();this.text=u.observable();this.modal=!1;this.buttons=1;this.confirmationRequired=!1}return __extends(t,n),r.defineProperty(t.prototype,"onButtonClick",{get:function(){return this._buttonClick},set:function(n){if(this._buttonClick)throw new Error("The onButtonClick callback has already been set.");this._buttonClick=n},enumerable:!0,configurable:!0}),t})(h.ViewModel);t.ViewModel=g;y=(function(n){function t(t,r){var e=this,h,c,l;n.call(this,t,r);this.buttonVms=u.observableArray([]);t.html(it).addClass(v).addClass(k);h=this.ltm;c=function(n){var t=e.element[0];return!e.options.modal&&!(t===n)&&!f.contains(t,n)};this._dismissHandle={dismissFn:function(){e.cancelBtn&&e.cancelBtn.onClick.call(e)},shouldDismissOnMouseDownFn:c,shouldDismissOnMouseWheelFn:c,restoreFocus:function(){o.validatePreviousFocusedElement(e._dismissHandle,w)&&w.focus()},logName:
"messagebox"};this.checkboxVm=new i.ViewModels.Forms.CheckBox.ViewModel(h,{label:u.observable(r.confirmationMessage),inlineLabel:!0});this._getButtonHtml(r.buttons,h);this._bindDescendants();this._setAria();d(t,document.activeElement);l=new s.KeyboardNavigation(t,2);o.register(this._dismissHandle);h.registerForDispose((function(){l.dispose();o.unregister(e._dismissHandle)}));this.checkboxVm.value(!r.confirmationRequired);u.reactor(h,(function(){e.defaultBtn.disabled(!e.checkboxVm.value())}))}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(v,k);n.prototype.dispose.call(this)},t.prototype.generateBtns=function(n,t){var r=this,u=function(n,t,i,u){return new tt(n,{text:t,primary:i,onClick:function(){if(typeof r.options.onButtonClick=="function")r.options.onButtonClick(u);r._dismissHandle.restoreFocus()}})};this.buttonVms().forEach((function(n){n.vm.dispose()}));this.buttonVms().length=0;this.buttonVms([]);this.defaultBtn=null;this.cancelBtn=null;t.forEach((function(t,i){i===
0&&t.kind!==1&&a.error("The first button should be the default button for this dialog.");r.defaultBtn&&t.kind===1&&a.error("Only one default button should be defined.");r.cancelBtn&&t.kind===2&&a.error("Only one cancel button should be defined.");switch(t.kind){case 1:r.buttonVms.push({vm:u(n,t.text,!0,t.result),result:t.result});r.defaultBtn=r.buttonVms().last().vm;break;case 2:r.buttonVms.push({vm:u(n,t.text,!1,t.result),result:t.result});r.cancelBtn=r.buttonVms().last().vm;break;case 3:default:r.buttonVms.push({vm:u(n,t.text,!1,t.result),result:t.result})}}));t.length===1&&(this.cancelBtn=this.defaultBtn);i.isNullOrUndefined(this.cancelBtn)&&a.error("Cancel button should be defined.");return},t.prototype._getButtonHtml=function(n,t){var i=this.options;if(i.customBtns)this.generateBtns(t,i.customBtns);else{switch(n){case 0:this.generateBtns(t,[{kind:1,text:l.retry,result:5},{kind:2,text:l.abort,result:0},{kind:3,text:l.ignore,result:2}]);break;case 1:this.generateBtns(t,[{kind:1,text:
l.ok,result:4}]);break;case 2:this.generateBtns(t,[{kind:1,text:l.ok,result:4},{kind:2,text:l.cancel,result:1}]);break;case 3:this.generateBtns(t,[{kind:1,text:l.retry,result:5},{kind:2,text:l.cancel,result:1}]);break;case 4:this.generateBtns(t,[{kind:1,text:l.yes,result:6},{kind:2,text:l.no,result:3}]);break;case 5:this.generateBtns(t,[{kind:1,text:l.yes,result:6},{kind:3,text:l.no,result:3},{kind:2,text:l.cancel,result:1}]);break;default:throw new Error("Could not locate message box button of type {0}.".format(n));}this.defaultBtn&&i.defaultButtonText&&this.defaultBtn.text(i.defaultButtonText);this.cancelBtn&&i.cancelButtonText&&this.cancelBtn.text(i.cancelButtonText)}return},t.prototype._setAria=function(){var n=this.element,t=b(),i=b();n.attr({role:"alertdialog","aria-labelledby":i,"aria-describedby":t});n.find("h2").attr("id",i);n.findByClassName(p).attr("id",t);this.ltm.registerForDispose((function(){n.removeAttr("role aria-labelledby aria-describedby")}))},t})(h.Widget);t.Widget=y})
(l||(l={})),l}));define("MsPortalImpl/Services/Services.PortalTips",["require","exports","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.GeneralSettings","../../Viva.Controls/Controls/Viva.Balloon","../Widgets/Dialogs/Widgets.MessageBox"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function o(n,t,i,u){return t.then((function(){s(n,i);r.settings.whatsNewVersion(u)}))}function s(n,i){var o=n.createChildLifetime(),s=function(){o.isDisposed()||o.dispose()},h=e.DefaultView,r=new f.ViewModel;r.buttons=1;r.title(h.title);r.text(h.description.format(t.browseLabel));r.onButtonClick=s;r.disabled(!1);Q.delay(500).then((function(){var n=new u.ViewModel,t;i.push(t=function(e){if(e.length&&i.indexOf(t)>=0){i.removeAll([t]);n.box((function(){return u.getBox($(e[0]))}));n.content('<div class="fxs-portal-tip-content"><\/div>');n.position(2);var h=$(".fxs-portal-tip:first"),c=new u.Widget(h,n,{isTrusted:!0});o.registerForDispose([c,new f.Widget(h.find(".fxs-portal-tip-content:first"),
r),]);n.visible(!0);n.visible.subscribe(o,(function(n){n||s()}))}})}))}var t=window.fx.environment.branding,e=i.PortalTips;n.setup=o})(e||(e={})),e}));define("MsPortalImpl/Services/Services.SharedSettings",["require","exports","i"],(function(n,t,i){"use strict";var r;return (function(n){function o(){u.getSharedSettingsEndPoint.register(f.client,null,(function(){return r()}))}function r(){return Q.fcall((function(){return{links:{accountPortal:t.accountPortal,classicPortal:t.classicPortal,createSupportRequest:t.createSupportRequest,helpAndSupport:t.helpAndSupport,manageSupportRequests:t.manageSupportRequests,giveFeedback:t.giveFeedback,privacyAndTerms:t.privacyAndTerms,learnRelatedResources:t.learnRelatedResources,resourceGroupOverview:t.resourceGroupOverview}}}))}var u=i.Extension,f=i.Rpc,e=window,t=e.fx.environment.links;n.initializeRpc=o;n.getSharedSettings=r})(r||(r={})),r}));define("MsPortalImpl/Services/Services.SecurityTokens",["require","exports","f","i"],(function(n,t,i,r){"use strict";function pt(
){var n=h.getItem(v);return t.authState=JSON.parse(n),h.removeItem(v),t.authState}function wt(n){t.authState=n}function bt(){t.authState&&h.setItem(v,JSON.stringify(t.authState))}function kt(n){return n.refreshToken?new y(new it,n):new rt(n)}function dt(n,t,i){return new p(ot.client,n,t,i)}function gt(n){var t=n&&n.authHeader;return t?function(){return Q(t)}:function(){return Q.reject(l)}}var o=r,s=o.Extension,u=i.Base,w=u.Net2,ut=u.Constants,ft=u.Constants.ExtensionNames.Hubs,b=u.Diagnostics,k=b.Telemetry,et=u.Resources,ot=r.Rpc,st=u.Security,ht=o.Security,ct=window,h=MsPortalImpl.sessionStorage,d=b.createLog(n),lt=et.getAppRelativeUri("/api/DelegationToken"),f=ht.tokenErrors,e="",c=ut.Shell.toLowerCase(),at=f.accessDenied,g=f.unknown,nt=f.sessionEnded,l=f.credentialsExpired,vt=f.networkError,yt=f.nullToken,a=Date.now,tt=s.getWindowId,v=ct.fx.environment.bootstrapAuthorizationKey,it,y,rt,p;t.extractAndClearAuthState=pt;t.updateAuthState=wt;t.writeAuthState=bt;t.createOAuthTokenProvier=
kt;t.createSecurityTokensManager=dt;it=(function(){function n(){}return n.prototype.getToken=function(n,t,r,u){var e={extensionName:n,resourceName:r,tenant:t,portalAuthorization:u},o=k.start({source:"Services.SecurityTokens",action:"Get",name:n}),f;return Q(w.postJSON({uri:lt,dataType:"json",setAuthorizationHeader:!1,performRetry:!0},e)).catchError(i.Errors.AjaxError,(function(t){return f="Failed to get tokens for extension '{0}' resource '{1}'. {2} {3} {4}".format(n,r,t.jqXHR.status,t.textStatus,t.errorThrown),Q.reject(t)})).finally((function(){k.endTrace(o,!f,f||r)}))},n})();y=(function(){function n(n,t){var r=this._refreshToken=t.refreshToken,i;this._pendingAuthorization=Q.resolve(r);this._client=n;i=this._user=t.user;this._tenant=i&&i.tenantId}return n.prototype.getToken=function(n,t){var i=this;return this._pendingAuthorization.then((function(r){var u=i._client.getToken(n,i._tenant,t||e,r).catch((function(n){var t=o.Azure.buildSimplifiedError(n),i=t.status,u;return u=400<=i&&i<500?l:i?g:vt,
{portalAuthorization:r,value:{authHeader:null,expiresInMs:0,refreshToken:null,error:u,errorMessage:"code: {0}, statusText: {1}, message: {2}, stack: {3}".format(i,t.statusText,t.message,t.stack||"")}}}));return i._pendingAuthorization=u.then((function(n){return i._refreshToken=n.portalAuthorization||r})),u}))},n.prototype.getRefreshToken=function(){return this._refreshToken},n.prototype.getDiagnosticsData=function(){return{user:this._user}},n})();t.OAuthTokenProviderImpl=y;rt=(function(){function n(n){this._token=n.oAuthToken;this._user=n.user}return n.prototype.getToken=function(){return Q.resolve({value:this._token,portalAuthorization:""})},n.prototype.getRefreshToken=function(){return""},n.prototype.getDiagnosticsData=function(){return{user:this._user}},n})();p=(function(){function n(n,t,i,r){this._extensionTokenSettings={};this._sessionEnded=!1;this._extensionTokenFailures=[];this._hubsWindowId=s.getHubsWindowId();this._tokenProvider=t;this._rpcClient=n;this._sessionEndedHandler=i;this._tokenFailedHandler=
r}return n.prototype.initializeSecurityForShell=function(n){var t=n||{},i=t.oAuthToken,f=t.refreshToken,r=t.createdOn||a(),u=f?this._createShellTokenFunc(i,r):gt(i,r,this._sessionEndedHandler);return this._enableShellTokenAccess(),w.initialize(u),u},n.prototype.registerGetAuthorizationTokenEndpoint=function(n){var t=this;this._extensionTokenSettings=i.convertArrayToMap(n,(function(n){var t=n.cloudName;return tt({name:n.name.toLowerCase(),cloudName:t?t.toLowerCase():undefined},{forceCloudName:!0}).toLowerCase()}),(function(n){return n.tokenSettings}));this._enableShellTokenAccess();s.getAuthorizationTokenEndPoint.register(this._rpcClient,null,(function(n,i){var r,u=n.cloudName;return r=i.srcWindowId===t._hubsWindowId?tt({name:ft,cloudName:u},{forceCloudName:!0}):i.srcWindowId,t._getSecurityToken(u,r,n.resourceName||e,n.isBackground)}))},n.prototype.getDiagnosticsData=function(){return this._tokenProvider.getDiagnosticsData()},n.prototype._getSecurityToken=function(n,t,r,u){var f=this,h=t.toLowerCase(
),s=this._extensionTokenSettings[h],o=this._shellTokenCache;return r&&s&2?Q({error:at}):this._sessionEnded?Q({error:nt}):o&&!r&&s&1?o.getToken({cloudName:n,resourceName:""}).then((function(n){return{token:n}})):this._tokenProvider.getToken(t,r,u).then((function(s){var p=f._extensionTokenFailures,w=a(),h=s&&s.value||{},v=h?h.error:yt,tt=h.errorMessage,b,y,it,k;return!v&&h.authHeader?(i.remove(p,t),{token:{header:h.authHeader,expiresAt:w+h.expiresInMs}}):(b=v===l,(v===nt||b)&&(f._sessionEnded=!0,y=void 0,b||!o?y=w:(it=t===c?r:e,y=o.getTokenExpiresAt(n,it)),f._sessionEndedHandler(t,y||w)),u||(i.pushUnique(p,[t]),f._tokenFailedHandler(p.join(", ")),k="Failed to get token for {0} & {1}. Error:{2}. Message:{3}".format(t,r,v,tt),v===g?d.error(k):d.verbose(k)),{error:v,errorMessage:tt})}))},n.prototype._createShellTokenFunc=function(n,i){var u=this,f={},r,o;return n&&(r=n.expiresInMs||1,f[e]={header:n.authHeader,expiresAt:r>0?i+r:-1}),o=this._shellTokenCache=st.createAuthTokenCache((function(n){return u.
_getSecurityToken(n.cloudName,c,n?n.resourceName:e,n.isBackground).then((function(i){var o=(i||{}).token,s;if(!!o&&n.resourceName===e){var r=t.authState||{},h=a(),f=r.oAuthToken||{};f.authHeader=o.header;f.expiresInMs=o.expiresAt-h;s=u._tokenProvider.getRefreshToken();s&&(f.refreshToken=s);r.createdOn=h;r.oAuthToken=f;t.authState=r}return i}))}),f),function(n){return o.getToken(n).then((function(n){return n&&n.header}))}},n.prototype._enableShellTokenAccess=function(){this._extensionTokenSettings[c]=0},n})();t.SecurityTokensManagerImpl=p}));define("MsPortalImpl/Services/Services.ShellProvisioner",["require","exports","f","i","u","../Extension/Extension.Definition.Locator"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function p(n){return c||(c=new s(n.desktop,n.rpcClient))}var l=f.Locator,e=r.Extension,a=e.CloudName,o=r.ViewModels.ParameterCollectionV3,v=i.Base,y=v.Diagnostics,h,c,s;t.promiseCleanupDelay=3e4;h=y.createLog(n);t.create=p;s=(function(){function n(n,t){this.provisioningPromisesLookup=
{};this._desktopManager=n;this._registerRpcCallbacks(t)}return n.prototype.processProvisioningRequest=function(n,r){var e=this,c=!0,o="Provisioning request is ",f,s,h;if(!n)throw new Error(o+" undefined.");if(f=n.provisioningRefKey,!f)throw new Error(o+"missing the provisioningReferenceKey.");if(!n.provisioningPromise)throw new Error(o+"missing the provisioningPromise.");if(!i.isFeatureEnabled("removecreatepin")&&n.startboardInfo){if(this.provisioningPromisesLookup[f])throw new Error("Provisioning promise already exists with the same key.");this.provisioningPromisesLookup[f]={promise:n.provisioningPromise,wasAcquired:!1,data:u};s=function(n){e.provisioningPromisesLookup[f].data=n};n.provisioningPromise.progress(s).then(s).finally((function(){setTimeout((function(){e.provisioningPromisesLookup[f]&&!e.provisioningPromisesLookup[f].wasAcquired&&e._logWarning("Provisioning operation with ref key "+f+" wasn't aquired by the provisioning part. Deleted at "+new Date+".");delete e.provisioningPromisesLookup[
f]}),t.promiseCleanupDelay)}));this._addProvisioningPart(n,r)}else n.provisioningPromise.catch((function(n){var t=(n||{}).error||n;e._logWarning("Provisioning promise rejected. "+(t.message||JSON.stringify(t)))})),n.provisioningConfig&&!!n.provisioningConfig.dontDiscardJourney&&(c=!1);return c&&(h=this._desktopManager.getActiveJourney(),h&&this._desktopManager.forceDiscardJourney(h.id)),n.provisioningPromise},n.prototype._addProvisioningPart=function(n,t){this._desktopManager.addPartToStartBoard({originPartLocator:l.forExtension(n.startboardInfo.provisioningPart.extension,t).withPartType(n.startboardInfo.provisioningPart.name),model:a.addToModel(t,{initialData:{provisioningConfig:n.provisioningConfig,provisioningRefKey:n.provisioningRefKey,startboardPart:n.startboardInfo.startboardPart}}),initialSize:2})},n.prototype._registerRpcCallbacks=function(n){var t=this;o.initiateProvisioningRequestEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(i,r){var s,
u=r.srcWindowId,f;return(s=u!==e.getHubsWindowId()?e.getDescriptor(u).cloudName:i.cloudName,f="Can't initiate the provisioning request. ",!i.provisionerId)?Q.reject(f+"provisionerId unspecified."):i.provisioningRefKey?(o.getProvisioningRequestEndPoint.acquireObject(n,u,i).then((function(n){var i=n.getValue();t.processProvisioningRequest(i,s).finally((function(){n.dispose()}))}),(function(n){throw new Error(n);})),Q(i)):Q.reject(f+"provisioningRefKey unspecified.")}});o.getProvisioningOperationEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){if(!n)return Q.reject("Can't return provisioning operation. provisioningRefKey unspecified.");var i=t.provisioningPromisesLookup[n],r=i&&i.promise;return r&&(t.provisioningPromisesLookup[n].wasAcquired=!0),Q({provisioningPromise:r,data:i&&i.data})}})},n.prototype._logWarning=function(n){h.warning(n)},n})();t.ShellProvisionerImpl=s})(e||(e={})),e}));define("MsPortalImpl/Services/Services.TelemetrySharing",["require",
"exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function h(n){return f.registerExtensionUnloadCallback(n),f}var e=r.Extension,o=i.Base,u=o.Constants,t=r.Rpc,s=(function(){function n(){var n=this;this._extensions={};t.client.registerRpcEndPoint(u.TelemetrySharing.RegisterExtension,{allowedOrigin:null,handler:function(){n._extensions[t.messageContext.srcWindowId]=!0}})}return n.prototype.registerExtensionUnloadCallback=function(n){var t=this;n.onUnload((function(n){var i=e.getWindowId(n);return t._extensions[i]&&delete t._extensions[i],!0}))},n.prototype.trace=function(n){var i=n.extension,r=n.data&&n.data.srcExtension,f=u.TelemetrySharing.TraceTelemetry;this._extensions[i]&&t.client.invokeRpc(f,i,n);i!==r&&this._extensions[r]&&t.client.invokeRpc(f,r,n)},n.prototype.flush=function(){return i.Helpers.Deferred().resolve().promise()},n})(),f=new s;n.getProcessor=h})(u||(u={})),u}));define("MsPortalImpl/Services/Services.Util",["require","exports","f","i"],(function(n,t,i,
r){"use strict";function e(n,t){var i="./Services.UtilHandlers";f(u.pinParts,i,"pinPartsRpcHandler",n,{desktop:t});f(u.getHmacSha256,i,"hmacShaRpcHandler",n);f(u.getX509Certificates,i,"x509CertificateRpcHandler",n)}function f(t,r,u,f,e,o){return f.registerRpcEndPoint(t,{allowedOrigin:o,handler:function(t,f,o){return i.require(n.normalize(r)).then((function(n){var i=n[u];return i(t,f,o,e)}))}})}var u=r.Constants.RpcMethods;t.registerEndpoints=e}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration",["require","exports","f","i","../../../Extension/ViewModelManager"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function h(n){var e=t+"All.Part",i,r;u.registerWithState("Browse$BrowseAllBlade$ServicesListPartViewModel",e,(function(t,i){return f.composePartViewModel((function(r){return new t.ServicesListPartViewModel(r,i,n)}),{initialState:i,logArea:e})}));u.registerWithState("Browse$BrowseServiceBladeViewModel",t+"Service.Blade",(function(t,i){var r=new s,u=new t.BrowseServiceBladeViewModel(
r,i,n);return new o(r,u,i)}));i=t+"Service.Part";u.registerWithState("Browse$BrowseServiceBlade$ServiceItemsListPartViewModel",i,(function(t,r){return f.composePartViewModel((function(i){return new t.ServiceItemsListPartViewModel(i,r,n)}),{logArea:i})}));r=t+"Service.PinnedPart";u.registerWithState("Browse$BrowseServiceTileViewModel",r,(function(t,i){return f.composePartViewModel((function(r){return new t.BrowseServiceTileViewModel(r,i,n)}),{createHubsInternalCloudNameProperty:!0,logArea:r})}))}var e=r.ViewModels,o=e.CompositionViewModel,f=e.Part,s=i.ViewModels.Internal.ContainerViewModel,t="./MsPortalImpl/UI/Hubs/ViewModels/UI.Browse";n.registerViewModels=h})(f||(f={})),f}));define("MsPortalImpl/UI/Hubs/UI.FavoritesManager",["require","exports","f","i","o","ko","MsPortalImpl/Resources/ImplScriptResources","../../Services/Services.AssetTypes","../Hubs/UI.BrowseManager","./UI.NotificationManager","../../Services/Services.BrowseCuration"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function gt(n,t,
r,u){var e=f.computed(n,t,i.identity),o;e.extend(et);o=e.subscribe(n,r);u&&o.callback(e())}function ot(n,t){var r=(t||"").toLowerCase(),i=n.assetTypeManifest.resourceType;return(t&&i&&i.kinds||[]).first((function(n){return n.name.toLowerCase()===r}))}function p(n,t,i,r){i===w.BrowseResourceGroupBlade&&(i=w.ResourceGroups);var u=b.getWindowId({name:t,cloudName:n},{forceCloudName:!0});return vt.getAssetTypeOrResourceTypeIdByWindowId(u,i)+(r?"."+r.toLowerCase():"")}function st(n,t){return t&&(t.serviceDisplayName||t.pluralDisplayName||tt.assetPlusKindFormat.format(n.compositeDisplayName.service,t.name))||n.compositeDisplayName.service}function ht(n,t){return t&&t.icon||n.icon}function ct(n,t){return t&&t.keywords||n.assetTypeManifest.keywords}function ni(n,t){return d(n.cloudName,t.cloudName)&&n.extensionName===t.extension&&n.assetType===t.assetTypeManifest.name}function lt(n,t,i){var e,r,u=t.indexOf("."),f;return u>0&&(r=t,t=r.substring(0,u),e=r.substring(u+1)),f=n.first((function(n){return n.
id===t})),f&&g(f,e,i,[],r)}function ti(n,t,i){var o=[],r=[[],["Microsoft_AAD_IAM_AzureActiveDirectory","Microsoft_Azure_Monitoring_AzureMonitoring","Microsoft_Azure_Security_SecurityDashboard","Microsoft_Azure_Billing_Billing","Microsoft_Azure_Support_HelpAndSupport",],["Microsoft_Azure_Expert_AzureAdvisor",],["HubsExtension_Dashboard",],],u;if(i&&n.version()<r.length-1){var f=n.favorites,s=f().toLowerCase(),e=l(f()),h=function(n){r[n].forEach((function(t){var i=t.toLowerCase();s.indexOf(i)<0&&(n===3?e.unshift(t):e.push(t),o.push(t))}))};for(u=(n.version()||0)+1;u<r.length;u++)h(u);f(y(e))}t(o);n.version(r.length-1)}function g(n,t,i,r,u){var o=n.assetTypeManifest,e=ot(n,t),s=st(n,e),h=n.id.toLowerCase(),c=!!k(r,(function(n){return n.toLowerCase()===h}));return{id:u||n.id,image:ht(n,e),isFavorite:f.observable(!1),isHome:f.observable(!1),opensDashboard:o.name===w.Dashboard&&n.extension===a.ExtensionNames.Hubs,isFilteredOut:f.observable(!1),isHidden:f.observable(c),label:f.observable(s),labelId:
f.observable(s.replace(rt,"")),keywords:ct(n,e),matches:f.observable(),uri:i.assetTypeService.getAssetTypeDeepLink(n,t),opensExternal:o.browseType===3,cloudName:b.normalizeCloudName(n.cloudName),isPreview:n.isPreview,assetType:n,kind:t}}function ii(n){var t=[];return n.forEach((function(n){t=i.union(t,(n.associated||[]).map((function(n){return p(n.cloudName||v,n.extensionName,n.assetType,n.kind)})))})),t}function ri(n){return new at(n)}var nt=i.Base,a=nt.Constants,w=a.AssetNames,b=r.Extension,vt=r.Assets,yt=r.TriggerableLifetimeManager,pt=i.Hubs.Notifications.NotificationStatus,wt=nt.Diagnostics,tt=e.Favorites,it=tt.Notification,ui=wt.createLog(n),v=a.DefaultCloudName,l=JSON.parse,y=JSON.stringify,bt="uncurated",rt=/\s+/g,k=i.find,ut=i.stableSort,d=b.isEqualCloudName,ft=s.compareAssetTypeForSort,kt=i.isFeatureEnabled("userdefineddefaultview"),dt={},et,at;r.getAssetTypeMappingData=function(){return dt};et={deferred:!0};t.connectDebouncedObservable=gt;t.calculateHiddenAssetTypes=ii;t.createFavoritesManager=
ri;at=(function(){function n(n){var t=this;this.categories=f.observableArray();this.categoriesLookup={};this.showCategories=f.observable(!1);this.possibleFavorites=f.observableArray();this.possibleFavoritesLookup={};this.favorites=f.observableArray();this.selectedCloud=f.observable();this._notificationsForItems=f.observable();this._lifetime=new yt;this._extensionToDefaultCategoryMap={};this._missingFavoritesWithIndex={};this._hiddenAssetTypes=[];this._cloudNames=[];this._assetTypesPerCloudMap=r.getCloudMap();this._assetTypesForSelectedCloud=f.observable();this._favLoaded=!1;this._initialFavorites=[];this._categoriesInitialized=!1;this.remove=function(n){var i=t._savedFavorites().length&&l(t._savedFavorites())||[],r=i.indexOf(n);r!==-1&&(i.splice(r,1),t._savedFavorites(y(i)))};this.add=function(n){var i=l(t._savedFavorites())||[],r=i.indexOf(n);r===-1&&(i.push(n),t._savedFavorites(y(i)))};this.move=function(n){var i=l(t._savedFavorites())||[],r=t.favorites()[n],u=i.indexOf(r.id);i.splice(
n,0,i.splice(u,1)[0]);t._savedFavorites(y(i))};this._services=n;this._savedFavorites=f.observable("")}return n.prototype.initializeFavorites=function(n,t){var r=this,s=this._savedFavorites=n.favorites,y=s&&s().length,c;if(this._cloudNames=o.getCloudNames(),y?(i.isFeatureEnabled("skipfavoritesupgrade")||ti(n,this._notificationsForItems,y),this._initialFavorites=l(s())):this._cloudNames.forEach((function(n){r._initialFavorites.push(p(n||v,a.ExtensionNames.Hubs,w.Dashboard,undefined))})),!kt)return this._registerDependency(),this.loadFavorites();var h=i.find(this._initialFavorites,(function(n){return t.some((function(t){t.name===a.ExtensionNames.Hubs&&(t={name:t.name,cloudName:r._cloudNames[0]});var u=b.getWindowId(t,{forceCloudName:!0});return i.startsWith(n,u+"_")}))})),u=Q.defer(),e=f.observable(!1),k=this._lifetime.createChildLifetime();return u.promise.finally((function(){k.dispose()})),this.favorites.subscribeAndRun(k,(function(){h&&(!r.favorites().length||r.favorites()[0].id!==h||e())||e(!0)})
),this._registerDependency(),f.reactor(this._lifetime,[this._assetTypesForSelectedCloud,e],(function(n,t){n&&n.length&&!r._favLoaded&&(r.loadFavorites().catch((function(n){return Q.isPending(u.promise)&&u.reject(n),Q.reject(n)})),t=e());Q.isPending(u.promise)&&r._favLoaded&&t&&u.resolve()})),c=3e4,u.promise.timeout(c,new Error("initializeFavorites timeout trying to find "+h+". Timeout: "+c))},n.prototype.initializeCategories=function(){var n=this,t=this._curationPromise||c.getBrowseCuration();return this._categoriesInitialized=!0,t.then((function(t){var h,u;n._discoveryPolicy=t.discoveryPolicy||0;var e=function(t,i){var r={id:t,showLabel:f.observable(!0),isFilteredOut:f.observable(!1),isHidden:f.pureComputed((function(){var t=n.selectedCloud();return!r.possibleFavorites().some((function(n){return!n.isHidden()&&!n.isFilteredOut()&&d(n.cloudName,t)}))})),label:o.provideCategoryName(t),possibleFavorites:f.observableArray(),sourceCategory:i};return r},s=t.categories||[],r=s.map((function(n){return e(
n.id,n)}));r&&r.length&&(h=n._uncuratedCategory=e(bt),r.push(h));n.categories(r);n.possibleFavorites().forEach((function(t){var r=ot(t.assetType,t.kind),u=t.assetType,f=st(u,r);t.label(f);t.labelId(f.replace(rt,""));t.image=ht(u,r);t.keywords=ct(u,r);t.isHidden(t.isHidden()&&!!i.find(n._hiddenAssetTypes,(function(n){return n===t.id})))}));u={};s.forEach((function(t){(t.discoveryExtensions||[]).forEach((function(i){u[i]=k(r,(function(n){return n.id===t.id}))||n._uncuratedCategory}))}));n._extensionToDefaultCategoryMap=u;n._loadFlyoutMenu()}))},n.prototype.loadFavorites=function(){var n=this,t=this._savedFavorites&&this._savedFavorites().length&&l(this._savedFavorites())||[],i=[],f=this._services.assetTypeService.allManifestsLoaded(),r,u;return(this._favLoaded=!0,r=function(t,r){var u=lt(n._assetTypesForSelectedCloud(),t,n._services);u?(u.isHome(!r),u.isFavorite(!0),i.push(u)):n._missingFavoritesWithIndex[t]=r},u=function(){var t=n._notificationsForItems()||[],r=t.slice(0);t.forEach((function(n){var t=
k(i,(function(t){return n===t.id})),u,f;t&&(u=it.titleFmt.format(t.label()),f=t.assetType.assetTypeManifest||{},h.getNotificationManager().addClientNotification({title:u,description:it.Description[(f.name||"").toLowerCase()]||u,status:pt.Information,timestamp:new Date,cloudName:v,uri:t.uri}),r.remove(n))}));n._notificationsForItems(r);n.favorites(i)},t.length)?(t.forEach((function(n){n&&r(n,t.indexOf(n))})),u(),Q()):(this._curationPromise=c.getBrowseCuration()).then((function(t){var i=n._initialFavorites;t.favorites.forEach((function(n){var t=p(n.cloudName||v,n.extensionName,n.assetType,n.kind);i.push(t)}));n._initialFavorites.forEach((function(n){r(n,i.indexOf(n))}));n._savedFavorites(y(i));u()}))},n.prototype.dispose=function(){var n=this._lifetime;n&&n.dispose();this._lifetime=null},n.prototype._registerDependency=function(){var n=this,t,i;this._assetTypesForSelectedCloud(this._assetTypesPerCloudMap.get(this.selectedCloud())||[]);this.selectedCloud.subscribe(this._lifetime,(function(t){n._assetTypesForSelectedCloud(
n._assetTypesPerCloudMap.get(t)||[]);n._assetTypesForSelectedCloud().length&&(n.possibleFavorites([]),n.possibleFavoritesLookup={},n.loadFavorites(),n._loadFlyoutMenu())}));t=this._services.browseManager;i=t.registerAssetTypesUpdateCallback((function(){n._createPerCloudAssetTypes();n._assetTypesForSelectedCloud(n._assetTypesPerCloudMap.get(n.selectedCloud())||[]);n._updateFavorites(n._assetTypesForSelectedCloud());n._categoriesInitialized&&n._loadFlyoutMenu()}));this._lifetime.registerForDispose((function(){t.unregisterAssetTypesUpdateCallback(i)}))},n.prototype._createPerCloudAssetTypes=function(){var t=this,n=this._services.browseManager.getFilteredAssetTypes()||[];n.length&&this._cloudNames.forEach((function(i){var r=n.filter((function(n){return d(n.cloudName,i)}));t._assetTypesPerCloudMap.set(i,r)}))},n.prototype._updateFavorites=function(n){var t=this;i.forEachKey(this._missingFavoritesWithIndex,(function(i,r){if(r!==-1){var u=lt(n,i,t._services);u&&(u.isHome(!r),u.isFavorite(!0),t.favorites.
splice(r,0,u),t._missingFavoritesWithIndex[i]=-1)}}))},n.prototype._addBrowseMenuItem=function(n,t){var u=p(n.cloudName,n.extension,n.assetTypeManifest.name,t),i=g(n,t,this._services,this._hiddenAssetTypes,u),r;this.possibleFavoritesLookup[u]||(this.possibleFavorites().push(i),r=this.favorites().first((function(n){return n.id===i.id})),r&&(i.isFavorite=r.isFavorite,i.isHome=r.isHome),this.possibleFavoritesLookup[i.id]=i)},n.prototype._addBrowseMenuItemToCategory=function(n,t,i,r,u){var s=p(n.cloudName,n.extension,n.assetTypeManifest.name,i),f=g(n,i,this._services,this._hiddenAssetTypes,s),e,o;u.some((function(n){return n.id===s}))||(e=this.possibleFavoritesLookup[f.id],e&&(f.isFavorite=e.isFavorite,f.isHome=e.isHome,o=f.isHidden=e.isHidden,o(o()||r)),u.splice(t,0,f))},n.prototype._loadFlyoutMenu=function(){var n=this,f=this.possibleFavoritesLookup,t,i,r,e,o;this._assetTypesForSelectedCloud().forEach((function(t){n._addBrowseMenuItem(t,undefined)}));t=this.categories();this.showCategories(!!t.
length);i=u.keys(f).slice(0);t.forEach((function(t){var r=t.possibleFavorites;r();var u=t.sourceCategory,f=u&&u.items||[],e=[];f.length&&(f.forEach((function(t,r){var u=-1,f,o;n._assetTypesForSelectedCloud().some((function(n){var i,e,s;return t.cloudName=t.cloudName||v,ni(t,n)&&(i=n.assetTypeManifest.resourceType,e=(t.kind||"").toLowerCase(),e&&(s=(i&&i.kinds||[]).some((function(n){return n.name.toLowerCase()===e})),s&&(o=t.kind)),u=r,f=n),u>-1}));u>-1&&(o&&n._addBrowseMenuItem(f,o),i.remove(f.id),n._addBrowseMenuItemToCategory(f,u,o,!!t.isHidden,e))})),r(e))}));r=this._uncuratedCategory;e=[];r&&(o=ut(i.map((function(n){return f[n]})),(function(n,t){return ft(n.label(),t.label())})),o.forEach((function(t){var f=t.assetType,u=n._extensionToDefaultCategoryMap[f.extension],s=u||r,h=!u&&n._discoveryPolicy===1,o=s.possibleFavorites,i=[];i=u?o():e;n._addBrowseMenuItemToCategory(f,i.length,undefined,h,i);o(i)})));this.possibleFavorites(ut(this.possibleFavorites(),(function(n,t){return ft(n.label(),t.label())})
))},n})()}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.ViewModelRegistration",["require","exports","f","../../../Extension/ViewModelManager"],(function(n,t,i,r){"use strict";var u;return (function(n){function u(){r.register("Gallery$CsmCommand","./MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand",(function(n){return new n.CsmCommand(t.DefaultCloudName)}))}var t=i.Base.Constants;n.registerViewModels=u})(u||(u={})),u}));define("MsPortalImpl/UI/Hubs/UI.HubsRpcCallbacks",["require","exports","i","FxHubs/HubsSettingsSchema"],(function(n,t,i,r){"use strict";var u;return (function(n){function f(n,i){var r={store:t,keys:i};return n.querySettings(r).then((function(n){var t={};return i.forEach((function(i){t[i]=i in n?n[i]:undefined})),t}))}function e(n,i,r){n.setSettings({store:t,settings:i},r)}function o(n){var t=n.settings,i=n.rpcClient,o=[u.getHubsWindowId()];r.readHubsUserSettings.register(i,o,(function(n){return f(t,n)}));r.writeHubsUserSettings.register(i,o,(function(n){return e(t,n.settings,
n.priority),undefined}))}var u=i.Extension,t=6;n.registerRpcCallbacks=o})(u||(u={})),u}));define("MsPortalImpl/UI/Hubs/UI.NotificationsPane",["require","exports","f","o","ko","MsPortalImpl/Resources/ImplScriptResources","../../Widgets/Widgets.WidgetBase"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){var t=i.Hubs.Notifications.NotificationStatus,r=f.NotificationMenu,o=[t.Information,t.Warning,t.Error,t.Success],s=[t.Information],h=(function(n){function t(){var t=this;n.apply(this,arguments);this.hasNotifications=u.pureComputed((function(){return t.notifications&&(t.notifications()||[]).length}));this.lastPaneOpenedTime=u.observable(Date.now());this.isPaneOpen=u.observable(!1);this.dismissOptions=[{name:r.informational,dismissableStates:s,isEnabled:u.pureComputed((function(){return t._checkNotificationsState(s)}))},{name:r.completed,dismissableStates:o,isEnabled:u.pureComputed((function(){return t._checkNotificationsState(o)}))},{name:r.all,dismissableStates:null,isEnabled:this.hasNotifications}]}
return __extends(t,n),t.prototype._checkNotificationsState=function(n){return this.hasNotifications()&&this.notifications().some((function(t){return n.indexOf(t.status)>-1}))},t})(e.ViewModel);n.ViewModel=h})(o||(o={})),o}));define("MsPortalImpl/UI/UI.NpsHelper",["require","exports","f","../Base/Telemetry"],(function(n,t,i,r){"use strict";var u;return (function(n){function u(u,s,h,c,l){return t||!o&&e&&!n.npsShownInSession?i.require("MsPortalImpl/Widgets/Widgets.Nps").then((function(t){f.Diagnostics.Telemetry.trace({source:r.Source.ToastTray,action:r.Action.NPSShown,data:i.extend({productId:h},c)});t.showSurvey(u,s,h,l);n.npsShownInSession=!0})):Q(null)}function c(n,i){var r=i(),f=Date.now()-h,e=r<f&&Math.random()<s;return t||e?u(n,null,null,{surveyLastCompleted:r},(function(){i(Date.now())})):Q(null)}var f=i.Base,t=i.isFeatureEnabled("testnps"),e=i.isFeatureEnabled("nps"),o=i.isFeatureEnabled("ci"),s=(parseFloat(i.getFeatureValue("npspercent"))||1)/100,h=(parseInt(i.getFeatureValue("npsintervaldays"))||
90)*864e5;n.npsShownInSession=!1;n.showNps=u;n.showPortalNps=c})(u||(u={})),u}));define("MsPortalImpl/UI/Hubs/UI.ResourceMapManagerRpc",["require","exports","FxHubs/RpcEndPoints"],(function(n,t,i){"use strict";var r;return (function(n){function e(n,i){var e=r.getHubsWindowId(),f=function(n){return r.getDescriptor(n.srcWindowId).cloudName};r.mapAssetIdToResourceIdEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.mapAssetIdToResourceId(n,f(r))}))}));r.mapResourceIdToAssetIdEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.mapResourceIdToAssetId(n,f(r))}))}));u.mapResourceIdToAssetIdEndPoint.register(n,[e],(function(n){return i.getService(t).then((function(t){return t.mapResourceIdToAssetId(n.resourceId,n.cloudName)}))}));r.mapResourceIdToDynamicSelectionAndIconEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.mapResourceIdToDynamicSelectionAndIcon(n.resourceId,f(r),{reason:"mapResourceIdToDynamicSelectionAndIcon",
extension:r.srcWindowId})}))}));u.mapResourceIdToDynamicSelectionAndIconEndPoint.register(n,[e],(function(n,r){return i.getService(t).then((function(t){return t.mapResourceIdToDynamicSelectionAndIcon(n.resourceId,n.cloudName,{reason:"mapResourceIdToDynamicSelectionAndIcon",extension:r.srcWindowId})}))}));r.getResourceAssetInformationEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResourceAssetInformation(n,f(r),{reason:"getResourceAssetInformation",extension:r.srcWindowId})}))}));u.getResourceAssetInformationEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResourceAssetInformation(n.data,n.cloudName,{reason:"getResourceAssetInformationForHubs",extension:r.srcWindowId})}))}));r.getResourceEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResource(n.resourceId,n.skipCache,f(r),{reason:n.invoker+":getResource",extension:r.srcWindowId})}))}));r.getResourceGroupEndPoint.register(
n,null,(function(n,r){return i.getService(t).then((function(t){return t.getResourceGroup(n.resourceGroupId,n.skipCache,f(r),{reason:n.invoker+":getResourceGroup",extension:r.srcWindowId})}))}));r.signalResourcesChangedEndPoint.register(n,null,(function(n,r){return i.getService(t).then((function(t){return Q(t.signalResourcesChanged(n,f(r)))}))}));u.signalResourcesChangedEndPoint.register(n,null,(function(n){return i.getService(t).then((function(t){return Q(t.signalResourcesChanged(n.resourceIds,n.cloudName))}))}));u.mapAssetIdToResourceIdEndPoint.register(n,[e],(function(n){return i.getService(t).then((function(t){return t.mapAssetIdToResourceId(n.assetTriplet,n.cloudName)}))}));i.assetManager.onAssetDeleted((function(n,r,u){i.getService(t).then((function(t){t.processAssetDeletion(n,r,u)}))}))}var f=FxImpl,r=f.Extension,u=i.AssetTypes,t="ResourceMapManager";n.setupResourceMapManagerRpc=e})(r||(r={})),r}));define("MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration",["require","exports","f","i",
"../../../Extension/ViewModelManager"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function y(n){var i=u.registerWithState,h,r,c,y;i(l+"ViewModel",t+(f+"Blade"),(function(n,t){var i=new s,r=new n.SettingsBladeViewModel(i,t);return new o(i,r,t)}));h=t+(f+"SettingsPart");i(l+"$SettingsPartViewModel",h,(function(t,i){return e((function(r){return new t.SettingsPartViewModel(r,i,n)}),{createHubsInternalCloudNameProperty:!0,logArea:h})}));i(a+"ViewModel",t+(f+"LanguageSelectionBlade"),(function(n,t){var i=new s,r=new n.LanguageSelectionBladeViewModel(i,t);return new o(i,r,t)}));r=t+(f+"LanguageGrid");i(a+"$LanguageGridViewModel",r,(function(n,t){return e((function(i){return new n.LanguageGridViewModel(i,t)}),{logArea:r})}));i(v+"ViewModel",t+(f+"LocaleSelectionBlade"),(function(n,t){var i=new s,r=new n.LocaleSelectionBladeViewModel(i,t);return new o(i,r,t)}));c=t+(f+"LocaleGrid");i(v+"$LocaleGridViewModel",c,(function(n,t){return e((function(i){return new n.LocaleGridViewModel(i,t)}),{logArea:r})})
);y=t+(f+"DiagnosticsPart");i("Help$HelpAndSupportBlade$DiagnosticsPartViewModel",y,(function(t,i){return e((function(r){return new t.DiagnosticsPartViewModel(r,i,n)}),{logArea:r})}))}var c=r.ViewModels,o=c.CompositionViewModel,e=c.Part.composePartViewModel,s=i.ViewModels.Internal.ContainerViewModel,t="./MsPortalImpl/UI/Hubs/ViewModels/",h="Settings$",l=h+"SettingsBlade",a=h+"LanguageSelectionBlade",v=h+"LocaleSelectionBlade",f="UI.Settings.";n.registerViewModels=y})(f||(f={})),f}));define("MsPortalImpl/UI/UI.SessionHandler",["require","exports","f","ko"],(function(n,t,i,r){"use strict";var u;return (function(t){function e(n,t,u){return t.addCallbacks({onIdle:function(t,i){var f=r.unwrap(n);f&&t.getTime()-i.getTime()>=f*6e4&&(o.warning("Signing out user at {0} after inactivity timeout of {1} minutes".format(t,f)),u())},onBusy:i.noop})}function s(n,t,i,r){f?e(f,i,r):t.subscribeAndRun(n,(function(n){n&&!u?u=e(t,i,r):!n&&u&&i.removeCallbacks(u)}))}var o=i.Base.Diagnostics.createLog(n),f=parseInt(i.
getFeatureValue("idletimeoutmins")),u;t.initialize=s})(u||(u={})),u}));define("MsPortalImpl/UI/UI.StatusHandler",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.SecurityTokens","../Base/Telemetry"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){function v(n,t){return(n&t)===t}function o(n,t,i,r){rt.ClientNotification.publish({title:n,description:t,status:i||b.Information,descriptionAsHtml:r})}function et(n,t,i,r){return new y(n,t,i,r)}var s=i.Base,p=s.Diagnostics,w=p.Telemetry,rt=i.Hubs.Notifications,b=i.Hubs.Notifications.NotificationStatus,h=f.Action,k=f.Source,d=window,c=p.createLog(n),ut=d.fx.environment.errorPageUri,g=s.Constants.Shell,nt=r.Shell,l=nt.Notifications,e=nt.Dialogs,a=l.SessionEnding,tt=l.TokenFailure,it=l.VersionChanged,ft=[12e5,6e5],y;t.create=et;y=(function(){function n(n,t,i,r){this._pageBlockingPrompt=!1;this._isDialogVisible=!1;this._unknownNetworkErrorCount=0;this._unknownNetworkErrorCanceled=!1;this._getDialogManager=
n;this._initializationPromise=t;this._redirectFunc=i;this._showSplashScreenFunc=r}return n.prototype.onLastTokenRefresh=function(n,t){var i=Date.now();if(t<=i)this.onStatus({code:2},n);ft.forEach((function(n){var r=t-n;d.setTimeout((function(){var t=Math.floor(n/6e4),i=t>10?a.messageFmt.format(t):a.message;o(a.title,i)}),r-i)}))},n.prototype.onStatus=function(n,t){var nt=this,r=Q.resolve(null),f,v,y;if(!n||this._pageBlockingPrompt)return r;var rt=t===g,l=rt||t===s.Constants.ExtensionNames.Hubs,a=n.data||{},p=a.uri||"",d=function(n){var u=p,r;return i.isUriAbsolute(u)||(u="//"+t+i.ensurePrefix(u,"/")),r=document.createElement("a"),r.text=n,r.title=r.href=u,r.outerHTML};switch(n.code){case 0:break;case 1:l?r=this._showDialog(t,h.ShellVersionChanged,e.newVersionMessageTitle,e.newVersionMessageDescription,e.newVersionDefaultButtonText,null,3e4,2,5):(w.trace({source:k.Shell,action:h.ExtensionVersionChanged,data:t}),c.warning("Extension reporting incompatible server version. {0}:{1}".format(t,a.
version)),o(it.title,it.messageFmt.format(t)));break;case 2:l?(u.updateAuthState(null),this._redirectFunc({uri:ut+"/UE_SessionExpired"+window.location.hash})):o(tt.title,tt.messageFmt.format(t));break;case 4:if(c.verbose("Received a status code zero from extension {0} for URL '{1}'.".format(t,p)),!l)break;if(this._unknownNetworkErrorCount>3||this._isDialogVisible||this._unknownNetworkErrorCanceled)break;this._unknownNetworkErrorCount++;r=this._showDialog(g,h.UnknownNetworkError,e.connectionErrorMessageTitle,e.connectionErrorMessageDescription.format(d(e.connectionErrorMessagePlaceHolder)),null,e.connectionErrorCancelButtonText,0,2,0).then((function(n){nt._unknownNetworkErrorCanceled=n===1}));break;case 6:f=e.tooManyRequestsDescription.format(d(e.tooManyRequestsLink));v=a.retryAfter;v&&(f=f+" "+e.tooManyRequestsRetry.format(v));o(e.tooManyRequestsTitle,f,b.Warning,!0);break;default:y="Received unknown extension event '{0}' for extension '{1}'.".format(n.code,t);r=Q.reject(y);c.error(y)}return r}
,n.prototype._showDialog=function(n,t,i,r,f,e,o,s,h){var a=this,y,d=this._redirectFunc,p=v(h,2),c,b,l;return this._pageBlockingPrompt=v(h,1),t&&w.trace({source:k.Shell,action:t,data:n}),p&&u.updateAuthState(null),c=function(n){d({skipFlushBuffers:p,delayPromise:n&&o?Q.delay(o):null})},b=v(h,4)&&Q.isPending(this._initializationPromise),b?(y=Q.defer().promise,c(!1)):(l=Q.defer(),this._isDialogVisible=!0,y=this._getDialogManager().then((function(n){return n.showModalDialog({title:i,description:r,defaultButtonText:f,cancelButtonText:e,buttons:s,uiShield:{hidePromise:l.promise}})})).then((function(n){return a._pageBlockingPrompt?(a._showSplashScreenFunc(),l.resolve(),c(!0)):n===4?c(!1):l.resolve(null),n})).finally((function(){a._isDialogVisible=!1}))),y},n})();t.StatusHandlerImpl=y})(e||(e={})),e}));define("MsPortalImpl/UI/UI.ViewTimeTelemetry",["require","exports","f","../Base/Base.Events","../Base/Telemetry","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f){"use strict";var e;return (function(
n){function st(n,t){e=n.desktop;nt=t&&t.increment||w;tt=t&&t.tooSmall||b;g=e.activeJourney.subscribe((function(n){n?c():o(l)}));e.getDashboardManager().then((function(n){p=n.currentDashboardId.subscribe((function(n){c();v=n;o(l)}));v=n.currentDashboardId()}));a(f.default.blur,k=function(){c()});a(f.default.focus,d=function(){o(l)});a(f.default.mousemove,y=function(){h(f.default.mousemove,y);o()})}function ht(){h(f.default.blur,k);h(f.default.focus,d);h(f.default.mousemove,y);g.dispose();p&&p.dispose();c()}function o(n){t||e.activeJourney()||(n&&(rt=0,++it),ut=Date.now(),t=setTimeout((function(){ft();t=null;o()}),nt))}function c(){t!==null&&(clearTimeout(t),ft());t=null}function ft(){var n=Date.now()-ut;n>=tt&&ot.trace({source:u.Source.Shell,action:u.Action.DashboardViewTime,data:{target:"Dashboard",trackId:v,timespan:n,sequenceId:it,sequence:++rt,tileCount:e.startBoard.children.filter((function(n){return!n.dontSetupWidget})).length,fullscreen:!!r.isFullscreen()}})}var et=i.Base,ot=et.Diagnostics.
Telemetry,s=window,l=!0,w=3e5,b=1e4,a=s.addEventListener.bind(s),h=s.removeEventListener.bind(s),e,v="",y,k,d,g,p,nt=w,tt=b,it=0,rt=0,t=null,ut;n.start=st;n.stop=ht})(e||(e={})),e}));define("MsPortalImpl/Interactions/Interactions.ContextMenuTouch",["require","exports","$","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r){"use strict";var u;return (function(n){function c(n){var i=n.originalEvent,t=i&&i.touches,r=t&&t.length===1,u=t&&t[0];return r?u:null}function v(){var n={width:0,height:0,top:t.targetY,left:t.targetX};u.css(n);i("body").append(u);u.animate({width:f,height:f,top:"-="+(f/2+5),left:"-="+f/2},75)}function y(n){if(n){var t={opacity:.2},i={opacity:1};u.animate(t,25).animate(i,25).animate(t,25).animate(i,25)}u.animate({width:0,height:0,top:"+="+f/2,left:"+="+f/2},75,(function(){u.detach()}))}function o(n,i){i.off(e);s.clearTimeout(h);y(n);t={startTime:0,target:null,targetX:0,targetY:0}}function p(n){o(!0,i(n.currentTarget))}function w(r){var u=c(r),f=i(r.currentTarget),e=Math.
abs(t.targetX-u.clientX),s=Math.abs(t.targetY-u.clientY);(e>n.MoveTolerancePixels||s>n.MoveTolerancePixels)&&o(!0,f)}function b(u){var s=i(u.currentTarget),h,f;t.startTime&&(h=Math.abs(Date.now()-t.startTime),h>=n.ReactionDelayMillis&&(s.off(r.default.contextmenu+e),f=i.Event(r.default.contextmenu),f.clientX=t.targetX,f.clientY=t.targetY,i(t.target).trigger(f)));o(!1,s)}function l(u){var f=c(u),l=i(u.currentTarget);if(!f){o(!0,l);return}if(!t||t.startTime===0){t={startTime:Date.now(),target:u.target,targetX:f.clientX,targetY:f.clientY};h=s.setTimeout((function(){v()}),n.ReactionDelayMillis);l.on(r.default.contextmenu+e,(function(){return!1})).on(r.default.touchmove+e,w).on(r.default.touchcancel+e,p).on(r.default.touchend+e,b)}}function k(n){n.on(r.default.touchstart,l)}function d(n){n.off(r.default.touchstart,l);o(!0,n)}var s=window;n.ReactionDelayMillis=550;n.MoveTolerancePixels=10;n.HintClassIdentifier="fxs-contextMenuTouchHint";var a="<div class='"+n.HintClassIdentifier+"' style='position: fixed;z-index: 500border: 2px solid grey;box-sizing: border-box;background-color: rgba(255, 255, 255, 0.2);pointer-events: none;'><\/div>",
u=i(a),f=110,e=".cmtevt",h,t={startTime:0,target:null,targetX:0,targetY:0};n.register=k;n.unregister=d})(u||(u={})),u}));define("MsPortalImpl/Widgets/Widgets.ContextPane",["require","exports","f","o","ko","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Generated/SvgStartupDefinitions","MsPortalImpl/Resources/ImplScriptResources","./Widgets.Common","./Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes","../../_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";var a;return (function(n){var y=o.Content.SvgStartup,a=e.findByClassName,v=s.ContextPane,p="fxs-contextpane",r="fxs-contextpane-close",t="fxs-contextpane-expand",w="fxs-progress-dots",b="fxs-contextpane-button-inner",k="fxs-contextpane-content",d="fxs-portal-bg-txt-br",nt=(function(n){function t(){n.call(this,"fxs-contextpane-identifier");this.opened=u.observable(!1);this.loading=u.observable(!1)}return __extends(t,n),t})(c.ViewModel),g;n.
ViewModel=nt;g=(function(n){function o(i,u){n.call(this,i,u);var e='<button type="button" class="'+t+' fxs-display-none"><div class="'+b+' fxs-portal-svg">'+f.getSvgReferenceOrFallBackToData(y.hamburger)+"<\/div><\/button>"+('<button type="button" class="'+r+' fxs-display-none" title="'+v.close+'"><div class="'+b+' fxs-portal-svg">'+f.getSvgReferenceOrFallBackToData(y.close)+"<\/div><\/button>")+('<div class="'+w+'">')+"<div><\/div><div><\/div><div><\/div><\/div>";i.addClass(p).addClass(d).attr("role","complementary").append(e);this._$closeButton=a(i,r);this._$expandButton=a(i,t);this._$progress=a(i,w);this._init();this._attachEventHandlers(u)}return __extends(o,n),o.prototype.dispose=function(){this._cleanElement(p,d);this.element.removeAttr("role");n.prototype.dispose.call(this)},o.prototype.hasContent=function(){return!!this._$content},o.prototype.addChild=function(n){var t,i;if(!n)throw new Error("Can't add null child.");this.hasContent()&&this.removeChild(null);t=this._$content=n.element?
n.element:n;t.addClass(k).insertBefore(this._$progress);i=!t.hasClass("fxs-blade")&&!t.hasClass("fxs-partgallery-container");e.toggle(this._$closeButton,i);e.toggle(this._$expandButton,t.hasClass("fxs-partgallery-container"))},o.prototype.insertChild=function(n){this.addChild(n)},o.prototype.removeChild=function(n,t){return this._$content?(t?this._$content.detach():this._$content.remove(),this._$content.removeClass(k),this._$content=null,!0):!0},o.prototype.clear=function(n){return this.removeChild(null,n)},o.prototype.setFocus=function(){if(!i.isFeatureEnabled("skipautofocus")){var n=this._$content;n&&h.waitForBindings(this.element[0]).then((function(){n.findFirstTabbable().focus()}))}},o.prototype._init=function(){var n=this.ltm,t=this.element,i=this.options;u.reactor(n,(function(){var n=i.opened();t.toggleClass("fxs-contextpane-visible",n)}));u.reactor(n,(function(){var n=i.loading();t.toggleClass("fxs-contextpane-loading",n)}))},o.prototype._attachEventHandlers=function(n){var u=this.element,
i=u.findByClassName.bind(u),f,e;i(r).on(l.default.click,f=function(){u.trigger(l.default.fxcontextpaneclosing)});i(t).on(l.default.click,e=function(){n.collapsed(!n.collapsed())});n.collapsed&&n.collapsed.subscribeAndRun(this.ltm,(function(n){i(t).attr({title:n?v.expand:v.collapse,"aria-expanded":!n})}));this.ltm.registerForDispose((function(){i(r).off(l.default.click,f);i(t).off(l.default.click,e)}))},o})(c.Widget);n.Widget=g})(a||(a={})),a}));define("_generated/Templates/WidgetsPanorama",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-startboard-target" aria-labelledby="startboard-title"><\/div> <div class="fxs-journey-target"><\/div>'}}));define("MsPortalImpl/Widgets/Widgets.Panorama",["require","exports","f","o","$","MsPortalImpl/Resources/ImplScriptResources","./Widgets.WidgetBase","../../_generated/Templates/WidgetsPanorama","./Widgets.StartBoard","./Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.Timers","../../Viva.Controls/Util/Viva.Resize",
"../../_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";var v;return (function(n){function it(n,t){var i=n.length,r=n[i-1],u=n[i-2];i>0&&(r.widget.visible()?v(n,t)&&u.widget.visible(!0):b(n,t,!0))}function rt(n,t){var r=n.length,i,u;if(n[r-1].subjourney)for(i=r-2;i>=0&&n[i].widget.visible();--i)n[i].widget.visible(!1);else u=d(n,t),u.freespace<0&&k(n,r-(v(n,t)?3:2))}function b(n,t,i){i===void 0&&(i=!1);var r=d(n,t,i);k(n,r.unfitIdx)}function k(n,t){for(var i=t+1;i<n.length&&!n[i].widget.visible();)n[i++].widget.visible(!0);while(t>=0&&n[t].widget.visible())n[t--].widget.visible(!1)}function d(n,t,i){var f;i===void 0&&(i=!1);for(var e=t,u=n.length,r=u-1;r>=0&&(i||n[r].widget.visible())&&t>=0&&(r===u-1||!n[r+1].subjourney);)f=n[r],f.maximized?t=-1:t-=f.idealWidth,(t>=0||r===u-1)&&--r;return r===u-2&&v(n,e)&&--r,{freespace:t,unfitIdx:r}}function v(n,t){var r=n.length,i=n[r-1],u=n[r-2];return r>1&&u.actStyle&&!i.subjourney&&t>=i.idealWidth+
u.idealWidth&&(!i.widget.options.fullWidthExtensionOptOut||!i.widget.element.hasClass("fxs-menublade"))}function ut(n){var t=n.length;return n.map((function(n,i){var r=n.options,u=r.useActivationStyle&&i!==t-1,f=r.displayState()===2&&!u;return{widget:n,idealWidth:n.idealWidth(u),actStyle:u,maximized:f,subjourney:r.asSubJourney}}))}function g(n){var t=n.widget.element;t.toggleClass("fxs-blade-has-activation",n.actStyle);t.toggleClass("fxs-blade-maximized",n.maximized);t.css("width",n.maximized?"100%":n.idealWidth+"px")}var nt=window,t="fxs-panorama",r="fxs-blade-firstblade",y=i.encodeHtml(f.Portal.preview),p="Can't add null child.",tt=(function(n){function t(t,i){n.call(this,t);this.rotateThemeEvent=null;this.applyViewSettings(i)}return __extends(t,n),t.prototype.getViewSettings=function(){return{}},t.prototype.applyViewSettings=function(){return},t})(h.ViewModel),w;n.ViewModel=tt;w=(function(n){function f(f,e){var s=this,h;n.call(this,f,e);this._prevBlades=0;this._prevHasLoadingBlades=!1;this.
_rePosArgs=[];f.addClass(t).html(o());f.findByClassName("fxs-panorama-previewbadge").attr("title",y).findByClassName("fxs-panorama-previewbadge-text").text(y);h=i.isFeatureEnabled("nohozscroll");this.ltm.registerForDispose(f.setEvents(h?[c.default.fxbladerepos,function(n,t){s._rePosArgs.push(t);s._rePositionBlades()}]:[c.default.fxensureviewportvisible,function(n,t){n.stopPropagation();s.ensureElementInViewport(t.widget,t.alignStart)}],[c.default.doubleclick,function(n){var i=u(n.target),r=i.hasClass(t),f=i.hasClass("fxs-startboard-layout"),e=i.hasClass("fxs-flowlayout-childcontainer"),o=i.hasClass("fxs-journey-layout");(r||f||e||o)&&(n.preventDefault(),n.stopPropagation(),nt.getSelection().removeAllRanges(),s.trigger(c.default.fxrotatetheme))}]));h&&(this._rePositionBlades=i.debounce((function(){var v=s._rePosArgs.length&&s._rePosArgs.every((function(n){return n&&n.noExitPeekMode})),o;s._rePosArgs=[];var h=s.getJourneyWidget(),l=h?h.getBlades():[],a=l.filter((function(n){return n.bladeDefinitionLoaded})
),f=l.length!==a.length,n=ut(a),t=n.length,u=s._prevBlades,e=s.element.outerWidth();v&&s._peekMode?n.forEach(g):(u>t?it(n,e):u===t?b(n,e):rt(n,e),o=!1,n.forEach((function(n){var t=n.widget,u=t.element;g(n);u.toggleClass(r,t.visible()&&!o);i.isFeatureEnabled("collapseblade")&&n.widget.options.collapseVisible(n.actStyle);n.actStyle||n.widget.options.collapsed(!1);t.visible()&&(o=!0)})),(u!==t||s._prevHasLoadingBlades!==f)&&(t&&!u?s.trigger(c.default.fxshowjourney):t||f||s.trigger(c.default.fxshowstartboard),s._prevBlades=t,s._prevHasLoadingBlades=f),s.trigger(c.default.fxpeekmode,null,{enter:!1}))}),1),a.track(this.ltm,this.element,(function(){s._rePosArgs.push({noExitPeekMode:!0});s._rePositionBlades()})))}return __extends(f,n),f.prototype.dispose=function(){this._cleanElement(t);n.prototype.dispose.call(this)},f.prototype.addChild=function(n){if(!n)throw new Error(p);this.getJourneyWidget().addChild(n)},f.prototype.insertChild=function(n,t){if(!n)throw new Error(p);this.getJourneyWidget().insertChild(
n,t)},f.prototype.removeChild=function(n){var t=this.getJourneyWidget();return t&&t.removeChild(n)},f.prototype.getStartBoardArea=function(){return this.element.findByClassName("fxs-startboard-target")},f.prototype.getJourneyArea=function(){return this.element.findByClassName("fxs-journey-target")},f.prototype.getStartBoardWidget=function(){return e.Widget.getWidget(this.getStartBoardArea(),s.Widget)},f.prototype.getJourneyWidget=function(){var n=e.Widget.getWidgets(this.getJourneyArea());if(n.length>1)throw new Error("The journey target has been initialized with more than one widget.");return n[0]},f.prototype.saveViewSettings=function(){return this.options.getViewSettings()},f.prototype.ensureElementInViewport=function(n,t){var r=this,i=this.element,f=i.scrollLeft();l.requestAnimationFrame((function(){var o,w;if(n&&u.contains(r.element[0],n.element[0])){if(o=n.element,t){r._snapElementToEdge(o);return}var e,a=o.outerWidth(),v=i.outerWidth(),s=i.scrollLeft(),y=s+v,h=o.position().left,p=
h+a;if(h<s){if(e=h,w=n,w.options.isMenuBlade()){var b=r.getJourneyWidget(),c=b&&b.getBlades(),l=c&&c[c.length-2];l&&l.options.usingActivationStyle()&&(e=l.element.position().left)}}else(p>y||f>s)&&(e=a>v?h:s+(p-y));e!==undefined&&i.scrollLeft(e)}}))},f.prototype._snapElementToEdge=function(n){var t=this;n&&n.length!==0&&n.handleTransitionEndOnce("width",200,(function(){var i=t.element,r;i.width()>=n.width()&&(r=n.position().left,i.scrollLeft(r||0))}))},f.prototype.peekMode=function(n){this._peekMode=n;n?this.element.find(".fxs-blade").removeClass(r).first().addClass(r):(this._rePosArgs.push({noExitPeekMode:!1}),this._rePositionBlades())},f})(h.Widget);n.Widget=w})(v||(v={})),v}));define("_generated/Templates/WidgetsSearch",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-search" role="search" data-bind="css: { \'fxs-search-expanded\': data.isExpanded(), \'fxs-search-no-journeys\': !data.journeysShown() }, attr: { \'aria-label\': searchLabel }"> <div class="fxs-box-wrapper" data-bind="css: { \'fxs-searching\': data.showSearching() }"> <div class="fxs-icon msportalfx-svg-flip-horizontal" data-bind="image: data.icons.search"><\/div> <div class="fxs-searchbox fxs-topbar-input"><\/div> <div class="fxs-indicator"> <div><\/div><div><\/div><div><\/div> <\/div> <div role="presentation" aria-hidden="true" class="fxs-cross">&times;<\/div> <\/div> <a href="#" class="fxs-search-icon fxs-topbar-button fxs-trim-svg fxs-trim-hover" role="button"> <div class="msportalfx-svg-flip-horizontal" data-bind="image: data.icons.search"><\/div> <\/a> <div class=\'fxs-menu fxs-popup fxs-portal-bg-txt-br fxs-dropmenu-content\' data-bind=\'visible: data.showMenu()\' title=\'\'><\/div> <\/div>'}
}));define("MsPortalImpl/Widgets/Widgets.Search",["require","exports","f","o","ko","MsPortalImpl/Resources/ImplScriptResources","../../Viva.Controls/Controls/Forms/Viva.TextBox","./Widgets.WidgetBase","../../_generated/Templates/WidgetsSearch","MsPortalImpl/Base/Base.EventTypes","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(n){var r;n.searchClass="fxs-search";n.searchBoxClass="fxs-searchbox";var c="fxs-search-icon",l="fxs-hidden-important",t=f.Search,a=(function(n){function r(){n.apply(this,arguments);this.journeysShown=u.observable(!1);this.isExpanded=u.observable(!1);this.showMenu=u.observable(!1);this.showResults=u.observable(!1);this.showSearching=u.observable(!1);this.showExternalColumn=u.observable(!1);this.showAllSubscriptionsSearch=u.observable(!1);this.showChangeSubscriptions=u.observable(!1);this.icons={search:i.Base.Images.Search({isLogo:!0})};this.text=t;this.filter=u.observable();this.searchInFilterText=
u.observable();this.subscriptionSummary=u.observable();this.mruItems=u.observableArray();this.results=u.observableArray()}return __extends(r,n),r})(o.ViewModel);n.ViewModel=a;r=(function(r){function o(o,a){var v=this,b;r.call(this,o,a);this._initialized=Q.defer();b=n.searchClass;o.addClass(b).html(s());window.fx.environment.chrome.hideSearchBox&&o.addClass(l);this._bindDescendants({text:a.text,searchLabel:f.KeyboardShortcuts.search});var tt=o.findByClassName(n.searchBoxClass),k=this._textWidget=new e.Widget(tt,{placeholder:i.isFeatureEnabled("globalsearch")?u.observable(t.globalPlaceholder):u.observable(t.placeholder),readonly:u.observable(!1)}),it=this._textField=$(k._getElementToFocus()),w,d,g,y=h.default.focusin,nt=h.default.mousedown,p=o.findByClassName(c);o.on(y,w=function(){o.off(y,w);a.showMenu(!0);var n=v._initOptions;(n&&n()||Q(!0)).then((function(){i.require("MsPortalImpl/Widgets/Widgets.SearchDefered").then((function(n){v._initialized.resolve();n.initialize(v,it)}))}))});p.on(y,d=
function(n){n.preventDefault();v.setFocus()});p.on(nt,g=function(n){n.preventDefault();v.setFocus()});this.ltm.registerForDispose((function(){k.dispose();o.off(y,w);p.off(y,d);p.off(nt,g)}))}return __extends(o,r),o.prototype.setFocus=function(){this.options.isExpanded(!0);this._textField.focus()},o.prototype.initOptions=function(n){this._initOptions=n},o.prototype.isDropdownInitialized=function(){return this._initialized.promise},o})(o.Widget);n.Widget=r})(c||(c={})),c}));define("MsPortalImpl/Widgets/Widgets.SideBar",["require","exports","f","i","o","ko","../Base/Base.Router","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","../UI/Hubs/UI.FavoritesManager","../Base/Telemetry","./Widgets.WidgetBase","MsPortalImpl/Base/Base.EventTypes","../../_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function g(n,t,i){pt.trace({source:c.Source.SideBar,name:t,action:n,data:i})}function li(n,t,r,u){var f=u?v.expand:v.
collapse;n.toggleClass(gt,u);t.attr({title:f,"aria-expanded":!u});p&&(t.hasClass(it)?t.removeClass(it):t.addClass(it));n.handleTransitionEndOnce("width",150,(function(){i.isFeatureEnabled("nohozscroll")||$(ut).trigger(a.default.fxpaneresize)}))}function ai(n){var u=n.isCollapsed,f=u(),t=!f,i=n.saveCollapseState,r;ei?(r=n.getStartboardVisible,r&&r()&&i&&i(t)):i&&i(t);u(t);g(d.SideBarViewChanged,"",t?"collapsed":"expanded")}function lt(n,t,i){var f;if(t){var r=i.favorites,u=r.indexOf(n),e=r.indexOf(t);if(u||!t.opensExternal)return g(d.SideBarFavoriteMoved,t.id,{oldIndex:e,newIndex:u}),r.valueWillMutate(),f=r(),f.splice(u,0,f.splice(e,1)[0]),i.favoritesManager().move(u),r.valueHasMutated(),u}return-1}function vi(n,t,i){var u=$(document.activeElement).parent(),e=i===40?u.next(st)[0]:u.prev(st)[0],o,r;e&&(o=f.dataFor(e),r=lt(o,n,t),r>=0&&Q.fcall((function(){var i=t.favorites()[r].uri,n=$("."+ot+" [href|='"+i+"']")[0];n&&n.focus()})))}var rt=i.Base,vt=i.ViewModels.Obsolete.Forms.DropDown,yt=vt.ViewModel,
pt=rt.Diagnostics.Telemetry,y=rt.Images,ut=window,ft=ut.fx.environment,w=a.default.click,wt=ft.branding,bt="fxs-sidebar-collapse-button",kt="fxs-sidebar-create",dt="fxs-sidebar-draggable",nt=".fxs-sidebar-droppable",gt="fxs-sidebar-is-collapsed",ni=".fxs-sidebar-item a",ti=r.Extension.getHubsWindowId()+"_Dashboard",b="fxs-sidebar-entered",k=".fxs-sidebar-entered",et="fxs-sidebar-flyout",tt=a.default.keydown,ii={deferred:!0},ot="fxs-sidebar-bar",ri="fxs-sidebar-browse",ui="fxs-sidebar-browse-shown",st="li.fxs-sidebar-item",it="fxs-sidebar-collapse-button-flip",v=o.SideBar,d=c.Action,fi=i.isFeatureEnabled("userdefineddefaultview"),ei=i.isFeatureEnabled("sideBarAutoCollapsedInJourney"),p=i.isFeatureEnabled("improvedsidebar"),ht='<button class="fxs-sidebar-collapse-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="image: data.collapseIcon"><\/button><!-- ko if: data.cloudOptions().length > 1 --><div class="fxs-sidebar-cloudFilter" data-bind=\'formElement: func.cloudDropDown\'><\/div><!-- /ko --><button class="fxs-sidebar-create fxs-trim-hover fxs-trim-border" role="button" data-bind="attr: { title: data.createTooltip, \'aria-label\': data.createTooltip }, visible: !data.hideCreateButton()"><div class="fxs-sidebar-button-flex"><div class="fxs-sidebar-create-icon fxs-fill-success" data-bind="image: data.icons.plus"><\/div><div class="fxs-sidebar-create-label fxs-sidebar-show-if-expanded fxs-trim-text" aria-hidden="true" data-bind="text: data.createText"><\/div><\/div><span class="fxs-hide-accessible-label" data-bind="text: data.newResourceAriaLabel"><\/span><\/button>',
ct='<div class="fxs-sidebar-middle"><ul class="fxs-sidebar-favorites" data-bind="attr: { \'aria-label\': data.svcListText }"><!-- ko foreach: func._favorites --><li class="fxs-sidebar-item fxs-trim-hover fxs-sidebar-draggable fxs-sidebar-droppable fxs-trim-border" draggable="true" data-bind="attr: {\'aria-label\': label }"><a href="" class="fxs-sidebar-item-link fxs-trim-text" data-bind="attr: { href: uri, title: label, role: \'link\' }"><div class="fxs-sidebar-icon fxs-trim-svg" data-bind="image: image"><\/div><div class="fxs-sidebar-label fxs-sidebar-show-if-expanded" aria-hidden="true" data-bind="text: label"><\/div><div class="fxs-sidebar-external fxs-sidebar-show-if-expanded" data-bind="visible: $data.opensExternal"><div class="fxs-trim-svg-secondary" data-bind="image: $root.data.icons.hyperlink"><\/div><\/div><div class="fxs-sidebar-handle fxs-trim-svg-secondary" data-bind="image: $root.data.icons.ellipsis"><\/div><span class="fxs-hide-accessible-label" data-bind="text: label"><\/span><\/a><\/li><!-- /ko --><\/ul><\/div>',
oi='<nav class="fxs-sidebar-bar fxs-trim fxs-trim-text" data-bind="attr: { \'aria-label\': data.svcNavLabel }"><div class="fxs-sidebar-top">'+ht+"<\/div>"+(""+ct)+'<div class="fxs-sidebar-bottom"><div class="fxs-sidebar-browse fxs-trim-hover fxs-menu-browse msportalfx-vertical-center" tabindex="0" role="button" aria-expanded="false" data-bind="attr: { title: data.browseTooltip, \'aria-label\': data.browseText }"><div class="fxs-sidebar-button-flex"><div class="fxs-sidebar-browse-label fxs-trim-text fxs-sidebar-show-if-expanded" data-bind="text: data.browseText"><\/div><div class="fxs-sidebar-browse-icon fxs-trim-svg" data-bind="image: data.icons.caretUp"><\/div><\/div><\/div><div class="fxs-sidebar-flyout fxs-popup fxs-portal-bg-txt-br fxs-sidebar-flyout-is-hidden" role="presentation"><\/div><\/div><\/nav>',si='<nav class="fxs-sidebar-bar fxs-trim fxs-trim-text" data-bind="attr: { \'aria-label\': data.svcNavLabel }"><div class="fxs-sidebar-top">'+ht+'<div class="fxs-sidebar-browse fxs-trim-hover fxs-menu-browse msportalfx-vertical-center" tabindex="0" role="button" aria-expanded="false" data-bind="attr: { title: data.browseTooltip, \'aria-label\': data.browseText }"><div class="fxs-sidebar-button-flex"><div class="fxs-sidebar-browse-icon fxs-trim-svg" data-bind="image: data.icons.allServices"><\/div><div class="fxs-sidebar-browse-label fxs-trim-text fxs-sidebar-show-if-expanded" data-bind="text: data.browseText"><\/div><\/div><\/div><div class="fxs-sidebar-flyout fxs-popup fxs-portal-bg-txt-br fxs-sidebar-flyout-is-hidden" role="presentation"><\/div><\/div><div class="fxs-sidebar-favorites-section"><div class="fxs-sidebar-pre-divider fxs-trim-border"><\/div><div class="fxs-sidebar-star-icon" data-bind="image: data.icons.star"><\/div><span class="fxs-sidebar-myfavorites" data-bind="text: data.myFavoritesText, visible: !data.isCollapsed()"><\/span><div class="fxs-sidebar-post-divider fxs-trim-border"><\/div><\/div>'+
(""+ct)+"<\/nav>",hi=p?""+si:""+oi,ci=(function(n){function t(){n.call(this);this.browseText=p?v.allServices:wt.browseLabel;this.svcListText=v.svcList;this.svcNavLabel=v.svcNavLabel;this.closeText=v.close;this.myFavoritesText=v.myFavorites;this.browseTooltip=this.browseText;this.createText=p?v.createResource:v.create;this.createTooltip=v.createTooltip;this.newResourceAriaLabel=v.newResourceAriaLabel;this.favorites=f.observableArray();this.isCollapsed=f.observable(!0);this.onFavoritesChanged=f.observableArray([]);this.possibleFavorites=f.observableArray();this.previewText=v.preview;this.icons={hamburger:y.Hamburger({isLogo:!0}),allServices:y.AllServices(),doubleChevron:y.DoubleChevron({palette:5}),star:y.Star({isLogo:!0,customClass:"msportalfx-svg-c11"}),plus:y.Plus({isLogo:!0}),hyperlink:y.Hyperlink({isLogo:!0}),ellipsis:y.Ellipsis({isLogo:!0}),caretUp:y.CaretUp({isLogo:!0})};this.collapseIcon=p?this.icons.doubleChevron:this.icons.hamburger;this.cloudOptions=f.observableArray();this.selectedCloud=
f.observable();this.favoritesManager=f.observable();this.hideCreateButton=f.observable(!0);this.hideCreateButton(ft.chrome.hideCreateButton)}return __extends(t,n),t.prototype.openFavorite=function(n,t,i){var r;if(typeof n=="number"){var u=this.favoritesManager(),f=u&&u.favorites||this.favorites,e=f();if(n||e.length)r=f()[n];else if(r=this.possibleFavorites().first((function(n){return n.id===ti})),r)this.favorites.push(r);else this.onDashboardFavoriteClick(c.Source.SideBar)}else r=n;if(r){if(r.opensExternal)return this.openExternal(r.uri),!0;if(!t&&!i){if(r.opensDashboard)this.onDashboardFavoriteClick(c.Source.SideBar);else this.launchBlade(r.uri);return!0}}},t.prototype.openExternal=function(n){window.open(n,"_blank")},t.prototype.attachFavoritesManager=function(n){this.favoritesManager(n)},t.prototype.initLifetime=function(n){var t=this;this.favoritesManager.subscribeAndRun(n,(function(i){i&&(h.connectDebouncedObservable(n,t.selectedCloud,i.selectedCloud,!0),h.connectDebouncedObservable(
n,i.favorites,t.favorites))}))},t})(l.ViewModel),at;t.ViewModel=ci;at=(function(n){function t(t,r){var u=this,l,e,c,o;n.call(this,t,r);t.attr("role","presentation").html(hi);fi&&t.addClass("fxs-sidebar-defaultviewenabled");p&&t.addClass("fxs-sidebar-improvedsidebar");this._createButton=t.findByClassName(kt);this._browseLink=t.findByClassName(ri);l=this._collapseButton=t.findByClassName(bt);this._sideBar=t.findByClassName(ot);e=this.ltm;r.initLifetime(e);c=this._favorites=r.favorites.filter(e,(function(n){return n&&n.cloudName===r.selectedCloud()})).map((function(n){return n.image=n.image&&i.Base.Images.CustomImageWithOptions(n.image,{isLogo:!0}),n}));c.extend(ii);this.cloudDropDown=new yt(e,{label:f.observable(v.cloud),options:r.cloudOptions});o=this.cloudDropDown.value;r.cloudOptions.subscribe(e,(function(n){n.length>0&&!o()&&o(n[0].value)}));o.subscribe(e,(function(n){r.selectedCloud(n);r.favoritesManager().selectedCloud(n)}));this._bindDescendants();this._flyout=t.findByClassName(et);this._attachEventHandlers(
e,t,r);f.computed(e,r.onFavoritesChanged,(function(n){if(n.length){c();var i=s.findByClassName(t,"fxs-sidebar-favorites:first .fxs-sidebar-item");n.slice().forEach((function(n){n(i)}))}}));this._getSidebarFlyout=i.memoizeQ((function(){return i.require("MsPortalImpl/Widgets/Widgets.SideBarFlyout").then((function(n){var i=new n.ViewModel,t=new n.Widget(u.element.findByClassName(et),i,u.options.favoritesManager());return u._initOptions&&u._initOptions().then((function(){t.options.openFeedbackPane=u.options.openFeedbackPane})),t.options.launchBlade=u.options.launchBlade,t.options.openFavorite=u.options.openFavorite,h.connectDebouncedObservable(u.ltm,u.options.selectedCloud,t.options.selectedCloud,!0),t}))}));r.isCollapsed.subscribeAndRun(e,(function(n){li(t,l,r,n)}))}return __extends(t,n),t.prototype.dispose=function(){n.prototype.dispose.call(this);this._cleanElement()},t.prototype.initOptions=function(n){this._initOptions=n},t.prototype.toggleFlyout=function(){var n=this._flyout.hasClass("fxs-sidebar-flyout-is-hidden");
i.tryImmediateResolve(this._getSidebarFlyout(),(function(t){t.toggle(n)}))},t.prototype.openCreate=function(){g(d.SideBarNewMenuOpened);this.options.launchBlade(e.getGalleryDeepLink("hub","",this.cloudDropDown.value()))},t.prototype.reorderFavorites=function(n){var t=f.dataFor(document.activeElement);vi(t,this.options,n)},t.prototype._attachEventHandlers=function(n,t,i){var u=this,s=this._flyout,h=this._sideBar,r=function(t,i,r,u){t.on(i,r,u);n&&n.registerForDispose((function(){t.off(i,r,u)}))},e,o;r(this._createButton,w,null,(function(){u.openCreate()}));e=this._browseLink;o=function(n){s.addClass(ui);u.toggleFlyout();n.stopPropagation()};r(e,w,null,o);r(e,tt,null,(function(n){var t=n.keyCode;if(t===13||t===32)return o(n),!1}));r(t,w,ni,(function(n){var t=f.dataFor(n.target);g(d.SideBarItemOpened,t.id,{isFavorite:t.isFavorite(),isHome:t.isHome()});u.options.openFavorite(t)&&n.preventDefault()}));r(this._collapseButton,w,null,(function(){ai(i)}));f.reactor(n,i.favorites,(function(n){n.forEach((function(
n,t){n.isHome(!t)}))}));r(h,tt,null,(function(n){var i=n.keyCode,t;n.type===tt&&i===32&&(t=$(n.target),t.trigger(a.default.click),t.hasClass("fxs-sidebar-filter-input")||n.preventDefault(),n.stopPropagation())}));r(t,a.default.dragstart,"."+dt,(function(n){var t=n.originalEvent.dataTransfer;t.setData("text","foo");t.effectAllowed="move";u._dragItem=f.dataFor(n.target)}));r(t,a.default.dragover,null,(function(n){n.preventDefault()}));r(t,a.default.dragenter,null,(function(n){var t=$(n.target),i=t.closest(nt),r=t.closest(k);r.length===0&&($(k).removeClass(b),i.length&&i.addClass(b))}));r(t,a.default.dragleave,null,(function(n){var t=$(n.target).closest(nt).length===0?!0:!1;t&&$(k).removeClass(b)}));r(t,a.default.drop,null,(function(n){var t=n.target,r=$(t).closest(nt),e=f.dataFor(t);n.preventDefault();$(k).removeClass(b);r.length&&lt(e,u._dragItem,i)}))},t})(l.Widget);t.Widget=at}));define("MsPortalImpl/Widgets/Widgets.ToastViewModel",["require","exports","o","a","ko","MsPortalImpl/Resources/ImplScriptResources",
"./Widgets.WidgetBase"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function i(n){var i=u.unwrap(n&&n.timeoutID);i&&t.clearTimeout(i)}var t=window,s=5e3,h=3e4,o;n.clearItemTimeout=i;o=(function(e){function o(n){n===void 0&&(n={});e.call(this);this.displayCount=4;this.shouldShowToasts=u.observable(!0);this._items=u.observableArray();this.eventHandlers=u.observableArray();this.closeTitle=f.NotificationMenu.dismissToast;this.displayCount=n.displayCount||this.displayCount;this.shouldShowToasts=n.shouldShowToasts||this.shouldShowToasts}return __extends(o,e),o.prototype.addToasts=function(n){var t=this,e=r.isArray(n)?n:[n];e.length&&e.forEach((function(n){var l=t._items(),a=n.icon,v=n.title,y=n.description,p=n.uri,w=n.time,e=n.ids||[],s=n.data||null,h=n.duration||0,b=n.htmlContent||"",k=n.clickable!==!1,d=n.descriptiveText||f.Toast.description.format(n.title),r,o;if(e.length>0&&(r=l.first((function(n){var t=n.ids();return e.some((function(n){return t.indexOf(n)>-1}))}))),r)r.icon(
a),r.title(v),r.description(y),r.uri(p),r.time(w),r.ids(e),r.data(s),r.clickable(k),r.htmlContent(b),r.descriptiveText(d),r.duration(h),r.formSection(n.formSection),i(r),t.startRemoveTimer(r);else{o={icon:u.observable(a),title:u.observable(v),description:u.observable(y),uri:u.observable(p),time:u.observable(w),ids:u.observableArray(e),data:u.observable(s),htmlContent:u.observable(b),timeoutID:u.observable(null),clickable:u.observable(k),onDismissFn:n.onDismissFn,descriptiveText:u.observable(d),duration:u.observable(h),formSection:u.observable(n.formSection)};(l.length<t.displayCount||t._canDeque(h))&&t._items.unshift(o);var tt=(s||{}).inlineForm,g=n.formSection,nt=g&&g.children()||[],c=nt.length>1&&nt[1].children();c&&tt.buttons.forEach((function(n,i){if(!n.endpoint){var r=c[i].onClick;c[i].onClick=function(){r();t.removeToast(o)}}}));t.startRemoveTimer(o)}}))},o.prototype._canDeque=function(n){for(var t,r,u=this._items(),i=0;i<=n+0;i++)for(t=u.length-1;t>=0;t--)if(r=u[t],r.duration()===i)
return this.removeToast(r),!0;return!1},o.prototype.removeToast=function(t){n.clearItemTimeout(t);this._items.remove(t)},o.prototype.removeAllToasts=function(){this._items().forEach((function(t){n.clearItemTimeout(t)}));this._items.removeAll()},o.prototype.startRemoveTimer=function(n){var f=this,r=u.unwrap(n.duration)||0,i;r!==2&&(i=s,r===1&&(i=h),n.timeoutID(t.setTimeout((function(){f._items.remove(n)}),i)))},o})(e.ViewModel);n.ViewModel=o})(o||(o={})),o}));define("MsPortalImpl/Widgets/Widgets.Portal",["require","exports","f","o","ko","../Interactions/Interactions.ContextMenuTouch","../Interactions/Interactions.OverflowAutoTooltip","../Services/Services.GeneralSettings","../Base/Telemetry","./Widgets.WidgetBase","./Widgets.ContextPane","./Widgets.Panorama","./Widgets.Search","./Widgets.SideBar","./Widgets.ToastViewModel","./Widgets.TopBar","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.KeyboardHelper"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";var b;return (function(
n){var tt=i.Base.UriBuilder,it=i.Base.Diagnostics.Telemetry,r=window,b=r.fx.environment.features.rapidtoasts,t="fxs-show-journey",k="fxs-show-startboard",d="fxs-blade-position-feature",rt="fxs-portal-peekmode",g,nt;u.components.register("fxs-progress",{template:'<div class="fxs-progress-dots"><div><\/div><div><\/div><div><\/div><\/div>'});g=(function(n){function t(){n.apply(this,arguments);this.topBar=new p.ViewModel;this.sideBar=new v.ViewModel}return __extends(t,n),t})(h.ViewModel);n.ViewModel=g;nt=(function(n){function h(s,h){var g=this,tt,ut,et,ht,ct,nt,ot,st,ft,it;n.call(this,s,h);this.hasActiveJourney=!1;tt=this.ltm;ut=h.sideBar;this._topBarWidget=new p.Widget(s.findByClassName("fxs-topbar"),h.topBar,s.findByClassName("fxs-portal-console"));this._panorama=new l.Widget(s.findByClassName("fxs-portal-content"),new l.ViewModel("fxs-panorama-instanceid"));et=new c.ViewModel;et.collapsed=ut.isCollapsed;this._leftContextPaneWidget=new c.Widget(s.findByClassName("fxs-portal-contextpane-left"),
et);this._rightContextPaneWidget=new c.Widget(s.findByClassName("fxs-portal-contextpane-right"),new c.ViewModel);f.register(s);e.register(s);this._searchWidget=new a.Widget(s.findByClassName("fxs-topbar-search"),new a.ViewModel);ht=u.computed(tt,(function(){return o.settings.notificationToastEnabledKey()&&b!=="0"&&b!=="true"}));ct=this._toastViewModel=new y.ViewModel({shouldShowToasts:ht});i.require("MsPortalImpl/Widgets/Widgets.Toast").then((function(n){tt.registerForDispose(new n.Widget(s.findByClassName("fxs-topbar-toast"),ct))}));ut.getStartboardVisible=function(){return g.isStartBoardVisible()};this._sideBarWidget=new v.Widget(s.findByClassName("fxs-sidebar"),ut);nt=i.isFeatureEnabled("nohozscroll");ot=function(){if(!g.isJourneyVisible()){i.isFeatureEnabled("sideBarAutoCollapsedInJourney")||g._sideBarWidget.options.isCollapsed(o.settings.sideBarCollapsedKey());g.element.removeClass(k).addClass(t);g.options.topBar.dashboardVisible(!1);var n=g.getPanorama().getJourneyWidget();n&&!nt&&n.
setFocus()}};this.showJourney=nt?i.noop:ot;st=function(){g._sideBarWidget.options.isCollapsed(o.settings.sideBarCollapsedKey());g.element.removeClass(t).addClass(k);g.options.topBar.dashboardVisible(!0);nt||g.trigger(w.default.fxshowstartboard);var n=g.getPanorama().getStartBoardWidget();n&&n.setFocus()};this.showStartBoard=nt?i.noop:st;ft=[function(){f.unregister(s);e.unregister(s)}];nt&&(this.element.addClass(d),it=u.observable(!1),ft.push(this.element.setEvents([w.default.fxloadingontopbar,function(n,t){g._topBarWidget.loadingHint(t.id,!t.cancel)}],[w.default.fxshowstartboard,st],[w.default.fxshowjourney,ot],[w.default.fxdashboardactivity,function(){var n=g.getPanorama().getJourneyWidget(),t=n&&n.getBlades()[0];t&&t.close(!1)}],[w.default.fxpeekmode,function(n,t){it(t&&t.enter!==undefined?!!t.enter:!it())}])),ft.push($(r).setEvents([w.default.keyup,function(n){n.which===27&&it(!1)}])),it.subscribe(tt,(function(n){g.element.toggleClass(rt,n);g.getPanorama().peekMode(n);g._topBarWidget.
options.peekMode(n)})));tt.registerForDispose(ft)}return __extends(h,n),h.prototype.dispose=function(){this._panorama.dispose();this._cleanElement(d);n.prototype.dispose.call(this)},h.prototype.getPanorama=function(){return this._panorama},h.prototype.getLeftContextPane=function(){return this._leftContextPaneWidget},h.prototype.getRightContextPane=function(){return this._rightContextPaneWidget},h.prototype.getSearchWidget=function(){return this._searchWidget},h.prototype.getSideBarWidget=function(){return this._sideBarWidget},h.prototype.getToastVM=function(){return this._toastViewModel},h.prototype.getTopBarWidget=function(){return this._topBarWidget},h.prototype.isStartBoardVisible=function(){return!this.element.hasClass(t)},h.prototype.isJourneyVisible=function(){return this._hasJourneyWithContent()&&this.element.hasClass(t)},h.prototype._hasJourneyWithContent=function(){var n=this.getPanorama(),t=n&&n.getJourneyWidget(),i=this.getRightContextPane();return t&&t.hasChildren()||i&&i.options.
opened()},h.prototype.handleStartButtonClick=function(){var t=s.ActionModifier.PortalScrolled,i=new tt(r.location.href),u=!i.fragment,n;this.isStartBoardVisible()||(this._hasJourneyWithContent()&&u&&!this.hasActiveJourney?(n=this._panorama.getJourneyWidget(),n&&n.close()):(this.element.trigger(w.default.fxhomebuttonclick),t=s.ActionModifier.StartBoardRestored));it.trace({source:s.Source.Desktop,action:s.Action.HomeButtonClicked,actionModifier:t})},h})(h.Widget);n.Widget=nt})(b||(b={})),b}));define("_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxpart-itemsummary{height:100%;background:#00f;display:block;color:#fff}.fxpart-itemsummary-name{font-size:19px;padding:20px;text-transform:uppercase}.fxpart-itemsummary-sourceControl{font-size:16px;padding:0 20px}")}));define("_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(
i,'.msportalfx-specpicker-footer-value,.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode,.msportalfx-specpicker-table .msportalfx-specpicker-feature-name,.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.msportalfx-specpicker{width:175px;height:320px;position:relative;border-color:inherit}.msportalfx-specpicker:after,.msportalfx-specpicker:before{content:"";position:absolute;z-index:-1;top:10px;bottom:10px;left:0;right:0;border-radius:10px}.msportalfx-specpicker:after{right:10px;left:auto;transform:skew(8deg) rotate(3deg)}.msportalfx-specpicker .msportalfx-specpicker-table{table-layout:auto}.msportalfx-specpicker ul{list-style-type:none;padding:0}.msportalfx-specpicker .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.fxs-mode-dark .msportalfx-specpicker{box-shadow:0 1px 4px rgba(255,255,255,.3),0 0 40px rgba(255,255,255,.1) inset}.fxs-mode-dark .msportalfx-specpicker:after,.fxs-mode-dark .msportalfx-specpicker:before{box-shadow:0 0 20px rgba(255,255,255,.8)}.fxs-mode-light .msportalfx-specpicker{box-shadow:0 1px 4px rgba(0,0,0,.3),0 0 40px rgba(0,0,0,.1) inset}.fxs-mode-light .msportalfx-specpicker:after,.fxs-mode-light .msportalfx-specpicker:before{box-shadow:0 0 20px rgba(0,0,0,.8)}.msportalfx-specpicker-star{width:14px;height:14px;fill:#ffb900;stroke:#000;stroke-width:1px;float:right;margin-right:4px;margin-top:1px}.msportalfx-specpicker-header{color:#fff;font-size:14px;height:26px;line-height:26px}.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode{text-transform:uppercase;padding-left:11px}.msportalfx-specpicker-header .msportalfx-specpicker-header-title{padding-left:6px}.msportalfx-specpicker-header-text{fill:#ffb900;stroke:#000;stroke-width:1px;width:161px;position:absolute}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade1{background-color:#4668c5}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade2{background-color:rgba(70,104,197,.2)}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade3{background-color:rgba(70,104,197,.1)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade1{background-color:#8a2da5}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade2{background-color:rgba(138,45,165,.2)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade3{background-color:rgba(138,45,165,.1)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade1{background-color:#578000}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade2{background-color:rgba(87,128,0,.2)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade3{background-color:rgba(87,128,0,.1)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade1{background-color:#c40}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade2{background-color:rgba(204,68,0,.2)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade3{background-color:rgba(204,68,0,.1)}.msportalfx-specpicker-table{table-layout:auto;width:100%;border-collapse:collapse}.msportalfx-specpicker-table .msportalfx-specpicker-feature-name{font-size:12px;margin-left:6px}.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-size:17px}.msportalfx-specpicker-row td{white-space:nowrap;padding:0}.msportalfx-specpicker-row td .msportalfx-specpicker-cell{height:30px;line-height:30px}.msportalfx-specpicker-row td.msportalfx-specpicker-right{overflow:hidden;text-overflow:ellipsis;max-width:1px;width:100%}.msportalfx-specpicker-row.msportalfx-specpicker-promotedFeatures td{padding-bottom:1px}.msportalfx-specpicker-row.msportalfx-specpicker-borderBottom td{border-bottom:1px solid #e9e9f3}.msportalfx-specpicker-row .msportalfx-specpicker-left{text-align:center;min-width:39px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-value{font-size:12px;padding-top:6px;margin-left:6px;line-height:normal}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-name{font-size:10px;line-height:normal;margin-top:-3px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-mutipleline .msportalfx-specpicker-feature-value{padding-top:1px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{min-width:29px;text-align:center}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell img{width:22px;height:22px;margin-top:8px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell div{width:20px;height:20px;padding-top:5px;padding-left:0;display:inline-block}.msportalfx-specpicker-footer-container{position:absolute;bottom:0;left:0;right:0;height:46px;text-align:right}.msportalfx-specpicker-footer{margin-right:10px;margin-bottom:8px;background-color:inherit}.msportalfx-specpicker-footer-value{margin-top:6px;text-transform:uppercase;font-size:22px;line-height:22px;letter-spacing:-.025em}.msportalfx-specpicker-footer-details{font-size:10px;line-height:14px;text-transform:uppercase}.msportalfx-specpicker-footer-channelMessage,.msportalfx-specpicker-footer-statusMessage{margin-left:5px;margin-right:5px;font-size:11px;text-align:left}.msportalfx-specpicker-footer-statusMessage{margin-top:25px}.msportalfx-specpicker-footer-channelMessage{margin-top:10px;position:absolute;background-color:inherit;white-space:normal;overflow:hidden;text-overflow:ellipsis;max-height:32px}.msportalfx-specpicker-footer-channelMessage::after,.msportalfx-specpicker-footer-channelMessage::before{position:absolute;background-color:inherit}.msportalfx-specpicker-footer-channelMessage::before{content:\'\\02026\';top:16px;right:0}.msportalfx-specpicker-footer-channelMessage::after{content:\'\';height:100%;width:100%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker{background-color:rgba(189,189,189,.05)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-header{background-color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.2)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-right .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.1)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-footer-container{background-color:#dedede}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-feature-name,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-feature-value,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-footer-value{color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor{position:absolute;text-align:center;left:15px;right:15px;top:40%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container{display:inline-block;background-color:rgba(50,56,63,.8);margin-top:20px;padding:15px 10px;width:100%;box-sizing:border-box}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container .msportalfx-specpicker-disable-message{display:inline}.ext-hubs-specPicker-container{width:100%;min-height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-filtersContainer.ext-hubs-specPicker-filtersContainer{margin-top:0}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptionsContainer{height:25px;padding-top:5px;padding-right:15px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions{font-size:14px;float:right}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .msportalfx-specpicker-recommendationsIcon{width:14px;height:14px;display:inline-block}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-selected{cursor:default;background-color:inherit}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-clickable{color:#0058ad;fill:#0058ad}.ext-hubs-specPicker-container .ext-hubs-specPicker-message{margin-top:0;border-left:6px solid #ffb900;padding:15px}.ext-hubs-specPicker-container .ext-hubs-specPicker-listView{margin-left:19px}.ext-hubs-specPicker-container .fxc-hotspot{outline:0;padding:5px}.ext-hubs-specPicker-container .fxc-hotspot:focus{outline-style:dotted;outline-width:1px}')})
);define("_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".msportalfx-pricingTier .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.msportalfx-pricingTier .msportalfx-pricingTier-normal-iconContainer,.msportalfx-pricingTier .msportalfx-pricingTier-wide-iconContainer{height:55px;border-bottom:1px solid #dcdfe2}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:10px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-specCode{float:left;margin-right:8px;max-width:100px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-promotedFeatures{line-height:12px;padding-top:4px}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon{width:30px;height:30px;margin-top:1.7em}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon.msportalfx-pricingTier-icon-small{margin-top:-.15em}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:10px}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:30px;height:30px;margin-right:15px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:18px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:20px;height:20px;margin-right:5px}.fxs-tilesize-small .msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:-12px}.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specCode,.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specTitle{text-align:center;float:initial}")})
);define("MsPortalImpl/Parts/Parts.Intrinsics",["require","exports","f","./Parts","../../_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css","../../_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css","../../_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css"],(function(n,t,i,r){"use strict";var u;return (function(n){var t=i.Parts.PartKind,s=0,e=1,f=2,u=3,h=10,c=4,l=5,a=6,p=7,v=8,w=9,o="<div data-bind='{0}: $root'><\/div>",y={defaultSize:v,supportedSizes:[v],viewStateProperties:["content.selection.selectedItems","content.selection.activatedItems"]};n.parts=[{kind:t.Asset,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Asset",(function(n,t,i,r,u){return new n.AssetPart(t,i,r,u)}),{defaultSize:e,supportedSizes:[s,e,f]})},{kind:t.Button,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.ButtonPart",(function(n,t,i,r,u){return new n.ButtonPart(t,i,r,u)}),{supportedSizes:[s,e,f,u]})},{kind:t.Chart,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Chart",(function(
n,t,i,r,u){return new n.Chart(t,i,r,u)}),{supportedSizes:[e,f,c,u,h,l,a,p,v,w]})},{kind:t.Collection,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Collection",(function(n,t,i,r,u){return new n.CollectionPart(t,i,r,u)}),{supportedSizes:[s,e,f,u,c,h,l,a,p,w,v]})},{kind:t.CollectionSummary,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.CollectionSummary",(function(n,t,i,r,u){return new n.Part(t,i,r,u)}),{supportedSizes:[s,e,f,u]})},{kind:t.DiffEditor,factory:r.createPartFactory(o.format("pcDiffEditor"))},{kind:t.Donut,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Donut",(function(n,t,i,r,u){return new n.Donut(t,i,r,u)}),{supportedSizes:[f,l,u,h,c,a,]})},{kind:t.Editor,factory:r.createPartFactory(o.format("pcEditor"))},{kind:t.Grid,factory:r.createPartFactory(o.format("pcGrid"),{viewStateProperties:["content.selectableData.selectedItems","content.selectableData.activatedItems","content.selectableData.itemsWithChildEdits"]})},{kind:t.InfoList,factory:r.createAmdPartFactory(
"MsPortalImpl/Parts/Parts.InfoList",(function(n,t,i,r,u){return new n.InfoListPart(t,i,r,u)}),y)},{kind:t.ItemSummary,factory:r.createPartFactory("<div class='fxpart-itemsummary'><div class='fxpart-itemsummary-name' data-bind='text: name'><\/div><\/div>")},{kind:t.LogStream,factory:r.createPartFactory(o.format("pcLogStream"))},{kind:t.Properties,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Properties",(function(n,t,i,r,u){return new n.PropertiesPart(t,i,r,u)}),y)},{kind:t.Provisioning,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Provisioning",(function(n,t,i,r,u){return new n.ProvisioningPart(t,i,r,u)}),{supportedSizes:[f,u]})},{kind:t.QuickStart,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuickStart",(function(n,t,i,r,u){return new n.QuickStartPart(t,i,r,u)}),{defaultSize:e,supportedSizes:[s,e,f,u]})},{kind:t.QuotaGauge,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuotaGauge",(function(n,t,i,r,u){return new n.QuotaGauge(t,i,r,u)}),{supportedSizes:
[f,h,u,c,a,l]})},{kind:t.ResourceSummary,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.ResourceSummary",(function(n,t,i,r,u){return new n.ResourceSummaryPart(t,i,r,u)}),y)},{kind:t.Settings,factory:r.createPartFactory(o.format("pcSettings"),{defaultSize:u,supportedSizes:[u]})},{kind:t.SingleSetting,factory:r.createPartFactory(o.format("pcSingleSetting"))},{kind:t.SingleValueGauge,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.SingleValueGauge",(function(n,t,i,r,u){return new n.SingleValueGauge(t,i,r,u)}),{supportedSizes:[f,h,u,c]})},{kind:t.Unavailable,factory:r.createPartFactory("<div><\/div>")}];n.parts.forEach((function(n){r.registerFactory(t[n.kind],n.factory)}))})(u||(u={})),u}));define("_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-part-buttonpart-assetname,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-should-use-single-line,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-should-use-single-line,.fxs-tilesize-wide .fxs-part-buttonpart-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-buttonpart{height:100%;width:100%;box-sizing:border-box}.fxs-part-buttonpart-inner{display:-webkit-flex;display:flex;position:relative;height:100%;box-sizing:border-box;text-align:center;-webkit-align-items:center;align-items:center;-webkit-flex-direction:column;flex-direction:column}.fxs-part-buttonpart-inner-pad{padding-top:28px}.fxs-part-buttonpart-iconcontainer{-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box}.fxs-part-buttonpart-iconcontainer>img,.fxs-part-buttonpart-iconcontainer>svg{height:50px;width:50px}.fxs-part-buttonpart-textcontainer{width:100%;font-size:12px;line-height:18px}.fxs-part-buttonpart-assetname{margin:0;font-family:az_ea_font,wf_segoe-ui_semibold,\"Segoe UI Semibold\",\"Segoe WP Semibold\",\"Segoe UI\",\"Segoe WP\",Tahoma,Arial,sans-serif;font-size:10px;line-height:10px;text-transform:uppercase}.fxs-part-buttonpart-title{margin:10px 0 5px;position:relative;overflow:hidden;text-overflow:ellipsis;max-height:36px}.fxs-tilesize-mini .fxs-part-buttonpart-title,.fxs-tilesize-small .fxs-part-buttonpart-title{margin:0}.fxs-part-buttonpart-title::after,.fxs-part-buttonpart-title::before,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::after,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::before,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::after,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::before{position:absolute;background-color:inherit}.fxs-part-buttonpart-title::before{content:'\\02026';top:18px;right:0}.fxs-part-buttonpart-title::after{content:'';height:100%;width:100%}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg{height:30px;width:30px}.fxs-tilesize-small .fxs-part-buttonpart-inner,.fxs-tilesize-wide .fxs-part-buttonpart-inner{padding-top:0;text-align:left;-webkit-flex-direction:row;flex-direction:row}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer>svg{-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{-webkit-flex:0 1 auto;flex:0 1 auto;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-justify-content:center;justify-content:center}.fxs-tilesize-mini{font-size:12px;line-height:normal}.fxs-tilesize-mini .fxs-part-buttonpart-inner{padding-top:5px}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline{overflow:hidden;text-overflow:ellipsis;max-height:32px;line-height:15px}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::before{content:'\\02026';top:16px;right:0}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::after{content:'';height:100%;width:100%}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer{width:51px;padding-left:6px}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer{width:calc(100% - 51px)}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline{overflow:hidden;text-overflow:ellipsis;max-height:36px}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::before{content:'\\02026';top:18px;right:0}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::after{content:'';height:100%;width:100%}.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{width:85px;padding-left:15px}.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{width:calc(100% - 85px)}.fxs-tilesize-wide .fxs-part-buttonpart-title{margin:0}.fxs-tilesize-wide .fxs-part-buttonpart-assetname{padding-top:2px}.fxs-tilesize-wide .fxs-part-buttonpart-desc{display:block;margin-top:10px;position:relative;overflow:hidden;text-overflow:ellipsis;max-height:90px}.fxs-tilesize-wide .fxs-part-buttonpart-desc::after,.fxs-tilesize-wide .fxs-part-buttonpart-desc::before{position:absolute;background-color:inherit}.fxs-tilesize-wide .fxs-part-buttonpart-desc::before{content:'\\02026';top:72px;right:0}.fxs-tilesize-wide .fxs-part-buttonpart-desc::after{content:'';height:100%;width:100%}.fxs-part-buttonpart-externallink{position:absolute;top:0;right:0;height:12px;width:12px}.fxs-part-buttonpart-externallink>img,.fxs-part-buttonpart-externallink>svg{height:12px;width:12px}.fxs-tilesize-mini .fxs-part-buttonpart-externallink{top:-5px;right:5px}.fxs-part-buttonpart,.fxs-part-buttonpart .fxs-part-buttonpart-desc,.fxs-part-buttonpart .fxs-part-buttonpart-inner,.fxs-part-buttonpart .fxs-part-buttonpart-textcontainer,.fxs-part-buttonpart .fxs-part-buttonpart-title{background-color:inherit}.fxs-part-buttonpart-adornment{position:absolute;top:0;left:33px;height:14px;width:14px}.fxs-tilesize-mini .fxs-part-buttonpart-adornment{position:absolute;top:0;left:17px;height:10px;width:10px}.fxs-tilesize-small .fxs-part-buttonpart-adornment{position:absolute;top:50% - 30px/2;left:0;height:10px;width:10px}.fxs-tilesize-wide .fxs-part-buttonpart-adornment{position:absolute;top:50% - 50px/2;left:0;height:14px;width:14px}html[lang^=ja] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title,html[lang^=ko] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title,html[lang^=zh] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title{font-size:11px;line-height:11px}")})
);define("MsPortalImpl/Parts/Parts.ButtonPart",["require","exports","f","o","ko","../Generated/SvgStartupDefinitions","./Parts","MsPortalImpl/Base/Base.SvgHelper","Fx/Internal/Composition/ViewModel","../../_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){var h=f.Content.SvgStartup,t=i.getUniqueId(),r;n.template="<div class='fxs-part-buttonpart'><div class='fxs-part-buttonpart-inner'><div class='fxs-part-buttonpart-iconcontainer' data-bind='image: icon, css: { \"fxs-part-buttonpart-inner-pad\": _showTopPadding() }'><\/div><!-- ko if: $data.adornmentUri --><img alt='' class='fxs-part-buttonpart-adornment' data-bind='attr: { src: adornmentUri }' /><!-- /ko --><div class='fxs-part-buttonpart-textcontainer'><h3 class='fxs-part-buttonpart-title msportalfx-tooltip-overflow' "+('data-bind=\'text: _displayTitle, css: { "fxs-should-use-single-line": _assetNameVisible(), "fxs-can-use-multiline": !_assetNameVisible() }\' aria-describedby='+
t+"><\/h3>")+("<div data-bind='text: _assetName, visible: _assetName() && (_assetNameVisible())' class='fxs-part-buttonpart-assetname msportalfx-tooltip-overflow' id="+t+"><\/div>")+"<div data-bind='text: description, visible: ((_size() === MsPortalFx.Parts.PartSize.Wide) && description())' class='fxs-part-buttonpart-desc msportalfx-tooltip-overflow'><\/div><\/div><!-- ko if: _isExternalLink --><div class='fxs-part-buttonpart-externallink azc-fill-heavy'>"+o.getSvgReferenceOrFallBackToData(h.hyperlink,"",!0)+"<\/div><!-- /ko --><\/div><\/div>";r=(function(t){function r(){t.apply(this,arguments);this.template=n.template}return __extends(r,t),r.prototype._getContentForBinding=function(n,r){var c=this,e=r.content,o=r.container,f=o.clickableLink,l=function(n){return n.target()==="_self"||n.uri&&i.startsWith(n.uri(),"#")&&n.target()==="auto"},a=u.observable(!!f&&!l(f)),v,y,h;return u.computed(n,(function(){c.ariaLabel(e.title())})),v=f&&f.target,v&&v.subscribe(n,(function(){a(!l(f))})),y=f&&f.uri,
y&&y.subscribe(n,(function(){a(!l(f))})),h=s.isV2(e)?function(){return c._options.size()}:function(){return e.size&&e.size()},i.extend2(t.prototype._getContentForBinding.call(this,n,r),{_displayTitle:u.computed(n,(function(){var n=h(),t=e.title();return n===0||n===1?e.shortTitle()||t:t})),_assetName:o.assetName,_isExternalLink:a,_assetNameVisible:u.computed(n,(function(){return!c.inContainerOfSameAsset()&&o.assetName()})),_showTopPadding:u.computed(n,(function(){return h()===2&&!o.partTitle()})),_size:u.computed(n,h)})},r})(e.PartImpl);n.ButtonPart=r})(h||(h={})),h}));define("_generated/Less/MsPortalImpl/Parts/Parts.Collection.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,'.fxs-part-collectionpart .azc-grid table td.azc-grid-cell:first-of-type,.fxs-part-collectionpart .azc-grid table thead tr th:first-child a{padding-left:15px}.fxs-part-collectionpart-more-data,.fxs-part-collectionpart-rollup-count{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.fxs-part-collectionpart .azc-grid table thead tr th{height:28px;line-height:28px;border-top-width:1px;border-top-style:solid}.fxs-part-collectionpart .azc-grid table thead tr th>a{line-height:normal}.fxs-part-collectionpart .azc-grid table tbody tr td{height:27px}.fxs-part-collectionpart .azc-grid table td:last-child,.fxs-part-collectionpart .azc-grid table td:last-of-type{padding-right:15px}.fxs-part-collectionpart .azc-grid table .azc-grid-resizableColumn-handle{height:28px}.fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:none}.fxs-part-collectionpart.fxs-part-collectionpart-rollup-forceshow .fxs-part-collectionpart-rollup-container{display:block}.fxs-part-collectionpart-more-data{font-size:12px;line-height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;position:absolute;right:0}.fxs-part-collectionpart-more-data:hover{text-decoration:underline}.fxs-part-collectionpart-rollup-container{margin:-6px 0 6px}.fxs-part-collectionpart-rollup-count{font-size:30px;line-height:30px;letter-spacing:-.025em}.fxs-part-collectionpart-rollup-label{font-family:az_ea_font,wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:15px;line-height:15px;letter-spacing:-.02em;margin-left:4px}.fxs-part-collectionpart-part-title{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:10px;line-height:10px;text-transform:uppercase;margin:5px 0 0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:none}.fxs-part-collectionpart-rollup-icon{width:21px;height:21px;margin-left:4px;display:inline-block}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:block;margin:0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label{display:none}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count{line-height:25px}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count{width:30px;height:30px;margin-left:0}.fxs-tilesize-mini .fxs-part-collectionpart{text-align:center;padding:5px 6px 0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-part-title{display:block}.fxs-tilesize-small .fxs-part-collectionpart{float:right;margin-top:-15px}html[lang^=ja] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^=ko] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^=zh] .fxs-part-collectionpart .fxs-part-collectionpart-part-title{font-size:11px;line-height:11px}')})
);define("MsPortalImpl/Parts/Parts.Collection",["require","exports","f","o","ko","$","MsPortalImpl/Base/JQueryHelper","./Parts","MsPortalImpl/Resources/ImplScriptResources","../../_generated/Less/MsPortalImpl/Parts/Parts.Collection.css"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){var t=s.Parts,r='<div class="fxs-part-collectionpart" data-bind="css: {\'fxs-part-collectionpart-rollup-forceshow\': alwaysShowRollupCount()}"><div class="fxs-part-collectionpart-rollup-container"><span class="fxs-part-collectionpart-rollup-count" data-bind="text: rollupCount, visible: !noRollupCount()"><\/span><span class="fxs-part-collectionpart-rollup-label" data-bind="text: rollupCountLabel"><\/span><img class="fxs-part-collectionpart-rollup-icon" data-bind="attr: { src: rollupCountIconUri }, visible: rollupCountIconUri, css: {\'fxs-part-collectionpart-no-rollup-count\': noRollupCount }" alt=""/><div class="fxs-part-collectionpart-rollup-icon" data-bind="image: rollupCountIcon, visible: rollupCountIcon, css: {\'fxs-part-collectionpart-no-rollup-count\': noRollupCount }"><\/div><h4 class="fxs-part-collectionpart-part-title fxs-display-none" data-bind="text: _partTitle"><\/h4><\/div><!-- ko if: emptyGrid() && noRowsHtml() --><div class="fxs-part-collectionpart-norowshtml fxs-display-none" data-bind="pcControl: noRowsHtml"><\/div><!-- /ko --><!-- ko if: !emptyGrid() || !noRowsHtml() --><!-- ko if: !!gridMode() --><div data-bind="pcGrid: grid" class="msportalfx-removepartpaddingside"><\/div>'+
('<a href="#" class="fxs-part-collectionpart-more-data fxs-portal-text-primary" tabindex="0" data-bind="visible: hasMoreData">'+t.more+"<\/a>")+"<!-- /ko --><!-- /ko --><\/div>",h=(function(n){function t(t,i,u,e){n.call(this,t,i,u,e);this.template=r;var o=this._container=f(t);o.on("click keydown","a.fxs-part-collectionpart-more-data",(function(n){n.preventDefault();n.stopPropagation();var t=f.Event(n.type);t.keyCode=n.keyCode;f(n.delegateTarget).trigger(t)}))}return __extends(t,n),t.prototype._getContentForBinding=function(n,t){var r=this._container.findByClassName("fxs-part-collectionpart-part-title"),f=this._container.findByClassName("fxs-part-collectionpart-norowshtml");return u.computed(n,(function(){var n=t.content.size();e.toggle(r,n!==0||!!t.container.partTitle());e.toggle(f,n!==0&&n!==1)})),i.extend2(t.content,{_partTitle:t.container.partTitle})},t})(o.PartImpl);n.CollectionPart=h})(h||(h={})),h}));define("MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder",["require","exports",
"f","u","o","ko","./UI.Composition.Part","./UI.Composition.PropertyBinding","./UI.Composition.CompositionBinder"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(t){function d(n,t){var i=n.parent&&n.getPartsContainer(),f=i&&i.getCompatibleSourceReferences&&i.getCompatibleSourceReferences.bind(i),s=function(n){if(f){var t=f(n);return t&&t[0]}},e,u;return t=t||[],e=n.overridesModel,u=[],t.forEach((function(n){var i=n.name,t;t=o.getModelValue(e,i).exists?null:s(n);u.push(r(n,t))})),u}function a(n){if(n.adapter){var i=v(n),t={},r=y(n,!1);return r.forEach((function(n){var r,f=n.compositionBindingDefinition,u=f&&f.source,e;u&&u.modelType===l&&(e=u.property,r=i[e]);r||(r={bindingSources:[],activeBindingSourceName:null});t[n.targetProperty]=r})),t}return v(n)}function g(n,t,i){function r(r,e){var y,b,l,v;t&&s.CompositionBinder.turnOnInputsSetSuppressionOn(t);s.CompositionBinder.turnOnInputsSetSuppressionOn(i);try{var k=r.inputs,p=r.settings,d=r.inputsMetadata,w=n.getSettingsModel(),
c=n.partDefinition&&n.partDefinition.partState,g=c?(c.inputIdentityProperties||[]).concat((c.sharedProperties||[]).map((function(n){return n.property}))):[],it=u.keys(p);g.forEach((function(n){var r=f.unwrap(o.getModelValue(w,n).value),t=n.startsWith("content.")?n.slice(8):n,i=f.toJS(o.getModelValue(p,t).value);h(i,r)||(o.setModelValue(w,n,i),y=!0);it.remove(t)}));l=a(n);u.keys(l).forEach((function(t){var i=l[t],r=d[t],u=k[t];tt(n,t,i,r.activeBindingSourceName,u)&&(b=!0)}));b&&(n.widgetState.valueHasMutated(),nt(n),n.save())}finally{return v=(y?2:1)|(e?0:4),Q.all([t&&Q(s.CompositionBinder.turnOnInputsSetSuppressionOff(t,v,!0))||Q(),Q(s.CompositionBinder.turnOnInputsSetSuppressionOff(i,v,!0))])}}n.getViewModel().internal.updateConfigFn(r)}function nt(n){var t=n.widget;t&&t.element.trigger(e.fxpartinputchanged,{part:n})}function r(n,t){var r=n,i=n,f=i.targetProperty||r.name,o=!!n.optional,u;return t||(u=i.source&&i.source.property||r.name,t=e.createOverridesOrContainerModelSourceReference(u)),
{targetProperty:f,optional:o,source:t,isDynamicBinding:!0}}function v(n){var t=n.parent&&n.getPartsContainer(),i=t&&t.getCompatibleSourceReferences&&t.getCompatibleSourceReferences.bind(t),r=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,s=function(n){var u,t;return r&&i&&(t=r.first((function(t){return t.name===n})),t&&(u=i(t))),(u||[]).map((function(n){return{sourceReference:n,name:n.property,acceptsValueUpdates:!1}}))},u=n.overridesModel,h=function(n){if(!n||e.isDynamicBindingWithNonLocalSource(n))return!1;var t=n.source&&n.source.property;return u&&t&&o.getModelValue(u,t).exists},f={},c=y(n);return c.forEach((function(n){var r=n.targetProperty,u=s(r),t=n.compositionBindingDefinition,i=t&&t.source,e=!h(t)&&i&&(u||[]).first((function(n){var t=n.sourceReference;return t.modelType===i.modelType&&t.property===i.property}));f[r]={bindingSources:u,activeBindingSourceName:e&&e.name}})),f}function y(n,t){return t===void 0&&(t=!0),n.getNonDetailsContainerPropertyBindings(t).filter(
(function(n){var t=n.targetProperty;return!b.isBladeCallerInput(t)&&t!==p.EditScopeId}))}function tt(n,t,i,u,e){var y=u&&i.bindingSources.first((function(n){return n.name===u})),p,a,b,d,rt,ut,w,it;if(u&&!y){c.error("Source with name '{0}' for configurable Part input named '{1}' does not exist at the Dashboard/Blade-level.".format(u,t));return}if(p=n.getInputPropertyBindings(),a=p.properties.first((function(n){return n.targetProperty===t})),y?(rt=i.activeBindingSourceName,y.name!==rt&&(b=!0)):(ut=f.unwrap(o.getModelValue(a.targetModel,a.targetProperty).value),h(f.toJS(e),ut)||(d=!0)),!(b||d))return!1;if(n.adapter){var ft=n.bindings.first((function(n){return n.targetProperty===t})),g=ft&&ft.source,et=g&&g.modelType===l&&g.property;if(et)w=et;else return c.error("For Adapted Part '{0}', input named '{1}' to the inner Part is not configurable.  Presently, only those inner Part inputs using the 'AdapterInput' binding are configurable.".format(n.toString(),t)),!1}else w=t;var nt=n.adapter?n.adapter.
inputPropertyBindings:n.getInputPropertyBindings(),tt=nt.properties.first((function(n){return n.targetProperty===w})),ot=tt.compositionBindingDefinition,st=n.overridesModel,v;if(b){var ht=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,ct=ht.first((function(n){return n.name===w})),lt=y.sourceReference;v=r(ct,lt)}return d&&(o.setModelValue(st,tt.sourceProperty,f.toJS(e)),v=r(ot)),v&&(nt.removeProperty(tt),it=n.adapter?n.adapter.bindings:n.bindings,k(it,ot),s.CompositionBinder.setupPropertyBindings(n,nt,[v],n.bindAgainstOverridesOrContainerModel.bind(n)),it.push(v),n.adapter&&(p.removeProperty(a),s.CompositionBinder.setupPropertyBindings(n,p,a&&[a.compositionBindingDefinition],n.bindAdaptedInput.bind(n)))),!0}var p=i.Base.Constants.BladeParameterNames,w=i.Base.Diagnostics,b=i.ViewModels.Internal,k=i.remove,h=i.deepEquals,c=w.createLog(n),l=9;t.inferInitialBindingsForInputDefinitions=d;t.getConfigurableInputsMetadata=a;t.listenForConfigurationChanges=g})(h||(h={})),h}));define(
"MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration",["require","exports","o","ko","../../ViewModels/ViewModels.BladeCaller"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function e(n,t,u){var e=t.internal,f=r.observableArray([]);f.map(n,(function(n,t){r.ignoreDependencies((function(){o(n,t,e,u)}))}));r.computed(n,e.registeredSelectables,(function(n){n===void 0&&(n={});f.splice.apply(f,[0,f.peek().length].concat(i.keys(n)))})).extend({deferred:!0})}function o(n,i,e,o){var l=o.getBladeOpener(),h={invocationInputArguments:[{valuesFrom:[{referenceType:0,property:t+"."+i}]}]},c=r.unwrap(e.registeredSelectableOptions),s;c&&(s=c[i],s&&(s.parameterCollector&&u.addCallerBindings(f+"."+i+".parameterCollector.bladeCaller",h,0),h.openInContextPane=s.openInContextPane,h.persistentContextPane=s.persistentContextPane));l.registerInvocationProperty(h,null,n)}var t="internal.registeredSelectables",f="internal.registeredSelectableOptions";n.listenForRegistrationChanges=e})(f||(f={
})),f}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.FormDialog.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-formdialog{font-size:14px;border:1px solid}.fxs-formdialog h2{font-size:110%}.fxs-formdialog .fxs-formdialog-description{margin-top:-10px}.fxs-formdialog .fxs-formdialog-form{margin:20px 0 0;padding:15px 25px;width:448px;max-width:calc(100% - 2 * 25px)}.fxs-formdialog .fxs-formdialog-buttons{margin-left:25px}.fxs-formdialog .fxs-formdialog-buttons>.fxc-simplebutton{margin-right:5px;margin-bottom:25px}.fxs-formdialog-header{border-bottom:1px solid;margin:0 25px;padding-bottom:10px}")}));define("MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog",["require","exports","f","o","ko","$","MsPortalImpl.Controls/Fields/Base/FormValidation","../../Interactions/Interactions.DismissHandler","../../Interactions/Interactions.KeyboardNavigation","../Widgets.WidgetBase","../Widgets.Common","../../../_generated/Less/MsPortalImpl/Widgets/Widgets.FormDialog.css"],
(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){var r=i.ViewModels.Controls.SimpleButton.ViewModel,w=i.ViewModels.Forms.Section,t=w.ViewModel,l=i.newGuid,a="fxs-formdialog",v="fxs-portal-bg-txt-br",y="fxs-popup",b="<div class='fxs-formdialog-header fxs-portal-border'><h2 data-bind='text: data.dialogOptions.title'><\/h2><div class='fxs-formdialog-description' data-bind='text: data.dialogOptions.description'><\/div><\/div><div class='fxs-formdialog-form msportalfx-form' data-bind='pcControl: func._formSection'><\/div><div class='fxs-formdialog-buttons'><div class='fxs-portal-button-primary fxs-formdialog-okbutton' data-bind='pcControl: func._okButton'><\/div><div class='fxs-button-default fxs-formdialog-cancelbutton' data-bind='pcControl: func._cancelButton'><\/div><\/div>",k=(function(n){function t(){n.apply(this,arguments);this.okButtonText=u.observable();this.cancelButtonText=u.observable();this.onOkClick=f.noop;this.onCancelClick=f.noop}return __extends(t,n),t})(h.
ViewModel),p;n.ViewModel=k;p=(function(n){function i(t,i){var e=this;if(n.call(this,t,i),!i.dialogOptions)throw new Error("dialogOptions must be specified for rendering a form dialog.");t.addClass(a+" "+y+" "+v).html(b);var u=document.activeElement,r=this._dismissHandle={dismissFn:function(){e._cancelButton&&i.onCancelClick()},shouldDismissOnMouseDownFn:f.noop,shouldDismissOnMouseWheelFn:f.noop,restoreFocus:function(){o.validatePreviousFocusedElement(r,u)&&u.focus()},logName:"formdialog"},h=new s.KeyboardNavigation(t,2);o.register(r);this.ltm.registerForDispose((function(){h.dispose();o.unregister(r)}));this._initializeViewModels();this._bindDescendants();this._setAria();this.setFocus()}return __extends(i,n),i.prototype.setFocus=function(){var n=this.element;c.waitForBindings(n[0]).finally((function(){var t=n.find("input:first");t.length===0&&(t=n.find(".fxs-formdialog-okbutton:first .fxs-button"));setTimeout((function(){t.offsetParent()&&t.focus()}))}))},i.prototype.dispose=function(){this._cleanElement(
a,y,v);n.prototype.dispose.call(this)},i.prototype._setAria=function(){var t="aria-labelledby",i="aria-describedby",n=this.element,r=l(),u=l();n.attr("role","alertdialog").attr(t,u).attr(i,r);n.find("h2").attr("id",u);n.findByClassName("fxs-formdialog-description").attr({id:r});this.ltm.registerForDispose((function(){n.removeAttr(["role",t,i].join(" "))}))},i.prototype._initializeViewModels=function(){var b=this,n=this.ltm,f=this.options,i=f.dialogOptions,l=3,o=0,s=new t(n,{style:u.observable(l),children:u.observableArray()}),h=new t(n,{style:u.observable(l),children:u.observableArray()}),a,v,y,p,c,w;i.row1column1&&(a=new t(n,{style:u.observable(o),children:u.observableArray([i.row1column1])}),s.children.push(a));i.row1column2&&(v=new t(n,{style:u.observable(o),children:u.observableArray([i.row1column2])}),s.children.push(v));i.row2column1&&(y=new t(n,{style:u.observable(o),children:u.observableArray([i.row2column1])}),h.children.push(y));i.row2column2&&(p=new t(n,{style:u.observable(o),
children:u.observableArray([i.row2column2])}),h.children.push(p));c=this._formSection=new t(n,{children:u.observableArray()});s.children().length&&c.children.push(s);h.children().length&&c.children.push(h);this._cancelButton=new r(n,{text:f.cancelButtonText,onClick:function(){f.onCancelClick()}});w=this._okButton=new r(n,{text:f.okButtonText,primary:!0,onClick:function(){e.ensureFormFieldValidation(b.element,!0).then((function(n){n&&f.onOkClick()}))}});u.computed(n,(function(){w.disabled(!c.valid())}))},i})(h.Widget);n.Widget=p})(l||(l={})),l}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-listpopup{display:inline-block;cursor:default;position:absolute;left:0;width:200px;max-height:300px;z-index:200;overflow-y:auto;box-sizing:border-box}.fxs-listpopup .fxs-listpopup-list{list-style-type:none;padding:0;max-height:300px}.fxs-listpopup .fxs-listpopup-item{font-size:12px;line-height:normal;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto;white-space:nowrap;text-overflow:ellipsis;position:relative;box-sizing:border-box;padding:0 10px;border:0;overflow:visible;text-align:left;height:35px;cursor:pointer}")})
);define("MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup",["require","exports","f","o","ko","$","../../Interactions/Interactions.DismissHandler","../../Interactions/Interactions.KeyboardNavigation","../../Base/Base.KeyboardHelper","../Widgets.WidgetBase","../../../_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(t){var y=i.Base.Diagnostics,r=".fxs-commandBar-item",c="fxs-listpopup",p=y.createLog(n),l="fxs-portal-bg-txt-br",a="fxs-popup",w="<ul class='fxs-listpopup-list' data-bind='foreach: func._items' role='menu'><li role='menuitem' class='fxs-listpopup-item fxs-portal-hover' data-bind='text: text, css: { \"fxs-listpopup-item-selected fxs-portal-selected fxs-portal-activated fxs-br-primary\": text === $root.data.dialogOptions.selectedItem() }, event: { click: onClick, keydown: onKeyDown}, attr: { title: text, \"aria-setsize\": $parent.func._items().length, \"aria-posinset\": $index() + 1, \"aria-selected\": text === $root.data.dialogOptions.selectedItem() }' tabindex='0'><\/li><\/ul>",
b=(function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t})(h.ViewModel),v;t.ViewModel=b;v=(function(n){function t(t,i){n.call(this,t,i);i.dialogOptions||p.error("dialogOptions must be specified for rendering a list popup.");var h=document.activeElement,y=function(n){if(n!==h&&!f.contains(h,n))return!(t[0]===n)&&!f.contains(t[0],n)},v=this._dismissHandle={dismissFn:function(){var n=i.onLostFocus;n&&n()},shouldDismissOnMouseDownFn:y,shouldDismissOnMouseWheelFn:y,restoreFocus:function(){e.validatePreviousFocusedElement(v,h)&&h.focus()},logName:"listpopup"};this._items=u.computed(this.ltm,(function(){var n=function(n){typeof i.onItemSelected=="function"&&(i.dialogOptions.selectedItem(n),i.onItemSelected(),v.restoreFocus())};return i.dialogOptions.listItems().map((function(t){return{text:t,onClick:function(i,r){r.stopPropagation();n(t)},onKeyDown:function(i,r){r.keyCode===13&&s.getModifierKeys(r)===0&&(r.stopPropagation(),n(t))}}}))}));this._keyboardNavigation=new o.KeyboardNavigation(
t);e.register(v);t.addClass(c+" "+a+" "+l).html(w);t.closest(r).attr("aria-expanded","true");this._bindDescendants()}return __extends(t,n),t.prototype.dispose=function(){e.unregister(this._dismissHandle);this._cleanElement(c,a,l);this._keyboardNavigation&&(this._keyboardNavigation.dispose(),this._keyboardNavigation=null);this.element.removeAttr("tabindex");this.element.closest(r).attr("aria-expanded","false");n.prototype.dispose.call(this)},t})(h.Widget);t.Widget=v})(c||(c={})),c}));define("_generated/Less/MsPortalImpl/Widgets/Widgets.ProgressBox.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".fxs-progressbox{color:#fff}")}));define("MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox",["require","exports","f","o","ko","MsPortalImpl/Resources/ImplScriptResources","../Widgets.WidgetBase","../../../_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css","../../../_generated/Less/MsPortalImpl/Widgets/Widgets.ProgressBox.css"],(function(n,t,i,r,u,f,e){
"use strict";var o;return (function(n){var v=f.Dialogs.ProgressBar,r="fxs-progressbox",o="fxs-progressbox-text",y="<h2 data-bind='text: data.title' class='fxs-progressbox-title'><\/h2><div data-bind='text: data.text' class='"+o+"'><\/div><div data-bind='text: data.completionText' class='fxs-progressbox-progressbar'><\/div>",s="fxs-popup",h="fxs-portal-bg-txt-br",t=u.observable,c=u.isObservable,l=i.newGuid,p=(function(n){function i(i,r){var f=this;n.call(this);this.title=t();this.text=t();this.completionPercentage=t(-1);c(i)&&(this.text=i);c(r)&&(this.completionPercentage=r);this.completionText=u.computed((function(){var n=f.completionPercentage();return n<0||n>100?"":v.percentComplete.format(n)}))}return __extends(i,n),i})(e.ViewModel),a;n.ViewModel=p;a=(function(n){function t(t,i){n.call(this,t,i);this.element.html(y).addClass(r).addClass(s).addClass(h);this._bindDescendants();this._setAria()}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(r,s,h);n.prototype.dispose.
call(this)},t.prototype._setAria=function(){var t="aria-labelledby",i="aria-describedby",n=this.element,r=l(),u=l();n.attr("role","alertdialog").attr(t,u).attr(i,r);n.find("h2").attr("id",u);n.findByClassName(o).attr("id",r);this.element.attr("tabindex",-1).focus();this.ltm.registerForDispose((function(){n.removeAttr("tabindex role "+t+" "+i)}))},t})(e.Widget);n.Widget=a})(o||(o={})),o}));define("MsPortalImpl/UI/UI.DialogManager",["require","exports","f","o","a","../Widgets/Dialogs/Widgets.FormDialog","../Base/JQueryHelper","../Widgets/Dialogs/Widgets.ListPopup","../Widgets/Dialogs/Widgets.ProgressBox","../Generated/SvgStartupDefinitions","../Base/Telemetry","./Compositions/UI.Composition","../Widgets/Widgets.WidgetBase","../Widgets/Dialogs/Widgets.MessageBox","../Base/Base.SvgHelper","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";function w(n){return kt.format(n)}function dt(n){return g||(g=new st(n)),g}function gt(){g=null}function ot(
n,t){var r=i.getUniqueId();return n.replaceAll(t,r).replaceAll("msportalfx-svg-c01",t).replaceAll(r,"msportalfx-svg-c01")}function ht(n,t,r,u,e){var h,c;switch(r.type){case 1:h=new v.Widget(t,ni(e,r,u));break;case 2:h=new s.Widget(t,ii(null,r));break;case 4:c=ui(e,r);c.onLostFocus=function(){n.dismissOpenDialog()};h=new o.Widget(t,c);break;case 3:h=new f.Widget(t,ri(e,r));break;case i.ViewModels.Internal.Dlg2:h=new v.Widget(t,ti(e,r,u))}return h}function ni(n,t,i){var r=new v.ViewModel;return r.title(t.title),r.text(t.text),r.buttons=t.buttons,r.onButtonClick=function(t){n(t)},r.modal=i,r.defaultButtonText=t.defaultButtonText,r.cancelButtonText=t.cancelButtonText,r.confirmationRequired=t.confirmationRequired,r.confirmationMessage=t.confirmationMessage,r}function ti(n,t,r){var f=new v.ViewModel;return f.title(t.title),typeof t.content=="object"?(f.template=t.content.htmlTemplate,f.templateViewModel=t.content.viewModel):typeof t.content=="string"&&f.text(t.content),u.isArray(t.buttons)?(
f.customBtns=[],t.buttons.forEach((function(n){f.customBtns.push({kind:3,text:n.displayText,result:n.button})})),f.customBtns.length&&(f.customBtns[0].kind=1,f.customBtns.length>1&&(i.last(f.customBtns).kind=2))):f.buttons=t.buttons,f.onButtonClick=function(t){n(t)},f.modal=r,f}function ii(n,t){var i=new s.ViewModel(t.text,t.completionPercentage);return i.title(t.title),i}function ri(n,t){var i=new f.ViewModel;return i.dialogOptions=t,i.okButtonText(p.Dialogs.okButtonText),i.cancelButtonText(p.Dialogs.cancelButtonText),i.onOkClick=function(){n(4)},i.onCancelClick=function(){n(1)},i}function ui(n,t){var i=new o.ViewModel;return i.dialogOptions=t,i.onItemSelected=function(){n(4)},i}function ct(n,t){var r=n.closest(".fxs-tile").data(l.CompositionInstanceDataName),u;return r&&l.isPartComposition(r)?u=r.locator:t!=="sideload"&&yt.error("Unable to determine the extension that opened the dialog. "+i.getCurrentCallStack(!0)),u}function lt(n){var r=n.closest(".fxs-bladecontent"),t=a.Widget.getWidgets(
r),i;return t&&t.length&&(i=t[0],n=d(i.getForm())),n}function at(n){rt.trace({source:ut,name:n&&n.toFriendlyString(),action:ft.DialogOpened,extension:n&&n.getExtensionLocator().name})}function b(n,t){rt.trace({source:ut,name:n&&n.toFriendlyString(),action:ft.DialogClosed,extension:n&&n.getExtensionLocator().name,data:t+""})}var nt=i.Base,it=nt.Diagnostics,rt=it.Telemetry,vt=i.ViewModels.Dialogs,k=h.Content.SvgStartup,d=jQuery,tt=d("body"),yt=it.createLog(n),pt="<div class='fxs-portal-shield'><div class='fxs-portal-shield-icon fxs-portal-shield-icon-on-topbar'><\/div><div class='fxs-portal-shield-modaldialog'><div/><\/div><\/div>",wt="fxs-portal-shield-icon-warning",bt="fxs-portal-shield-icon-error",kt="The {0} used to render the dialog was not specified.",ut=c.Source.Shell,ft=c.Action,g,et=(function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t})(vt.MessageBox),st;t.MessageBox=et;t.getOrCreate=dt;t.dispose=gt;st=(function(){function n(n){this._portalIdleSvc=n}return r.defineProperty(
n.prototype,"hasOpenDialog",{get:function(){return!!this._dismissOpenDialog},enumerable:!0,configurable:!0}),n.prototype.dismissOpenDialog=function(){this._dismissOpenDialog&&(this._dismissOpenDialog(),this._dismissOpenDialog=null)},n.prototype.showModalDialog=function(n){var s=this,t=d(pt),r,a,h,f,c,u,l,v,o;return tt.append(t),r=t.findByClassName("fxs-portal-shield-icon"),a=t.findByClassName("fxs-portal-shield-modaldialog"),n.showErrorIcon?(h=y.getSvgReferenceOrFallBackToData(i.extend2(k.error,{data:ot(k.error.data,"msportalfx-svg-c22")})),f=bt):(h=y.getSvgReferenceOrFallBackToData(i.extend2(k.warning,{data:ot(k.warning.data,"msportalfx-svg-c10")})),f=wt),r.html(h),r.addClass(f),c=tt.findByClassName("fxs-topbar-content").width(),u=tt.findByClassName("fxs-topbar-notifications").position(),c&&u&&(l=c-(u.left+40),r.css({top:u.top,right:l}),a.css({top:u.top+40,right:l})),this._currentCancelToken&&(this._currentCancelToken.cancel(),this._currentCancelToken=null),v=t.find(".fxs-portal-shield-modaldialog > div"),
o=new et(n.title,n.description,n.buttons),o.defaultButtonText=n.defaultButtonText,o.cancelButtonText=n.cancelButtonText,e.unhide(t),this._portalIdleSvc.signalIdle(),this._showDialog(v,o,!0,null).then((function(i){var u=n.uiShield&&n.uiShield.hidePromise;return u?(s._currentCancelToken=new nt.Promises.CancelationToken,nt.Promises.wrapWithCancelablePromise(u,s._currentCancelToken).then((function(){e.hide(t)}))):e.hide(t),r.removeClass(f),i})).finally((function(){s._portalIdleSvc.signalBusy()}))},n.prototype.showDialog=function(n,t,i,r){return n?t?(this.dismissOpenDialog(),this._showDialog(n,t,!1,i,r)):Q.reject(w("options")):Q.reject(w("element"))},n.prototype.showDialogWithCallback=function(n,t,i,r){if(!n)throw new Error(w("element"));if(!t)throw new Error(w("options"));this.dismissOpenDialog();this._showDialogWithCallback(n,t,!1,i,r)},n.prototype.showShellDialog=function(n,t,r,u,f,e){var o=this;return t?r?n?(f=i.isUndefined(f)?!0:f,this.dismissOpenDialog(),i.require("MsPortalImpl.Controls/Controls/Balloon").
then((function(i){var s=o._showDialog(d(t.getForm()),n,f,u,e?"sideload":"").then((function(n){return t.hideForm(),n})),h=i.getBox(r);return t.showForm(h),s}))):Q.reject(w("options")):Q.reject(w("sourceTarget")):Q.reject(w("formTarget"))},n.prototype._showDialog=function(n,t,i,r,u){var o=this,f=Q.defer(),s=function(n){f.resolve(n)},e;return r||i||(r=ct(n,u)),t.type!==4&&(n=lt(n)),e=ht(this,n,t,i,s),at(r),e?(this._dismissOpenDialog=function(){e.dispose();f.reject();b(r,"Dismissed")},f.promise.then((function(n){e.dispose();o._dismissOpenDialog=null;b(r,n)}))):(b(r,"InvalidDialogType"),f.reject("Invalid type specified in dialogOptions.")),f.promise},n.prototype._showDialogWithCallback=function(n,t,i,r,u){var o=this,f,e;u||i||(u=ct(n));t.type!==4&&(n=lt(n));e=function(n){f&&f.dispose();o._dismissOpenDialog=null;b(u,n);r&&r(n)};f=ht(this,n,t,i,e);at(u);f?this._dismissOpenDialog=function(){f.dispose();b(u,"Dismissed")}:b(u,"InvalidDialogType")},n})()}));define("MsPortalImpl/UI/UI.Initialize",["require",
"exports","f","i","a","ko","$","../Base/Base.KnockoutExtensions.FxParameterCollector","../Base/Base.Router","MsPortalImpl/Base/Base.BrowserDetection","../Base/Base.ImplUtils","../Base/ClaimsIdentity","../CodeComponentSideLoad/CodeComponentSideLoadModels","../Controls/ControlBindings.Async","../Extension/DefinitionPreprocessor","../Extension/Extension","../Extension/ExtensionMetadataSource","Fx/Feedback","../GalleryPackage/GalleryPackageLoader","MsPortalImpl/Resources/ImplScriptResources","../Interactions/Interactions.DismissHandler","../Interactions/Interactions.KeyboardShortcutHandler","../Interactions/Interactions.PortalReader","MsPortalImpl/Base/JQueryHelper","../Base/Languages","../../MsPortalImpl.Controls/Controls/ResourceFilterHelper","../Services/Services.AssetTypes","../Services/Services.AzureStorage","../Services/Services.BrowseCuration","../Services/Services.Controller","../Services/Services.FileUploadEndpointRegistration","../Services/Services.FileUploadInitialization","../Services/Services.GalleryEndpoints",
"../Services/Services.GeneralSettings","../Services/Services.FavoritesSettings","../Services/Services.PortalIdentity","../Services/Services.PortalTips","../Services/Services.SharedSettings","../Services/Services.Storage","../Services/Services.PortalIdleState","../Services/Services.SecurityTokens","../Services/Services.SelectedSubscriptions","../Services/Services.Settings","../Services/Services.ShellProvisioner","../Services/Services.TelemetrySharing","../Services/Services.Util","../Base/Telemetry","./Hubs/UI.BrowseManager","./Hubs/ViewModels/UI.Browse.ViewModelRegistration","../UI/Compositions/UI.Composition","./Compositions/UI.Composition.Services","./Hubs/UI.FavoritesManager","./Hubs/ViewModels/UI.Gallery.ViewModelRegistration","./Hubs/UI.HubsRpcCallbacks","./Hubs/UI.NotificationsPane","./UI.NpsHelper","./Hubs/UI.ResourceMapManagerRpc","./Hubs/ViewModels/UI.Settings.ViewModelRegistration","./UI.SessionHandler","./UI.StatusHandler","./UI.ViewTimeTelemetry","../Extension/ViewModelManager",
"../Widgets/Widgets.Portal","../Widgets/Widgets.WidgetBase","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.KnockoutExtensions","MsPortalImpl/Base/Base.KnockoutExtensions.Image","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding","MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding","MsPortalImpl/Base/JQueryExtensions","MsPortalImpl/Parts/Parts.Intrinsics","MsPortalImpl/Parts/Parts.ButtonPart","MsPortalImpl/Parts/Parts.Collection","MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration","MsPortalImpl/UI/UI.DialogManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,
lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li,ai,vi,yi,pi,wi,bi,ki,di,gi,nr,tr){"use strict";function iu(n,t){t&&t.startsWith("#")&&n.route(t)}function df(n,t,i){return[n,t].forEach((function(n){var t=n.length;if(t!==1)throw new Error("Unexpected length '"+n.selector+"': "+t);})),new gu(n,t,i)}function er(n,t,i){br({source:n,action:t,data:i})}function cu(n,t){return Q().then(t).catch((function(n){ar.error(n)})).then((function(){return n.getCodeComponentsMetadata()}))}function gf(n){var f,e;if(n&&wr&&wr.getEntriesByType&&wr.timing){var u=ur(),i=function(n,t,i){du(n,{duration:t,endTime:Math.round(i+wr.timing.navigationStart)})},o=wr.getEntriesByType("resource").filter((function(n){var t=n.initiatorType;return t==="link"||t==="script"})),r=o.reduce((function(n,t){return Math.min(t.startTime,n)}),Infinity),t=o.reduce((function(n,t){return Math.max(t.responseEnd,n)}),0),s=t-r,h=t;return r=Math.max(r,n),t=Math.min(t,u),f=t-r,e=u-f-n,i("TotalTimeToSplashScreen",n,n),i("TotalStartupResourceDownload",
s,h),i("StartupResourceDownload",f,t),i("StartupScriptExecution",e,u),e}}function du(n,t){t=t||{};var r=t.duration||ur(),i=t.data||{};return i.cdn="CdnIndex"+nu.index,i.bundling="Bundling"+nu.bundling,br({timestamp:t.endTime,source:lr,action:n,actionModifier:yr.ActionModifier.Complete,duration:r,data:i}),r}function ne(n,t){var i=n.getValue(wu,pu,bu);return t!==i&&n.setValue(wu,pu,t,bu),i}function te(){di.registerPrefix(y.PinVMPrefix,"./MsPortalImpl/Extension/PinBladeInferred",(function(n,t,i,r){return n.createViewModel(t,i,r)}))}function ie(n,t,r,u,f,o){var s=new ai.ViewModel,l=i.memoizeQ((function(){return rr("MsPortalImpl/Widgets/Widgets.NotificationsPane").then((function(n){return new n.Widget(e("<div/>"),s,r)}))})),h=i.memoizeQ((function(){return rr("MsPortalImpl/UI/Hubs/UI.NotificationHelper")})),c;r.notificationManager.notifications.subscribeArrayChanges(o,(function(n){h().then((function(t){return t.showToastAndUpdateCount(n,s,u)}))}),(function(n){h().then((function(t){return t.removeToastAndUpdateCount(
n,s,u)}))}));o.registerForDispose(n.options.topBar.notificationButtonClick=function(){l().then((function(n){n.toggleNotificationsContextPane().then((function(){u.removeAllToasts();h().then((function(n){return n.updateUnreadCountOnButton(0)}))}))}))});c={events:tr.default.fxtoastclick,handler:function(n,t){f.handleNotificationClick(t,!0)}};u.eventHandlers.push(c)}function re(n,t,r,u){var f=i.memoizeQ((function(){return rr("MsPortalImpl/Widgets/Widgets.SettingsPane").then((function(n){var i=new n.ViewModel;return new n.Widget(e("<div/>"),i,t,r)}))}));u.registerForDispose(f);n.element.on(tr.default.fxsettingsbuttonclick,(function(){f().then((function(n){er(pr.TopBar,or.SettingsPaneOpen);n.toggleSettingsContextPane()}))}))}function ue(n,t){n.feedbackButtonClick=function(){t.getService("FeedbackPane").then((function(n){var t=n.widget;er(dr,or.FeedbackSmileyClicked,{isPaneOpen:t.isVisible()});t.toggle()}))}}function fe(n,t,r,u,e){e.registerForDispose(n.element.setEvents([tr.default.fxbreadcrumbclick,function(
n,t){r.activeJourney().goToBlade(t.bladeId)}]));f.computed(e,(function(){var e=r.activeJourney(),f,o,s;u.options.journeysShown(!!e);f=t;i.isFeatureEnabled("movebreadcrumb")&&(o=n.getPanorama(),s=o&&o.getJourneyWidget(),f=s&&s.options.breadCrumb);f&&f.breadCrumbs(e?e.getBreadCrumbs():[])})).extend({throttle:100})}function ee(n,t,i,r,u){var f=function(n){return rr("MsPortalImpl/Widgets/Widgets.SharedOptionsInit").then((function(t){n(t)}))};n.initOptions((function(){return f((function(t){t.initSearchWidgetOptions(u,n,i,r)}))}));t.initOptions((function(){return f((function(n){n.initSideBarWidgetOptions(u,t,i)}))}));t.options.onDashboardFavoriteClick=function(n){return i.router.navigateToDashboard(n)}}function oe(n,t,i,r,u,f,e,o,s){var h=n.getTopBarWidget(),c=n.getSearchWidget(),a=n.getSideBarWidget(),l=h.options;re(h,t,i,o);ue(l,t);ee(c,a,t,u,o);fe(n,l.breadCrumb,t.desktop,c,o);ie(n,h,t,r,s,o)}var cr=r,nf=cr.Data,tf=cr.Extension,rf=cr.TriggerableLifetimeManager,vr=i.Base,ru=vr.Constants,uf=ru.Shell,uu=
vr.Diagnostics,yr=uu.Telemetry,fu=r.NetDiagnostics,ff=vr.Resources,lu=r.Rpc,ef=i.Hubs.Notifications,of=ef.NotificationStatus,sf=cr.Hubs.Notifications,hf=i.Services,cf=ru.DefaultCloudName,au=vr.Net2,or=ui.Action,pr=ui.Source,lf=i.Helpers,sr=MsPortalImpl.Performance,eu=vr.UriBuilder,hr=window,wr=hr.performance,vu=hr.fx,ur=vu.getTimestamp,br=yr.trace,ou=lu.client,lr=pr.Shell,ir=vu.environment,af=ir.chrome,kr=ir.links,dr=pr.TopBar,rr=i.require,vf=i.ensureSuffix,yf=i.pathJoin,gr=vf(ff.getAppRelativeUri("/"),"/"),pf=hr.console,fr=hr.location,ar=uu.createLog(n),yu=gr+"SignOut",wf=gr+"signin/index",bf=ir.errorPageUri,kf=ir.isDevelopmentMode,pu="loadedPageVersion",wu=bt.ComponentName.Telemetry,bu=0,nu=ir.cdn,su=i.isFeatureEnabled("ci"),hu,tu,ku=function(){ar.warning.apply(ar,arguments)},gu;au.setAjaxLogFunc(ku);t.routeIfHash=iu;t.create=df;gu=(function(){function t(n,t,i){this._lifetime=new rf;this._disposed=!1;this._dependencies=i;this._element=n;this._$splashScreen=t;this._idleSvc=kt.createInstance(
)}return t.prototype.initialize=function(){var u=this,y=this._lifetime,bt=this._$splashScreen,vr=i.memoizeQ((function(){return si.getDialogManagerModule().then((function(n){return n.getOrCreate(u._idleSvc)}))})),pu,fe;y.registerForDispose(vr);var wr=function(n,t){return u._redirect({uri:n,skipFlushBuffers:t})},ai=this._dependencies,pt=ai.settings,di=ai.extensionManager,vu=ai.storageService,bu=new eu(fr.href),kt=dt.extractAndClearAuthState(),vf,yf=function(n,t,r){var u=new eu(n+fr.search+(r||"")),f=nu.forceIndex,e=u.query;f&&e.setParameter(nu.indexParameter,f);t&&i.forEachKey(t,(function(n,t){return e.setParameter(n,t)}));wr(u.toString())};if(!kt){yf(gr,{reAuth:"true"},fr.hash);return}kt.createdOn||(kt.createdOn=Date.now(),dt.updateAuthState(kt));ir.enableAnimations||e.enableAnimations(!1);pu=this._idleSvc;yr.initialize(lr);at.init(pt);vt.init(pt);gt.init(pt);var df=ni.queryStores(pt,[8,4,7]),ie=ir.pageVersion,re=ne(vu,ie),st={defaultRoute:!1,splashScreen:sr.splashScreenLoadTime,initializeStart:
ur(),cdnFailedIndex:ai.cdnFailedIndex,loadedSameVersion:ie===re,previousVersion:re||""};tt.shutdown();tt.initialize(this._element);var ee=tt.read(d.Shell.Reader.portalLoading,1,"portal"),t,gu=at.processor.initialized.then((function(w){function to(n,t){er(dr,t);iu(ni,n)}function pe(n){return l.getAvatarImage(ii.avatarUri,ii.defaultAvatarUri,vu,n)}var ke=bu.query.getParameter("l")!==undefined,ku,ht,bi,gu,he,nf,lt,ce,uf,at,ni,hf,nu,gf,ne,eu,tt,ye,ie,gt,re,we,be;rt.initialize(y,vu,w.rawLocale,ir.localeFromQuery,ke)&&wr(null,!0);Q.fcall((function(){i.isObject(ir)&&pf.log("Version: "+ir.version+"\nSession: "+ir.sessionId)}));st.initializeGeneralSettings=ur();var fe=rt.currentLocaleContext,ee=fe.selectedDisplayLanguage,de=fe.selectedFormatCulture;er(lr,or.PortalInitializeLanguage,{language:ee,formatCulture:de||ee});yt.initialize(kt.user);var ii=yt.getSignedInUser(),au=ii.tenantId,ge=yt.getTenants(),se=f.observable(!1);g.initialize();y.registerForDispose((function(){g.dispose()}));ku=new gi.ViewModel;
ht=new gi.Widget(u._element,ku);y.registerForDispose((function(){it.hide(u._element);hr.setTimeout((function(){ht.dispose()}),100)}));t=si.initialize(y,ai,w,se,ht,wr,vr);v.initialize(t);bi=t.desktop;ku.sideBar.onDashboardFavoriteClick=function(n){return t.router.navigateToDashboard(n)};ut.initialize(t.assetTypeService,y);gu=Q(yt.getSubscriptions());he=gu.then((function(n){ef(n);se((n&&n.subscriptions||[]).some((function(n){return n.requireRdfe})))}));u._notificationManager=t.notificationManager;tf.extensionStatusEndPoint.register(ou,null,(function(n,t){n&&ue(n,t.srcWindowId)}));nf=ht.options;lt=nf.topBar;i.isFeatureEnabled("azureconsole")&&(lt.getConsoleViewModel=function(){return rr("MsPortalImpl/Widgets/Widgets.Console").then((function(n){return new n.ViewModel({src:ir.consoleUri,getAuthToken:vf})}))});lt.exitDevMode=function(){it.unhide(bt);MsPortalImpl.Extension.unregisterAll().then((function(){wr(gr)}))};var ki=function(){rr("../Base/Base.ClientRawFileDownload",n).then((function(n){n.downloadFile(
{provideText:function(){return le().then((function(n){return JSON.stringify(n,null,2)}))}},"PortalDiagnostics.json","charset=utf-8;application/json")}))},cr=i.memoizeQ((function(){return rr("../Base/Base.DebugInfo",n).then((function(n){return n.initialize(y,t)}))})),no=af.hideShortcuts?null:nt.setup(ht,t,ki,(function(){cr().then((function(n){return n.toggleStickys(hu)}))})),yr=ht.element,rf=function(){return rr("MsPortalImpl/Widgets/Widgets.WelcomeSequence").then((function(n){return new n.Widget(e("<div />"),new nr.ViewModel,yr,pt)}))};y.registerForDispose(rf);ce=i.memoizeQ((function(){return rr("MsPortalImpl/Widgets/Widgets.HelpPane").then((function(n){return new n.Widget(e("<div/>"),new n.ViewModel,t,ki.bind(u),no,pt,rf)}))}));y.registerForDispose(lt.helpButtonClick=function(){ce().then((function(n){return n.toggle(pr.TopBar)}))});var le=function(){return Q.all([rr("MsPortalImpl/Base/Base.DiagnosticsPopup"),he,ye]).spread((function(n){return n.getDiagnosticsData(t,ef,lf,wu)}))},ae=au==="72f988bf-86f1-41af-91ab-2d7cd011db47",
ve=i.getFeatureValue("showbugreportlink");return lt.canReportBug(ve==="force"||ve==="true"&&ae),lt.reportBug=function(){rr("./UI.Portal.Actions",n).then((function(n){n.reportBug(t,le,bu)}))},uf=hi.createFavoritesManager(t),at=nf.sideBar,at.attachFavoritesManager(uf),ni=t.router,at.launchBlade=function(n){ni.route(n)},hf=!1,nu=cu(ff,(function(){return ff.registerTestExtensionsFromUri(fr.href)})).then((function(n){return typeof n=="string"?(tu=n,Q.reject()):n})),a.canModifyExtensions&&(nu=nu.then((function(n){return rr("MsPortalImpl/Extension/ExtensionPatch").then((function(n){var i=n.initializeTestPatch([],t,bt);return cu(i,(function(){return i.registerTestPatchesFromUri(fr.href).then((function(){return i.listTestPatches().then((function(n){n=n||[];p.patchUris=n.map((function(n){return n.uri}));hf=!!n.length}))}))}))})).then((function(){return n}))}))),st.preGetExtensionMetadata=ur(),ne=nu.then((function(n){var i,u;return(st.getExtensionMetadata=ur(),gf=vt.processor.initialized.then((function(t){st.favoritesManagerInitialized=
ur();var i=t.favorites(),r=i&&JSON.parse(i);return er(pr.SideBar,"SideBarSettings",{collapsed:w.sideBarCollapsedKey(),favorites:r,favoritesCount:r.length}),uf.initializeFavorites(t,n)})),i=[cf],r.Extension.multiCloudEnabled&&(i=n.map((function(n){return n.cloudName})).unique().filter((function(n){return n!==ru.HubsCloudName}))),ft.setCloudNames(i),at.cloudOptions(i.map((function(n){return{text:f.observable(n),value:n}}))),di.initialize({extensions:n,useCachedManifests:!0}),wu.registerGetAuthorizationTokenEndpoint(n),yt.initializeRpc(n),wt.initializeRpc(),ot.initializeRpc(),et.registerSasEndPoint(),ri.registerEndpoints(lu.client,t.desktop),u=function(t){var i=n.some((function(n){return n.isTestExtension||n.isTestStamp}));return lt.inDevMode(i||t||hf),bi.initialize(n,df,st)},a.canAddGalleryPackages)?rr("MsPortalImpl/GalleryPackage/GalleryPackageMetadataSource").then((function(n){var i=n.initializeTestGalleryPackage([],t,bt);return cu(i,(function(){return i.registerTestGalleryPackagesFromUri(fr.href)})
)})).then((function(n){var t=k.initialize(di);return t.loadGalleryPackages(n),n&&n.length>0})).then((function(n){return st.galleryPackagesSideload=ur(),u(n)})):u(!1)})).then((function(){return st.desktopAndExtensionManagerInitialize=ur(),ni.initialRoute((function(){return st.defaultRoute=!0,i.isFeatureEnabled("userdefineddefaultview")?gf.then((function(){if(!at.openFavorite(0))throw new Error("Couldn't open first favorite.");})).catch((function(n){var r=ar.warning;return r.call(ar,new i.Errors.Error({message:"favoritesManagerInitialized failed",innerErrors:n})),t.router.goToDashboardOnInit("UiInitialize")})):t.router.goToDashboardOnInit("UiInitialize")}))})).then((function(){var t,r;if(st.setupInitialRoute=ur(),i.isFeatureEnabled("nohozscroll")&&s.isBladeUri()&&!st.defaultRoute){t=function(n,i){i.cancel&&(it.hide(bt),t&&(yr.off(tr.default.fxloadingontopbar,t),t=null))};yr.on(tr.default.fxloadingontopbar,t)}else it.hide(bt);sr.pageLoaded();st.locationHash=bu.fragment;st.hiddenTime=sr.getHiddenTime();r=
{data:e.extend(st,fu.traceDocumentNavigation())};di.getHubsExtension().then((function(){hu=du("TotalTimeToPortalReady",r);var t=1;!su&&i.isFeatureEnabled("userdefineddefaultview")&&w.whatsNewVersion()<t&&rr("../Services/Services.PortalTips",n).then((function(n){n.setup(y,gf,at.onFavoritesChanged,t)}))}));u._idleHandle=pu.addCallbacks({onIdle:function(){var n=hr.navigator;n&&n.onLine!==!1&&(tt.avatarImage(pe(!0)),i.getFeatureValue("prefetch")!=="false"&&rr("MsPortalImpl/Services/Services.PortalPrefetch",null,!0).then((function(n){n.start(y,pu,vu,hu)})),ir.useCachedManifests&&di.refreshManifests().catch((function(){})),i.isFeatureEnabled("ldnstrace")&&rr("ldns",null,!0),rr("MsPortalImpl/Services/Services.BrowserTelemetry",null,!0));pu.removeCallbacks(u._idleHandle)},onBusy:i.noop})})).catch((function(n){tu=tu||"/LoadFailed?stack="+encodeURIComponent(n&&n.stack).substr(0,1e3);u._redirect({uri:bf+tu})})),df.then((function(n){var t="userDefaultDirectory",i=n[7],r=i&&i[t];r!==au&&pt.setSetting(7,t,au)})),
ne.then((function(){var n,t,r,f;!su&&i.isFeatureEnabled("guidedtour")&&pt.querySetting(7,"WelcomeSequence").then((function(n){n||rf().then((function(){er(ui.Action.PortalInitializeWelcome,ui.Source.Shell)}))}));u._notificationManager.listenForClientNotifications();ct.init(pt);!i.isFeatureEnabled("internalonly")||a.canModifyExtensions||ae||(n=ir.trustedParentOrigin,t=n.replace(/^([^\/]+\/\/).+\.([^\.]+\.[^\.]+\.[^\.]+)$/,"$1$2"),n!==t&&(r=d.Portal,u._notificationManager.addClientNotification({status:of.Information,title:r.preview,description:r.unsupportedEnvironment.format(n),uri:t,timestamp:new Date,cloudName:null,uriAction:sf.ClientNotificationUriAction.OpenInCurrentTab})));h.isSafari&&h.webKitVersion<602&&(f=d.Portal,vr().then((function(n){return n.showModalDialog({title:f.unsupportedBrowser,description:f.unsupportedBrowserDesc.format(kr.unsupportedBrowser),buttons:1,showErrorIcon:!0})})))})).then((function(){var n=hr.navigator.serviceWorker;n&&n.getRegistrations&&n.getRegistrations().then((function(
n){n.forEach((function(n){n.unregister()}))}))})),ft.setupAssetTypeServiceRpc(t),yi.setupResourceMapManagerRpc(ou,t),ti.create(t),uu.ErrorReporter.initialize((function(){ar.debug(bi.getDiagnosticsData())})),o.initialize(bi,t),eu=ht.getToastVM(),oe(ht,t,gu,eu,at.selectedCloud,ki,cr,y,u._notificationManager),b.Internal.showNpsEndpoint.register(t.rpcClient,null,(function(n,t){vi.showNps(eu,n.productDisplayName,(t.srcWindowId||"")+"_"+n.productId)})),b.Internal.canShowNpsEndpoint.register(t.rpcClient,null,(function(){return!vi.npsShownInSession})),vi.showPortalNps(eu,w.npsTimeMs),tt=lt.avatarMenu,tt.userIdentity(ii),tt.hideTenant(i.isFeatureEnabled("hideavatartenant")),yt.getUserInfo().then((function(n){tt.userInfo(n)})),ye=ge.then((function(n){var t=n.tenants;lf(t);tt.listOfTenants(t)})),tt.showDiagnostics=ki,tt.signedOut=function(){dt.updateAuthState(null);wr(yu)},tt.openAccountPortal=function(){var n=kr.accountPortal;to(n.startsWith("#")?n:n+"subscriptions",or.AvatarMenuOpenBilling)},tt.avatarImage(pe(
)),at.saveCollapseState=function(n){w.sideBarCollapsedKey(n)},tt.giveFeedback=function(){er(dr,or.AvatarMenuOpenFeedback);iu(ni,kr.giveFeedback)},tt.showMyAccessBlade=function(){er(dr,or.AvatarMenuOpenAccessDetails);iu(ni,kr.accessDetails)},tt.switchedTenant=function(n,t){var i=c.getHashQueryStringSegment(fr.href);yf(wf+"/@"+t.tenant.domainName,null,"#"+i)},!su&&(kf||ir.clientOptimizations&&ir.clientOptimizations!=="true"||a.canModifyExtensions)&&cr().then((function(n){return n.startErrorDetection(y)})),y.registerForDispose(cr),i.isFeatureEnabled("nodirectory")&&tt.dropMenu.isMenuOpen(!0),ie="data-click-telemetry",gt=yr[0],gt.addEventListener(tr.default.mousedown,be=function(n){re=n.target},!0),gt.addEventListener(tr.default.mouseup,we=function(n){var i=re,r,t;if(re=null,n.target===i&&(r=e(i),t=r.closest("["+ie+"]",gt),t.length)){var o=t.attr(ie)+"",u=t.closest(".fxs-tile",gt).data(oi.CompositionInstanceDataName),f=u&&u.locator,s=f&&f.toFriendlyString()||lr;br({source:s,action:or.CustomClick,
name:o})}},!0),y.registerForDispose((function(){gt.removeEventListener(tr.default.mousedown,be,!0);gt.removeEventListener(tr.default.mouseup,we,!0)})),t.browseManager.initialize(),ei.registerViewModels(t),ci.registerViewModels(),pi.registerViewModels({portalServices:t,securityTokensManager:wu,subscriptions:ef,tenants:lf}),li.registerRpcCallbacks(t),te(),fi.subscribeToMruItems(t),fi.registerRpcEndpoints(t),wi.initialize(u._lifetime,w.idleTimeoutMins,u._idleSvc,(function(){return u._redirect({uri:yu})})),ne})),rf=bi.create(vr,gu,(function(n){u._redirect(n)}),(function(){it.unhide(bt)})),se=function(n,t){return rf.onLastTokenRefresh(n,t)},he=function(n){rf.onStatus({code:2},n)},ue=function(n,t){rf.onStatus(n,t)},wu=dt.createSecurityTokensManager(dt.createOAuthTokenProvier(kt),se,he),ff=w.initializeTestExtension(ai.extensionsMetadata.map((function(n){return a.ExtensionMetadataExt.create(n)})),pt,vu,vr,bt),ef=f.observable(),lf=f.observableArray();return new lt.GalleryEndpointsService(ou,di,ff),nf.registerTelemetrySubmissionHandler(
),fu.registerTelemetrySubmissionHandler(),cr.ProvisioningTelemetry.registerTelemetrySubmissionHandler(),au.status.subscribe((function(n){ue(n,uf)})),yr.addProcessor(ii.getProcessor(di)),i.isFeatureEnabled("consoletelemetry")&&(fe=hf.getConsoleTelemetryEventProcessor(),yr.addProcessor(fe)),MsPortalEarly.initializedTelemetry(br),gf(sr.splashScreenLoadTime),gu.then((function(){ki.start(t)})).then((function(){function i(n){ku("Injecting {0}blockable untrusted content : {1} from {2}".format(n.blockable?"":"un",n.tag,n.src));er(lr,"UntrustedSource",n)}function t(t){var r=t.src,s=t.tag,u=r!=="document.write",f,e,o;return u&&s==="SCRIPT"&&(f=document.createElement("a"),f.href=r,r=f.href,e=/(.*?)[#\?]|$/.exec(r)[1]||r,o=!!n.filter((function(n){return!!~e.indexOf(n||null)})).length,u=!r||o||!!i(t)&&!1),u}var n=sr.allowList=sr.allowList.concat(ir.cdnPrefixes);n.push(fr.host);n.push("about:blank");sr.sourceLogger=t;sr.sourceBacklog.forEach(t);ee();tt.read(d.Shell.Reader.portalReady,1,"portal")})),y.registerForDispose(
ki.stop),vf=wu.initializeSecurityForShell(kt),ht.registerFileUploadEndpoints(),ct.uploadSettingsManager=pt,gu},t.prototype.dispose=function(){var n,t;this._disposed=!0;n=this._idleSvc;n&&(n.dispose(),this._idleSvc=null);cr.resetGlobalState();t=this._lifetime;t&&(t.dispose(),this._lifetime=null);fu.resetTelemetryTimer();dt.writeAuthState()},t.prototype._redirect=function(n){var t=n.uri,r=lf.Deferred(),i;it.unhide(this._$splashScreen);br({source:lr,action:or.PortalRedirect,actionModifier:ui.ActionModifier.Redirect,data:t});i=function(){r.resolve()};n.skipFlushBuffers?i():(st.flush(this._dependencies.settings).finally(i),hr.setTimeout(i,5e3));Q.allSettled([n.delayPromise,r]).finally((function(){if(!t){var n=new eu(fr.href);n.path=yf("/",n.path,yt.getSignedInUser().tenantId,"/");t=n.toString()}fr.href=t}))},t})()}));define("_generated/Less/MsPortalImpl/Base/Base.Images.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,".msportalfx-svg-c01{fill:#fff}.msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-c03{fill:#a0a1a2}.msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-c08{fill:#ba141a}.msportalfx-svg-c09{fill:#dd5900}.msportalfx-svg-c10{fill:#ff8c00}.msportalfx-svg-c11{fill:#fcd116}.msportalfx-svg-c12{fill:#fee087}.msportalfx-svg-c13{fill:#b8d432}.msportalfx-svg-c14{fill:#7fba00}.msportalfx-svg-c15{fill:#59b4d9}.msportalfx-svg-c16{fill:#3999c6}.msportalfx-svg-c17{fill:#804998}.msportalfx-svg-c18{fill:#ec008c}.msportalfx-svg-c19{fill:#0072c6}.msportalfx-svg-c20{fill:#68217a}.msportalfx-svg-c21{fill:#00188f}.msportalfx-svg-c22{fill:#e81123}.msportalfx-svg-c97{fill:#ffb900}.msportalfx-svg-c98{fill:#00a4ef}.msportalfx-svg-c99{fill:#f25022}.fxs-blade-header-icon .msportalfx-svg-c05,.fxs-sidebar-middle .msportalfx-svg-c05,.fxs-theme-dark .msportalfx-svg-c05,.msportalfx-inverted-theme .msportalfx-svg-c05{fill:#777}.fxs-blade-header-icon .msportalfx-svg-c07,.fxs-sidebar-middle .msportalfx-svg-c07,.fxs-theme-dark .msportalfx-svg-c07,.msportalfx-inverted-theme .msportalfx-svg-c07{fill:#f2f2f2}.msportalfx-svg-palette-white>*,.msportalfx-svg-palette-white>g>*{fill:#fff}.msportalfx-svg-palette-blue>*,.msportalfx-svg-palette-blue>g>*{fill:#3999c6}.msportalfx-svg-palette-black>*,.msportalfx-svg-palette-black>g>*{fill:#1e1e1e}.msportalfx-svg-palette-green>*,.msportalfx-svg-palette-green>g>*{fill:#7fba00}.msportalfx-svg-palette-gray>*,.msportalfx-svg-palette-gray>g>*{fill:#a0a1a2}.msportalfx-svg-palette-inherit>*,.msportalfx-svg-palette-inherit>g *{fill:inherit!important}.msportalfx-svg-badge{position:absolute;left:0;bottom:0;min-height:12px;min-width:12px}.ext-fxc-menu-icon>.msportalfx-svg-badge{left:8px;bottom:7px;min-height:8px;min-width:8px}.msportalfx-svg-disabled{filter:grayscale(100%)}@-moz-document url-prefix(){.msportalfx-svg-disabled{filter:none}}.msportalfx-svg-disabled .msportalfx-svg-c01{fill:#fff}.msportalfx-svg-disabled .msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-disabled .msportalfx-svg-c03{fill:#a1a1a1}.msportalfx-svg-disabled .msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-disabled .msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-disabled .msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-disabled .msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-disabled .msportalfx-svg-c08{fill:#676767}.msportalfx-svg-disabled .msportalfx-svg-c09{fill:#6f6f6f}.msportalfx-svg-disabled .msportalfx-svg-c10{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c11{fill:#898989}.msportalfx-svg-disabled .msportalfx-svg-c12{fill:#c3c3c3}.msportalfx-svg-disabled .msportalfx-svg-c13{fill:#838383}.msportalfx-svg-disabled .msportalfx-svg-c14{fill:#5d5d5d}.msportalfx-svg-disabled .msportalfx-svg-c15{fill:#999}.msportalfx-svg-disabled .msportalfx-svg-c16{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c17{fill:#717171}.msportalfx-svg-disabled .msportalfx-svg-c18{fill:#767676}.msportalfx-svg-disabled .msportalfx-svg-c19{fill:#636363}.msportalfx-svg-disabled .msportalfx-svg-c20{fill:#4e4e4e}.msportalfx-svg-disabled .msportalfx-svg-c21{fill:#484848}.msportalfx-svg-disabled .msportalfx-svg-c22{fill:#7d7d7d}.msportalfx-svg-disabled .msportalfx-svg-c97{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c98{fill:#787878}.msportalfx-svg-disabled .msportalfx-svg-c99{fill:#8a8a8a}.msportalfx-svg-loading-square{-webkit-animation:ProgressFlagAnimation 1.45s infinite ease-in-out;animation:ProgressFlagAnimation 1.45s infinite ease-in-out}.msportalfx-svg-loading-square:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s}.msportalfx-svg-loading-square:nth-child(2){-webkit-animation-delay:.2s;animation-delay:.2s}.msportalfx-svg-loading-square:nth-child(3){-webkit-animation-delay:.4s;animation-delay:.4s}@-webkit-keyframes ProgressFlagAnimation{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}@keyframes ProgressFlagAnimation{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}.msportalfx-svg-flip-horizontal>svg,svg.msportalfx-svg-flip-horizontal{transform:scalex(-1)}.msportalfx-svg-rotate360{-webkit-animation:ImageRotation 1.45s infinite linear;animation:ImageRotation 1.45s infinite linear}@-webkit-keyframes ImageRotation{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes ImageRotation{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}")})
);define("_generated/Less/MsPortalImpl/Themes/Themes.Universal.css",["require","exports","module"],(function(n,t,i){"use strict";window.fx.injectCss(i,"a{color:#0058ad}.fxs-topbar{background-color:#1c1c1c;color:#fff}.fxs-topbar .fxs-bg-warning,.fxs-topbar.fxs-bg-warning{color:#000}.fxs-topbar .fxs-bg-warning svg,.fxs-topbar.fxs-bg-warning svg{fill:#000}.fxs-topbar-search .fxs-searchbox input{background-color:#444;color:#fff}.fxs-topbar-search .fxs-searchbox input::-webkit-input-placeholder{color:#bbb}.fxs-topbar-search .fxs-searchbox input:-ms-input-placeholder{color:#bbb}.fxs-topbar-search .fxs-searchbox input::-moz-placeholder{color:#bbb}.fxs-trim,.fxs-trim-text,.fxs-trim-text a,a.fxs-trim-text{color:#fff}.fxs-topbar-dashboard,.fxs-topbar-exit-customize{background-color:#8a2da5}.fxs-trim{background-color:#252525}.fxs-trim-btn{color:#fff;border-color:#fff}.fxs-trim-title{color:#bbb}.fxs-trim-selected{background-color:#444}.fxs-trim-hover:hover{background-color:#3d3d3d}.fxs-trim-border{border-color:#444}.fxs-trim-svg{fill:#fff}.fxs-trim-svg-secondary{fill:#bbb}.fxs-trim-text-primary a,a.fxs-trim-text-primary{color:#55b3ff}.fxs-sidebar-star.fxs-is-favorite svg{fill:#ffb900;stroke:#000;stroke-width:1px}.fxs-fill-white,.fxs-tile-actionbar-action{fill:#fff}.fxs-sidebar .azc-form-labelcontainer{color:#fff}.fxs-bg-white{background-color:#fff}.fxs-overlay{background:rgba(0,0,0,.7)}.fxs-highlight{color:#000;background-color:#fff100}.fxs-tile-actionbar{background-color:#9cd5f4}.fxs-tile-actionbar-action.fxs-tile-actionbar-action-pressed,.fxs-tile-actionbar-action:hover{background:#00bcf2}.fxs-tile-actionbar-action.fxs-tile-actionbar-command-unpinfromstartboard:hover{background:#ba141a}.fxs-portal .fxs-accent,.fxs-portal .fxs-popup{box-shadow:0 5px 15px 2px rgba(0,0,0,.3)}.fxs-portal .fxs-portal-main .azc-is-edited .azc-dockedballoon-validation.azc-control.azc-dockedballoon{border-color:#8a2da5}.fxs-blade-status-container,.fxs-blade-title-description{color:#000}.fxs-text-white{color:#fff}.fxs-br-primary{border-color:#00bcf2}.fxs-tile-selected .fxs-tile-overlay{background-color:transparent}.fxs-bg-overlay-dark{background:rgba(0,0,0,.7)}.fxs-bg-primary-10{background-color:rgba(0,188,242,.1)}.azc-is-edited.azc-has-focus{border-color:#7fba00}.azc-is-edited.azc-has-focus .azc-dockedballoon-validation{border-color:#00bcf2}.azc-is-edited .azc-dockedballoon-validation{border-color:#8a2da5}.azc-disabled:hover,.azc-row-disabled:hover{background-color:inherit}.azc-disabled,.azc-disabled:focus,.azc-disabled:hover,input.azc-disabled{cursor:default;outline:0}.fxs-part::after{border-color:#9cd5f4}.fxs-part.fxs-part-selected-command::after,.fxs-part.fxs-part-selected::after{border-color:#00bcf2}.fxs-portal .fxs-text-info,.fxs-portal .msportalfx-text-info{color:#0058ad}.fxs-portal .fxs-text-success,.fxs-portal .msportalfx-text-success{color:#7fba00}.fxs-portal .fxs-text-dirty,.fxs-portal .msportalfx-text-dirty{color:#8a2da5}.fxs-portal .fxs-text-warning,.fxs-portal .msportalfx-text-warning{color:#ff8c00}.fxs-portal .fxs-text-error,.fxs-portal .msportalfx-text-error{color:#e81123}.fxs-fill-info,.msportalfx-fill-info{fill:#0058ad!important}.fxs-fill-complete,.fxs-fill-success,.msportalfx-fill-success{fill:#7fba00!important}.fxs-fill-dirty,.fxs-fill-upsell,.msportalfx-fill-dirty{fill:#8a2da5!important}.fxs-fill-warning,.msportalfx-fill-warning{fill:#ff8c00!important}.fxs-fill-error,.msportalfx-fill-error{fill:#e81123!important}.fxs-br-info,.msportalfx-br-info{border-color:#00bcf2!important}.fxs-br-success,.msportalfx-br-success{border-color:#7fba00!important}.fxs-br-dirty,.msportalfx-br-dirty{border-color:#8a2da5!important}.fxs-br-warning,.msportalfx-br-warning{border-color:#ff8c00!important}.fxs-br-error,.msportalfx-br-error{border-color:#e81123!important}.fxs-bg-info,.msportalfx-bg-info{background-color:#0058ad!important}.fxs-bg-success,.msportalfx-bg-success{background-color:#7fba00!important}.fxs-bg-dirty,.fxs-bg-upsell,.msportalfx-bg-dirty{background-color:#8a2da5!important}.fxs-bg-warning,.msportalfx-bg-warning{background-color:#ff8c00!important}.fxs-bg-error,.msportalfx-bg-error{background-color:#e81123!important}.fxs-blade-statusbg.fxs-bg-info{background-color:#d1e7f8!important}.fxs-blade-statusbg.fxs-bg-complete,.fxs-blade-statusbg.fxs-bg-success{background-color:#d1ebd1!important}.fxs-blade-statusbg.fxs-bg-dirty,.fxs-blade-statusbg.fxs-bg-upsell{background-color:#e4d5f0!important}.fxs-blade-statusbg.fxs-bg-warning{background-color:#fff0d1!important}.fxs-blade-statusbg.fxs-bg-error{background-color:#f9b1b7!important}")})
);define("MsPortalImpl/Init",["require","exports","f","i","u","./Base/Base.Router","./Extension/ExtensionManager","./Services/Services.PortalIdentity","./Services/Services.EditScopeManagement","./Services/Services.Settings","./Base/Telemetry","./UI/UI.Initialize","./Services/Services.Storage","../_generated/Less/MsPortalImpl/Base/Base.Images.css","../_generated/Less/MsPortalImpl/Themes/Themes.Universal.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";var v;return (function(){function d(n){var t={fx:v.version};n||p.initializedExtensions.forEach((function(n){t[n.name]=n.extension.getVersion()}));ut.custom("Session",et,ot++,st,t)}var y=i.Base,tt=y.Diagnostics,it=r.Rpc,rt=y.UriBuilder,u=a.ComponentName,c=window,v=c.fx.environment,ut=tt.createLog(n),ft=v.cdn,t=a.create(),w=new y.UriBuilder(c.location.href),b=JSON.parse(t.getValue(u.Redirect,"BootParameters",0)||"{}"),k;t.clearValue(u.Redirect,"BootParameters",0);t.clearValue(u.Redirect,"BootParameters",1);t.clearValue(u.Redirect,"ReloadCount",
1);c.fx.bootEnvironment=b.environment||{region:"unknown"};w.query=new y.QueryStringBuilder(b.userQuery);f.history_replaceState(null,c.document.title,w.toString());ft.enabled||(k=t.clearValue(u.Cdn,"FailedIndex",1));t.clearValue(u.Redirect,"IdpRedirectCount",1);v.extensionUnloadTimeout&&(it.timeToDelayWindowUnload=v.extensionUnloadTimeout);var et=1,ot=0,st=t.clearValue(u.Redirect,"Referrers",1)||"";d(!0);c.setInterval(d,36e5);var p=e.create(),g=h.createUserSettingsManager(t),nt=l.create($("#web-container"),$("body").find("> .fxs-splashscreen"),{storageService:t,settings:g,extensionManager:p,editScopeManager:s.createEditScopeManager(p),extensionsMetadata:v.extensionsMetadata,hubsMetadata:v.hubsMetadata,openWindow:function(n){var t=c.open();return Q(n).then((function(n){if(n){var r=new rt(n),f=r.path,u=i.ensureSuffix(f,"/");i.localeCompareIgnoreCase(u,i.ensureSuffix(location.protocol+"//"+location.host,"/"))||(r.path=i.pathJoin("/",u,o.getSignedInUser().tenantId,"/"),n=r.toString())}t.location.
href=n}))},cdnFailedIndex:k});nt.initialize();$(c).on("unload",(function(){g.dispose();nt.dispose()}))})(v||(v={})),v}))